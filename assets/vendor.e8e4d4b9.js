function _c(t,e){const n=Object.create(null),r=t.split(",");for(let s=0;s<r.length;s++)n[r[s]]=!0;return e?s=>!!n[s.toLowerCase()]:s=>!!n[s]}const fv="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",dv=_c(fv);function $d(t){return!!t||t===""}function bc(t){if(H(t)){const e={};for(let n=0;n<t.length;n++){const r=t[n],s=We(r)?gv(r):bc(r);if(s)for(const i in s)e[i]=s[i]}return e}else{if(We(t))return t;if(Qe(t))return t}}const pv=/;(?![^(]*\))/g,mv=/:(.+)/;function gv(t){const e={};return t.split(pv).forEach(n=>{if(n){const r=n.split(mv);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function Ec(t){let e="";if(We(t))e=t;else if(H(t))for(let n=0;n<t.length;n++){const r=Ec(t[n]);r&&(e+=r+" ")}else if(Qe(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const E1=t=>We(t)?t:t==null?"":H(t)||Qe(t)&&(t.toString===Vd||!z(t.toString))?JSON.stringify(t,Ud,2):String(t),Ud=(t,e)=>e&&e.__v_isRef?Ud(t,e.value):zr(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[r,s])=>(n[`${r} =>`]=s,n),{})}:Bd(e)?{[`Set(${e.size})`]:[...e.values()]}:Qe(e)&&!H(e)&&!Kd(e)?String(e):e,pe={},Hr=[],Ft=()=>{},yv=()=>!1,vv=/^on[^a-z]/,aa=t=>vv.test(t),Tc=t=>t.startsWith("onUpdate:"),ft=Object.assign,Ic=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},wv=Object.prototype.hasOwnProperty,ne=(t,e)=>wv.call(t,e),H=Array.isArray,zr=t=>ua(t)==="[object Map]",Bd=t=>ua(t)==="[object Set]",z=t=>typeof t=="function",We=t=>typeof t=="string",Sc=t=>typeof t=="symbol",Qe=t=>t!==null&&typeof t=="object",jd=t=>Qe(t)&&z(t.then)&&z(t.catch),Vd=Object.prototype.toString,ua=t=>Vd.call(t),_v=t=>ua(t).slice(8,-1),Kd=t=>ua(t)==="[object Object]",xc=t=>We(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,wo=_c(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),ca=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},bv=/-(\w)/g,Zr=ca(t=>t.replace(bv,(e,n)=>n?n.toUpperCase():"")),Ev=/\B([A-Z])/g,vs=ca(t=>t.replace(Ev,"-$1").toLowerCase()),Gd=ca(t=>t.charAt(0).toUpperCase()+t.slice(1)),Za=ca(t=>t?`on${Gd(t)}`:""),ko=(t,e)=>!Object.is(t,e),eu=(t,e)=>{for(let n=0;n<t.length;n++)t[n](e)},Oo=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})},Tv=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let Ph;const Iv=()=>Ph||(Ph=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});let tn;class Sv{constructor(e=!1){this.active=!0,this.effects=[],this.cleanups=[],!e&&tn&&(this.parent=tn,this.index=(tn.scopes||(tn.scopes=[])).push(this)-1)}run(e){if(this.active)try{return tn=this,e()}finally{tn=this.parent}}on(){tn=this}off(){tn=this.parent}stop(e){if(this.active){let n,r;for(n=0,r=this.effects.length;n<r;n++)this.effects[n].stop();for(n=0,r=this.cleanups.length;n<r;n++)this.cleanups[n]();if(this.scopes)for(n=0,r=this.scopes.length;n<r;n++)this.scopes[n].stop(!0);if(this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.active=!1}}}function xv(t,e=tn){e&&e.active&&e.effects.push(t)}const Ac=t=>{const e=new Set(t);return e.w=0,e.n=0,e},Hd=t=>(t.w&Dn)>0,zd=t=>(t.n&Dn)>0,Av=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=Dn},Cv=t=>{const{deps:e}=t;if(e.length){let n=0;for(let r=0;r<e.length;r++){const s=e[r];Hd(s)&&!zd(s)?s.delete(t):e[n++]=s,s.w&=~Dn,s.n&=~Dn}e.length=n}},Au=new WeakMap;let qs=0,Dn=1;const Cu=30;let Kt;const Xn=Symbol(""),ku=Symbol("");class Cc{constructor(e,n=null,r){this.fn=e,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,xv(this,r)}run(){if(!this.active)return this.fn();let e=Kt,n=xn;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=Kt,Kt=this,xn=!0,Dn=1<<++qs,qs<=Cu?Av(this):Mh(this),this.fn()}finally{qs<=Cu&&Cv(this),Dn=1<<--qs,Kt=this.parent,xn=n,this.parent=void 0}}stop(){this.active&&(Mh(this),this.onStop&&this.onStop(),this.active=!1)}}function Mh(t){const{deps:e}=t;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(t);e.length=0}}let xn=!0;const Wd=[];function ws(){Wd.push(xn),xn=!1}function _s(){const t=Wd.pop();xn=t===void 0?!0:t}function Tt(t,e,n){if(xn&&Kt){let r=Au.get(t);r||Au.set(t,r=new Map);let s=r.get(n);s||r.set(n,s=Ac()),Qd(s)}}function Qd(t,e){let n=!1;qs<=Cu?zd(t)||(t.n|=Dn,n=!Hd(t)):n=!t.has(Kt),n&&(t.add(Kt),Kt.deps.push(t))}function un(t,e,n,r,s,i){const o=Au.get(t);if(!o)return;let a=[];if(e==="clear")a=[...o.values()];else if(n==="length"&&H(t))o.forEach((u,c)=>{(c==="length"||c>=r)&&a.push(u)});else switch(n!==void 0&&a.push(o.get(n)),e){case"add":H(t)?xc(n)&&a.push(o.get("length")):(a.push(o.get(Xn)),zr(t)&&a.push(o.get(ku)));break;case"delete":H(t)||(a.push(o.get(Xn)),zr(t)&&a.push(o.get(ku)));break;case"set":zr(t)&&a.push(o.get(Xn));break}if(a.length===1)a[0]&&Ou(a[0]);else{const u=[];for(const c of a)c&&u.push(...c);Ou(Ac(u))}}function Ou(t,e){for(const n of H(t)?t:[...t])(n!==Kt||n.allowRecurse)&&(n.scheduler?n.scheduler():n.run())}const kv=_c("__proto__,__v_isRef,__isVue"),Yd=new Set(Object.getOwnPropertyNames(Symbol).map(t=>Symbol[t]).filter(Sc)),Ov=kc(),Dv=kc(!1,!0),Nv=kc(!0),Fh=Rv();function Rv(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...n){const r=he(this);for(let i=0,o=this.length;i<o;i++)Tt(r,"get",i+"");const s=r[e](...n);return s===-1||s===!1?r[e](...n.map(he)):s}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...n){ws();const r=he(this)[e].apply(this,n);return _s(),r}}),t}function kc(t=!1,e=!1){return function(r,s,i){if(s==="__v_isReactive")return!t;if(s==="__v_isReadonly")return t;if(s==="__v_isShallow")return e;if(s==="__v_raw"&&i===(t?e?Qv:tp:e?ep:Zd).get(r))return r;const o=H(r);if(!t&&o&&ne(Fh,s))return Reflect.get(Fh,s,i);const a=Reflect.get(r,s,i);return(Sc(s)?Yd.has(s):kv(s))||(t||Tt(r,"get",s),e)?a:tt(a)?!o||!xc(s)?a.value:a:Qe(a)?t?np(a):Nc(a):a}}const Pv=Jd(),Mv=Jd(!0);function Jd(t=!1){return function(n,r,s,i){let o=n[r];if(Xs(o)&&tt(o)&&!tt(s))return!1;if(!t&&!Xs(s)&&(rp(s)||(s=he(s),o=he(o)),!H(n)&&tt(o)&&!tt(s)))return o.value=s,!0;const a=H(n)&&xc(r)?Number(r)<n.length:ne(n,r),u=Reflect.set(n,r,s,i);return n===he(i)&&(a?ko(s,o)&&un(n,"set",r,s):un(n,"add",r,s)),u}}function Fv(t,e){const n=ne(t,e);t[e];const r=Reflect.deleteProperty(t,e);return r&&n&&un(t,"delete",e,void 0),r}function Lv(t,e){const n=Reflect.has(t,e);return(!Sc(e)||!Yd.has(e))&&Tt(t,"has",e),n}function qv(t){return Tt(t,"iterate",H(t)?"length":Xn),Reflect.ownKeys(t)}const Xd={get:Ov,set:Pv,deleteProperty:Fv,has:Lv,ownKeys:qv},$v={get:Nv,set(t,e){return!0},deleteProperty(t,e){return!0}},Uv=ft({},Xd,{get:Dv,set:Mv}),Oc=t=>t,la=t=>Reflect.getPrototypeOf(t);function Zi(t,e,n=!1,r=!1){t=t.__v_raw;const s=he(t),i=he(e);e!==i&&!n&&Tt(s,"get",e),!n&&Tt(s,"get",i);const{has:o}=la(s),a=r?Oc:n?Mc:Pc;if(o.call(s,e))return a(t.get(e));if(o.call(s,i))return a(t.get(i));t!==s&&t.get(e)}function eo(t,e=!1){const n=this.__v_raw,r=he(n),s=he(t);return t!==s&&!e&&Tt(r,"has",t),!e&&Tt(r,"has",s),t===s?n.has(t):n.has(t)||n.has(s)}function to(t,e=!1){return t=t.__v_raw,!e&&Tt(he(t),"iterate",Xn),Reflect.get(t,"size",t)}function Lh(t){t=he(t);const e=he(this);return la(e).has.call(e,t)||(e.add(t),un(e,"add",t,t)),this}function qh(t,e){e=he(e);const n=he(this),{has:r,get:s}=la(n);let i=r.call(n,t);i||(t=he(t),i=r.call(n,t));const o=s.call(n,t);return n.set(t,e),i?ko(e,o)&&un(n,"set",t,e):un(n,"add",t,e),this}function $h(t){const e=he(this),{has:n,get:r}=la(e);let s=n.call(e,t);s||(t=he(t),s=n.call(e,t)),r&&r.call(e,t);const i=e.delete(t);return s&&un(e,"delete",t,void 0),i}function Uh(){const t=he(this),e=t.size!==0,n=t.clear();return e&&un(t,"clear",void 0,void 0),n}function no(t,e){return function(r,s){const i=this,o=i.__v_raw,a=he(o),u=e?Oc:t?Mc:Pc;return!t&&Tt(a,"iterate",Xn),o.forEach((c,l)=>r.call(s,u(c),u(l),i))}}function ro(t,e,n){return function(...r){const s=this.__v_raw,i=he(s),o=zr(i),a=t==="entries"||t===Symbol.iterator&&o,u=t==="keys"&&o,c=s[t](...r),l=n?Oc:e?Mc:Pc;return!e&&Tt(i,"iterate",u?ku:Xn),{next(){const{value:h,done:f}=c.next();return f?{value:h,done:f}:{value:a?[l(h[0]),l(h[1])]:l(h),done:f}},[Symbol.iterator](){return this}}}}function vn(t){return function(...e){return t==="delete"?!1:this}}function Bv(){const t={get(i){return Zi(this,i)},get size(){return to(this)},has:eo,add:Lh,set:qh,delete:$h,clear:Uh,forEach:no(!1,!1)},e={get(i){return Zi(this,i,!1,!0)},get size(){return to(this)},has:eo,add:Lh,set:qh,delete:$h,clear:Uh,forEach:no(!1,!0)},n={get(i){return Zi(this,i,!0)},get size(){return to(this,!0)},has(i){return eo.call(this,i,!0)},add:vn("add"),set:vn("set"),delete:vn("delete"),clear:vn("clear"),forEach:no(!0,!1)},r={get(i){return Zi(this,i,!0,!0)},get size(){return to(this,!0)},has(i){return eo.call(this,i,!0)},add:vn("add"),set:vn("set"),delete:vn("delete"),clear:vn("clear"),forEach:no(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(i=>{t[i]=ro(i,!1,!1),n[i]=ro(i,!0,!1),e[i]=ro(i,!1,!0),r[i]=ro(i,!0,!0)}),[t,n,e,r]}const[jv,Vv,Kv,Gv]=Bv();function Dc(t,e){const n=e?t?Gv:Kv:t?Vv:jv;return(r,s,i)=>s==="__v_isReactive"?!t:s==="__v_isReadonly"?t:s==="__v_raw"?r:Reflect.get(ne(n,s)&&s in r?n:r,s,i)}const Hv={get:Dc(!1,!1)},zv={get:Dc(!1,!0)},Wv={get:Dc(!0,!1)},Zd=new WeakMap,ep=new WeakMap,tp=new WeakMap,Qv=new WeakMap;function Yv(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Jv(t){return t.__v_skip||!Object.isExtensible(t)?0:Yv(_v(t))}function Nc(t){return Xs(t)?t:Rc(t,!1,Xd,Hv,Zd)}function Xv(t){return Rc(t,!1,Uv,zv,ep)}function np(t){return Rc(t,!0,$v,Wv,tp)}function Rc(t,e,n,r,s){if(!Qe(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const i=s.get(t);if(i)return i;const o=Jv(t);if(o===0)return t;const a=new Proxy(t,o===2?r:n);return s.set(t,a),a}function Wr(t){return Xs(t)?Wr(t.__v_raw):!!(t&&t.__v_isReactive)}function Xs(t){return!!(t&&t.__v_isReadonly)}function rp(t){return!!(t&&t.__v_isShallow)}function sp(t){return Wr(t)||Xs(t)}function he(t){const e=t&&t.__v_raw;return e?he(e):t}function ip(t){return Oo(t,"__v_skip",!0),t}const Pc=t=>Qe(t)?Nc(t):t,Mc=t=>Qe(t)?np(t):t;function Zv(t){xn&&Kt&&(t=he(t),Qd(t.dep||(t.dep=Ac())))}function ew(t,e){t=he(t),t.dep&&Ou(t.dep)}function tt(t){return!!(t&&t.__v_isRef===!0)}function tw(t){return tt(t)?t.value:t}const nw={get:(t,e,n)=>tw(Reflect.get(t,e,n)),set:(t,e,n,r)=>{const s=t[e];return tt(s)&&!tt(n)?(s.value=n,!0):Reflect.set(t,e,n,r)}};function op(t){return Wr(t)?t:new Proxy(t,nw)}class rw{constructor(e,n,r,s){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new Cc(e,()=>{this._dirty||(this._dirty=!0,ew(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!s,this.__v_isReadonly=r}get value(){const e=he(this);return Zv(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function sw(t,e,n=!1){let r,s;const i=z(t);return i?(r=t,s=Ft):(r=t.get,s=t.set),new rw(r,s,i||!s,n)}Promise.resolve();function An(t,e,n,r){let s;try{s=r?t(...r):t()}catch(i){ha(i,e,n)}return s}function Lt(t,e,n,r){if(z(t)){const i=An(t,e,n,r);return i&&jd(i)&&i.catch(o=>{ha(o,e,n)}),i}const s=[];for(let i=0;i<t.length;i++)s.push(Lt(t[i],e,n,r));return s}function ha(t,e,n,r=!0){const s=e?e.vnode:null;if(e){let i=e.parent;const o=e.proxy,a=n;for(;i;){const c=i.ec;if(c){for(let l=0;l<c.length;l++)if(c[l](t,o,a)===!1)return}i=i.parent}const u=e.appContext.config.errorHandler;if(u){An(u,null,10,[t,o,a]);return}}iw(t,n,s,r)}function iw(t,e,n,r=!0){console.error(t)}let Do=!1,Du=!1;const _t=[];let rn=0;const js=[];let $s=null,$r=0;const Vs=[];let bn=null,Ur=0;const ap=Promise.resolve();let Fc=null,Nu=null;function ow(t){const e=Fc||ap;return t?e.then(this?t.bind(this):t):e}function aw(t){let e=rn+1,n=_t.length;for(;e<n;){const r=e+n>>>1;Zs(_t[r])<t?e=r+1:n=r}return e}function up(t){(!_t.length||!_t.includes(t,Do&&t.allowRecurse?rn+1:rn))&&t!==Nu&&(t.id==null?_t.push(t):_t.splice(aw(t.id),0,t),cp())}function cp(){!Do&&!Du&&(Du=!0,Fc=ap.then(fp))}function uw(t){const e=_t.indexOf(t);e>rn&&_t.splice(e,1)}function lp(t,e,n,r){H(t)?n.push(...t):(!e||!e.includes(t,t.allowRecurse?r+1:r))&&n.push(t),cp()}function cw(t){lp(t,$s,js,$r)}function lw(t){lp(t,bn,Vs,Ur)}function Lc(t,e=null){if(js.length){for(Nu=e,$s=[...new Set(js)],js.length=0,$r=0;$r<$s.length;$r++)$s[$r]();$s=null,$r=0,Nu=null,Lc(t,e)}}function hp(t){if(Vs.length){const e=[...new Set(Vs)];if(Vs.length=0,bn){bn.push(...e);return}for(bn=e,bn.sort((n,r)=>Zs(n)-Zs(r)),Ur=0;Ur<bn.length;Ur++)bn[Ur]();bn=null,Ur=0}}const Zs=t=>t.id==null?1/0:t.id;function fp(t){Du=!1,Do=!0,Lc(t),_t.sort((n,r)=>Zs(n)-Zs(r));const e=Ft;try{for(rn=0;rn<_t.length;rn++){const n=_t[rn];n&&n.active!==!1&&An(n,null,14)}}finally{rn=0,_t.length=0,hp(),Do=!1,Fc=null,(_t.length||js.length||Vs.length)&&fp(t)}}function hw(t,e,...n){const r=t.vnode.props||pe;let s=n;const i=e.startsWith("update:"),o=i&&e.slice(7);if(o&&o in r){const l=`${o==="modelValue"?"model":o}Modifiers`,{number:h,trim:f}=r[l]||pe;f?s=n.map(p=>p.trim()):h&&(s=n.map(Tv))}let a,u=r[a=Za(e)]||r[a=Za(Zr(e))];!u&&i&&(u=r[a=Za(vs(e))]),u&&Lt(u,t,6,s);const c=r[a+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,Lt(c,t,6,s)}}function dp(t,e,n=!1){const r=e.emitsCache,s=r.get(t);if(s!==void 0)return s;const i=t.emits;let o={},a=!1;if(!z(t)){const u=c=>{const l=dp(c,e,!0);l&&(a=!0,ft(o,l))};!n&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}return!i&&!a?(r.set(t,null),null):(H(i)?i.forEach(u=>o[u]=null):ft(o,i),r.set(t,o),o)}function qc(t,e){return!t||!aa(e)?!1:(e=e.slice(2).replace(/Once$/,""),ne(t,e[0].toLowerCase()+e.slice(1))||ne(t,vs(e))||ne(t,e))}let sn=null,pp=null;function No(t){const e=sn;return sn=t,pp=t&&t.type.__scopeId||null,e}function fw(t,e=sn,n){if(!e||t._n)return t;const r=(...s)=>{r._d&&Qh(-1);const i=No(e),o=t(...s);return No(i),r._d&&Qh(1),o};return r._n=!0,r._c=!0,r._d=!0,r}function tu(t){const{type:e,vnode:n,proxy:r,withProxy:s,props:i,propsOptions:[o],slots:a,attrs:u,emit:c,render:l,renderCache:h,data:f,setupState:p,ctx:g,inheritAttrs:T}=t;let x,M;const ie=No(t);try{if(n.shapeFlag&4){const ce=s||r;x=Vt(l.call(ce,ce,h,i,p,f,g)),M=u}else{const ce=e;x=Vt(ce.length>1?ce(i,{attrs:u,slots:a,emit:c}):ce(i,null)),M=e.props?u:dw(u)}}catch(ce){Ks.length=0,ha(ce,t,1),x=zt(nr)}let ue=x;if(M&&T!==!1){const ce=Object.keys(M),{shapeFlag:st}=ue;ce.length&&st&7&&(o&&ce.some(Tc)&&(M=pw(M,o)),ue=ei(ue,M))}return n.dirs&&(ue.dirs=ue.dirs?ue.dirs.concat(n.dirs):n.dirs),n.transition&&(ue.transition=n.transition),x=ue,No(ie),x}const dw=t=>{let e;for(const n in t)(n==="class"||n==="style"||aa(n))&&((e||(e={}))[n]=t[n]);return e},pw=(t,e)=>{const n={};for(const r in t)(!Tc(r)||!(r.slice(9)in e))&&(n[r]=t[r]);return n};function mw(t,e,n){const{props:r,children:s,component:i}=t,{props:o,children:a,patchFlag:u}=e,c=i.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&u>=0){if(u&1024)return!0;if(u&16)return r?Bh(r,o,c):!!o;if(u&8){const l=e.dynamicProps;for(let h=0;h<l.length;h++){const f=l[h];if(o[f]!==r[f]&&!qc(c,f))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?Bh(r,o,c):!0:!!o;return!1}function Bh(t,e,n){const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!0;for(let s=0;s<r.length;s++){const i=r[s];if(e[i]!==t[i]&&!qc(n,i))return!0}return!1}function gw({vnode:t,parent:e},n){for(;e&&e.subTree===t;)(t=e.vnode).el=n,e=e.parent}const yw=t=>t.__isSuspense;function vw(t,e){e&&e.pendingBranch?H(t)?e.effects.push(...t):e.effects.push(t):lw(t)}function ww(t,e){if(Ze){let n=Ze.provides;const r=Ze.parent&&Ze.parent.provides;r===n&&(n=Ze.provides=Object.create(r)),n[t]=e}}function nu(t,e,n=!1){const r=Ze||sn;if(r){const s=r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides;if(s&&t in s)return s[t];if(arguments.length>1)return n&&z(e)?e.call(r.proxy):e}}const jh={};function ru(t,e,n){return mp(t,e,n)}function mp(t,e,{immediate:n,deep:r,flush:s,onTrack:i,onTrigger:o}=pe){const a=Ze;let u,c=!1,l=!1;if(tt(t)?(u=()=>t.value,c=rp(t)):Wr(t)?(u=()=>t,r=!0):H(t)?(l=!0,c=t.some(Wr),u=()=>t.map(M=>{if(tt(M))return M.value;if(Wr(M))return Vr(M);if(z(M))return An(M,a,2)})):z(t)?e?u=()=>An(t,a,2):u=()=>{if(!(a&&a.isUnmounted))return h&&h(),Lt(t,a,3,[f])}:u=Ft,e&&r){const M=u;u=()=>Vr(M())}let h,f=M=>{h=x.onStop=()=>{An(M,a,4)}};if(ti)return f=Ft,e?n&&Lt(e,a,3,[u(),l?[]:void 0,f]):u(),Ft;let p=l?[]:jh;const g=()=>{if(!!x.active)if(e){const M=x.run();(r||c||(l?M.some((ie,ue)=>ko(ie,p[ue])):ko(M,p)))&&(h&&h(),Lt(e,a,3,[M,p===jh?void 0:p,f]),p=M)}else x.run()};g.allowRecurse=!!e;let T;s==="sync"?T=g:s==="post"?T=()=>pt(g,a&&a.suspense):T=()=>{!a||a.isMounted?cw(g):g()};const x=new Cc(u,T);return e?n?g():p=x.run():s==="post"?pt(x.run.bind(x),a&&a.suspense):x.run(),()=>{x.stop(),a&&a.scope&&Ic(a.scope.effects,x)}}function _w(t,e,n){const r=this.proxy,s=We(t)?t.includes(".")?gp(r,t):()=>r[t]:t.bind(r,r);let i;z(e)?i=e:(i=e.handler,n=e);const o=Ze;es(this);const a=mp(s,i.bind(r),n);return o?es(o):er(),a}function gp(t,e){const n=e.split(".");return()=>{let r=t;for(let s=0;s<n.length&&r;s++)r=r[n[s]];return r}}function Vr(t,e){if(!Qe(t)||t.__v_skip||(e=e||new Set,e.has(t)))return t;if(e.add(t),tt(t))Vr(t.value,e);else if(H(t))for(let n=0;n<t.length;n++)Vr(t[n],e);else if(Bd(t)||zr(t))t.forEach(n=>{Vr(n,e)});else if(Kd(t))for(const n in t)Vr(t[n],e);return t}function T1(t){return z(t)?{setup:t,name:t.name}:t}const Ru=t=>!!t.type.__asyncLoader,yp=t=>t.type.__isKeepAlive;function bw(t,e){vp(t,"a",e)}function Ew(t,e){vp(t,"da",e)}function vp(t,e,n=Ze){const r=t.__wdc||(t.__wdc=()=>{let s=n;for(;s;){if(s.isDeactivated)return;s=s.parent}return t()});if(fa(e,r,n),n){let s=n.parent;for(;s&&s.parent;)yp(s.parent.vnode)&&Tw(r,e,n,s),s=s.parent}}function Tw(t,e,n,r){const s=fa(e,t,r,!0);wp(()=>{Ic(r[e],s)},n)}function fa(t,e,n=Ze,r=!1){if(n){const s=n[t]||(n[t]=[]),i=e.__weh||(e.__weh=(...o)=>{if(n.isUnmounted)return;ws(),es(n);const a=Lt(e,n,t,o);return er(),_s(),a});return r?s.unshift(i):s.push(i),i}}const fn=t=>(e,n=Ze)=>(!ti||t==="sp")&&fa(t,e,n),Iw=fn("bm"),Sw=fn("m"),xw=fn("bu"),Aw=fn("u"),Cw=fn("bum"),wp=fn("um"),kw=fn("sp"),Ow=fn("rtg"),Dw=fn("rtc");function Nw(t,e=Ze){fa("ec",t,e)}let Pu=!0;function Rw(t){const e=bp(t),n=t.proxy,r=t.ctx;Pu=!1,e.beforeCreate&&Vh(e.beforeCreate,t,"bc");const{data:s,computed:i,methods:o,watch:a,provide:u,inject:c,created:l,beforeMount:h,mounted:f,beforeUpdate:p,updated:g,activated:T,deactivated:x,beforeDestroy:M,beforeUnmount:ie,destroyed:ue,unmounted:ce,render:st,renderTracked:xt,renderTriggered:q,errorCaptured:W,serverPrefetch:le,expose:de,inheritAttrs:J,components:dt,directives:mn,filters:O}=e;if(c&&Pw(c,r,null,t.appContext.config.unwrapInjectedRef),o)for(const Q in o){const oe=o[Q];z(oe)&&(r[Q]=oe.bind(n))}if(s){const Q=s.call(n,n);Qe(Q)&&(t.data=Nc(Q))}if(Pu=!0,i)for(const Q in i){const oe=i[Q],Nt=z(oe)?oe.bind(n,n):z(oe.get)?oe.get.bind(n,n):Ft,Dr=!z(oe)&&z(oe.set)?oe.set.bind(n):Ft,gn=d_({get:Nt,set:Dr});Object.defineProperty(r,Q,{enumerable:!0,configurable:!0,get:()=>gn.value,set:Rt=>gn.value=Rt})}if(a)for(const Q in a)_p(a[Q],r,n,Q);if(u){const Q=z(u)?u.call(n):u;Reflect.ownKeys(Q).forEach(oe=>{ww(oe,Q[oe])})}l&&Vh(l,t,"c");function Z(Q,oe){H(oe)?oe.forEach(Nt=>Q(Nt.bind(n))):oe&&Q(oe.bind(n))}if(Z(Iw,h),Z(Sw,f),Z(xw,p),Z(Aw,g),Z(bw,T),Z(Ew,x),Z(Nw,W),Z(Dw,xt),Z(Ow,q),Z(Cw,ie),Z(wp,ce),Z(kw,le),H(de))if(de.length){const Q=t.exposed||(t.exposed={});de.forEach(oe=>{Object.defineProperty(Q,oe,{get:()=>n[oe],set:Nt=>n[oe]=Nt})})}else t.exposed||(t.exposed={});st&&t.render===Ft&&(t.render=st),J!=null&&(t.inheritAttrs=J),dt&&(t.components=dt),mn&&(t.directives=mn)}function Pw(t,e,n=Ft,r=!1){H(t)&&(t=Mu(t));for(const s in t){const i=t[s];let o;Qe(i)?"default"in i?o=nu(i.from||s,i.default,!0):o=nu(i.from||s):o=nu(i),tt(o)&&r?Object.defineProperty(e,s,{enumerable:!0,configurable:!0,get:()=>o.value,set:a=>o.value=a}):e[s]=o}}function Vh(t,e,n){Lt(H(t)?t.map(r=>r.bind(e.proxy)):t.bind(e.proxy),e,n)}function _p(t,e,n,r){const s=r.includes(".")?gp(n,r):()=>n[r];if(We(t)){const i=e[t];z(i)&&ru(s,i)}else if(z(t))ru(s,t.bind(n));else if(Qe(t))if(H(t))t.forEach(i=>_p(i,e,n,r));else{const i=z(t.handler)?t.handler.bind(n):e[t.handler];z(i)&&ru(s,i,t)}}function bp(t){const e=t.type,{mixins:n,extends:r}=e,{mixins:s,optionsCache:i,config:{optionMergeStrategies:o}}=t.appContext,a=i.get(e);let u;return a?u=a:!s.length&&!n&&!r?u=e:(u={},s.length&&s.forEach(c=>Ro(u,c,o,!0)),Ro(u,e,o)),i.set(e,u),u}function Ro(t,e,n,r=!1){const{mixins:s,extends:i}=e;i&&Ro(t,i,n,!0),s&&s.forEach(o=>Ro(t,o,n,!0));for(const o in e)if(!(r&&o==="expose")){const a=Mw[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const Mw={data:Kh,props:Vn,emits:Vn,methods:Vn,computed:Vn,beforeCreate:it,created:it,beforeMount:it,mounted:it,beforeUpdate:it,updated:it,beforeDestroy:it,beforeUnmount:it,destroyed:it,unmounted:it,activated:it,deactivated:it,errorCaptured:it,serverPrefetch:it,components:Vn,directives:Vn,watch:Lw,provide:Kh,inject:Fw};function Kh(t,e){return e?t?function(){return ft(z(t)?t.call(this,this):t,z(e)?e.call(this,this):e)}:e:t}function Fw(t,e){return Vn(Mu(t),Mu(e))}function Mu(t){if(H(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function it(t,e){return t?[...new Set([].concat(t,e))]:e}function Vn(t,e){return t?ft(ft(Object.create(null),t),e):e}function Lw(t,e){if(!t)return e;if(!e)return t;const n=ft(Object.create(null),t);for(const r in e)n[r]=it(t[r],e[r]);return n}function qw(t,e,n,r=!1){const s={},i={};Oo(i,da,1),t.propsDefaults=Object.create(null),Ep(t,e,s,i);for(const o in t.propsOptions[0])o in s||(s[o]=void 0);n?t.props=r?s:Xv(s):t.type.props?t.props=s:t.props=i,t.attrs=i}function $w(t,e,n,r){const{props:s,attrs:i,vnode:{patchFlag:o}}=t,a=he(s),[u]=t.propsOptions;let c=!1;if((r||o>0)&&!(o&16)){if(o&8){const l=t.vnode.dynamicProps;for(let h=0;h<l.length;h++){let f=l[h];const p=e[f];if(u)if(ne(i,f))p!==i[f]&&(i[f]=p,c=!0);else{const g=Zr(f);s[g]=Fu(u,a,g,p,t,!1)}else p!==i[f]&&(i[f]=p,c=!0)}}}else{Ep(t,e,s,i)&&(c=!0);let l;for(const h in a)(!e||!ne(e,h)&&((l=vs(h))===h||!ne(e,l)))&&(u?n&&(n[h]!==void 0||n[l]!==void 0)&&(s[h]=Fu(u,a,h,void 0,t,!0)):delete s[h]);if(i!==a)for(const h in i)(!e||!ne(e,h)&&!0)&&(delete i[h],c=!0)}c&&un(t,"set","$attrs")}function Ep(t,e,n,r){const[s,i]=t.propsOptions;let o=!1,a;if(e)for(let u in e){if(wo(u))continue;const c=e[u];let l;s&&ne(s,l=Zr(u))?!i||!i.includes(l)?n[l]=c:(a||(a={}))[l]=c:qc(t.emitsOptions,u)||(!(u in r)||c!==r[u])&&(r[u]=c,o=!0)}if(i){const u=he(n),c=a||pe;for(let l=0;l<i.length;l++){const h=i[l];n[h]=Fu(s,u,h,c[h],t,!ne(c,h))}}return o}function Fu(t,e,n,r,s,i){const o=t[n];if(o!=null){const a=ne(o,"default");if(a&&r===void 0){const u=o.default;if(o.type!==Function&&z(u)){const{propsDefaults:c}=s;n in c?r=c[n]:(es(s),r=c[n]=u.call(null,e),er())}else r=u}o[0]&&(i&&!a?r=!1:o[1]&&(r===""||r===vs(n))&&(r=!0))}return r}function Tp(t,e,n=!1){const r=e.propsCache,s=r.get(t);if(s)return s;const i=t.props,o={},a=[];let u=!1;if(!z(t)){const l=h=>{u=!0;const[f,p]=Tp(h,e,!0);ft(o,f),p&&a.push(...p)};!n&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}if(!i&&!u)return r.set(t,Hr),Hr;if(H(i))for(let l=0;l<i.length;l++){const h=Zr(i[l]);Gh(h)&&(o[h]=pe)}else if(i)for(const l in i){const h=Zr(l);if(Gh(h)){const f=i[l],p=o[h]=H(f)||z(f)?{type:f}:f;if(p){const g=Wh(Boolean,p.type),T=Wh(String,p.type);p[0]=g>-1,p[1]=T<0||g<T,(g>-1||ne(p,"default"))&&a.push(h)}}}const c=[o,a];return r.set(t,c),c}function Gh(t){return t[0]!=="$"}function Hh(t){const e=t&&t.toString().match(/^\s*function (\w+)/);return e?e[1]:t===null?"null":""}function zh(t,e){return Hh(t)===Hh(e)}function Wh(t,e){return H(e)?e.findIndex(n=>zh(n,t)):z(e)&&zh(e,t)?0:-1}const Ip=t=>t[0]==="_"||t==="$stable",$c=t=>H(t)?t.map(Vt):[Vt(t)],Uw=(t,e,n)=>{const r=fw((...s)=>$c(e(...s)),n);return r._c=!1,r},Sp=(t,e,n)=>{const r=t._ctx;for(const s in t){if(Ip(s))continue;const i=t[s];if(z(i))e[s]=Uw(s,i,r);else if(i!=null){const o=$c(i);e[s]=()=>o}}},xp=(t,e)=>{const n=$c(e);t.slots.default=()=>n},Bw=(t,e)=>{if(t.vnode.shapeFlag&32){const n=e._;n?(t.slots=he(e),Oo(e,"_",n)):Sp(e,t.slots={})}else t.slots={},e&&xp(t,e);Oo(t.slots,da,1)},jw=(t,e,n)=>{const{vnode:r,slots:s}=t;let i=!0,o=pe;if(r.shapeFlag&32){const a=e._;a?n&&a===1?i=!1:(ft(s,e),!n&&a===1&&delete s._):(i=!e.$stable,Sp(e,s)),o=e}else e&&(xp(t,e),o={default:1});if(i)for(const a in s)!Ip(a)&&!(a in o)&&delete s[a]};function Bn(t,e,n,r){const s=t.dirs,i=e&&e.dirs;for(let o=0;o<s.length;o++){const a=s[o];i&&(a.oldValue=i[o].value);let u=a.dir[r];u&&(ws(),Lt(u,n,8,[t.el,a,t,e]),_s())}}function Ap(){return{app:null,config:{isNativeTag:yv,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Vw=0;function Kw(t,e){return function(r,s=null){s!=null&&!Qe(s)&&(s=null);const i=Ap(),o=new Set;let a=!1;const u=i.app={_uid:Vw++,_component:r,_props:s,_container:null,_context:i,_instance:null,version:p_,get config(){return i.config},set config(c){},use(c,...l){return o.has(c)||(c&&z(c.install)?(o.add(c),c.install(u,...l)):z(c)&&(o.add(c),c(u,...l))),u},mixin(c){return i.mixins.includes(c)||i.mixins.push(c),u},component(c,l){return l?(i.components[c]=l,u):i.components[c]},directive(c,l){return l?(i.directives[c]=l,u):i.directives[c]},mount(c,l,h){if(!a){const f=zt(r,s);return f.appContext=i,l&&e?e(f,c):t(f,c,h),a=!0,u._container=c,c.__vue_app__=u,jc(f.component)||f.component.proxy}},unmount(){a&&(t(null,u._container),delete u._container.__vue_app__)},provide(c,l){return i.provides[c]=l,u}};return u}}function Lu(t,e,n,r,s=!1){if(H(t)){t.forEach((f,p)=>Lu(f,e&&(H(e)?e[p]:e),n,r,s));return}if(Ru(r)&&!s)return;const i=r.shapeFlag&4?jc(r.component)||r.component.proxy:r.el,o=s?null:i,{i:a,r:u}=t,c=e&&e.r,l=a.refs===pe?a.refs={}:a.refs,h=a.setupState;if(c!=null&&c!==u&&(We(c)?(l[c]=null,ne(h,c)&&(h[c]=null)):tt(c)&&(c.value=null)),z(u))An(u,a,12,[o,l]);else{const f=We(u),p=tt(u);if(f||p){const g=()=>{if(t.f){const T=f?l[u]:u.value;s?H(T)&&Ic(T,i):H(T)?T.includes(i)||T.push(i):f?l[u]=[i]:(u.value=[i],t.k&&(l[t.k]=u.value))}else f?(l[u]=o,ne(h,u)&&(h[u]=o)):tt(u)&&(u.value=o,t.k&&(l[t.k]=o))};o?(g.id=-1,pt(g,n)):g()}}}const pt=vw;function Gw(t){return Hw(t)}function Hw(t,e){const n=Iv();n.__VUE__=!0;const{insert:r,remove:s,patchProp:i,createElement:o,createText:a,createComment:u,setText:c,setElementText:l,parentNode:h,nextSibling:f,setScopeId:p=Ft,cloneNode:g,insertStaticContent:T}=t,x=(d,m,w,b=null,_=null,C=null,N=!1,A=null,k=!!m.dynamicChildren)=>{if(d===m)return;d&&!Rs(d,m)&&(b=Xi(d),yn(d,_,C,!0),d=null),m.patchFlag===-2&&(k=!1,m.dynamicChildren=null);const{type:I,ref:$,shapeFlag:F}=m;switch(I){case Uc:M(d,m,w,b);break;case nr:ie(d,m,w,b);break;case _o:d==null&&ue(m,w,b,N);break;case nn:mn(d,m,w,b,_,C,N,A,k);break;default:F&1?xt(d,m,w,b,_,C,N,A,k):F&6?O(d,m,w,b,_,C,N,A,k):(F&64||F&128)&&I.process(d,m,w,b,_,C,N,A,k,Nr)}$!=null&&_&&Lu($,d&&d.ref,C,m||d,!m)},M=(d,m,w,b)=>{if(d==null)r(m.el=a(m.children),w,b);else{const _=m.el=d.el;m.children!==d.children&&c(_,m.children)}},ie=(d,m,w,b)=>{d==null?r(m.el=u(m.children||""),w,b):m.el=d.el},ue=(d,m,w,b)=>{[d.el,d.anchor]=T(d.children,m,w,b,d.el,d.anchor)},ce=({el:d,anchor:m},w,b)=>{let _;for(;d&&d!==m;)_=f(d),r(d,w,b),d=_;r(m,w,b)},st=({el:d,anchor:m})=>{let w;for(;d&&d!==m;)w=f(d),s(d),d=w;s(m)},xt=(d,m,w,b,_,C,N,A,k)=>{N=N||m.type==="svg",d==null?q(m,w,b,_,C,N,A,k):de(d,m,_,C,N,A,k)},q=(d,m,w,b,_,C,N,A)=>{let k,I;const{type:$,props:F,shapeFlag:U,transition:K,patchFlag:ee,dirs:ve}=d;if(d.el&&g!==void 0&&ee===-1)k=d.el=g(d.el);else{if(k=d.el=o(d.type,C,F&&F.is,F),U&8?l(k,d.children):U&16&&le(d.children,k,null,b,_,C&&$!=="foreignObject",N,A),ve&&Bn(d,null,b,"created"),F){for(const me in F)me!=="value"&&!wo(me)&&i(k,me,null,F[me],C,d.children,b,_,en);"value"in F&&i(k,"value",null,F.value),(I=F.onVnodeBeforeMount)&&Bt(I,b,d)}W(k,d,d.scopeId,N,b)}ve&&Bn(d,null,b,"beforeMount");const fe=(!_||_&&!_.pendingBranch)&&K&&!K.persisted;fe&&K.beforeEnter(k),r(k,m,w),((I=F&&F.onVnodeMounted)||fe||ve)&&pt(()=>{I&&Bt(I,b,d),fe&&K.enter(k),ve&&Bn(d,null,b,"mounted")},_)},W=(d,m,w,b,_)=>{if(w&&p(d,w),b)for(let C=0;C<b.length;C++)p(d,b[C]);if(_){let C=_.subTree;if(m===C){const N=_.vnode;W(d,N,N.scopeId,N.slotScopeIds,_.parent)}}},le=(d,m,w,b,_,C,N,A,k=0)=>{for(let I=k;I<d.length;I++){const $=d[I]=A?En(d[I]):Vt(d[I]);x(null,$,m,w,b,_,C,N,A)}},de=(d,m,w,b,_,C,N)=>{const A=m.el=d.el;let{patchFlag:k,dynamicChildren:I,dirs:$}=m;k|=d.patchFlag&16;const F=d.props||pe,U=m.props||pe;let K;w&&jn(w,!1),(K=U.onVnodeBeforeUpdate)&&Bt(K,w,m,d),$&&Bn(m,d,w,"beforeUpdate"),w&&jn(w,!0);const ee=_&&m.type!=="foreignObject";if(I?J(d.dynamicChildren,I,A,w,b,ee,C):N||Nt(d,m,A,null,w,b,ee,C,!1),k>0){if(k&16)dt(A,m,F,U,w,b,_);else if(k&2&&F.class!==U.class&&i(A,"class",null,U.class,_),k&4&&i(A,"style",F.style,U.style,_),k&8){const ve=m.dynamicProps;for(let fe=0;fe<ve.length;fe++){const me=ve[fe],Pt=F[me],Rr=U[me];(Rr!==Pt||me==="value")&&i(A,me,Pt,Rr,_,d.children,w,b,en)}}k&1&&d.children!==m.children&&l(A,m.children)}else!N&&I==null&&dt(A,m,F,U,w,b,_);((K=U.onVnodeUpdated)||$)&&pt(()=>{K&&Bt(K,w,m,d),$&&Bn(m,d,w,"updated")},b)},J=(d,m,w,b,_,C,N)=>{for(let A=0;A<m.length;A++){const k=d[A],I=m[A],$=k.el&&(k.type===nn||!Rs(k,I)||k.shapeFlag&70)?h(k.el):w;x(k,I,$,null,b,_,C,N,!0)}},dt=(d,m,w,b,_,C,N)=>{if(w!==b){for(const A in b){if(wo(A))continue;const k=b[A],I=w[A];k!==I&&A!=="value"&&i(d,A,I,k,N,m.children,_,C,en)}if(w!==pe)for(const A in w)!wo(A)&&!(A in b)&&i(d,A,w[A],null,N,m.children,_,C,en);"value"in b&&i(d,"value",w.value,b.value)}},mn=(d,m,w,b,_,C,N,A,k)=>{const I=m.el=d?d.el:a(""),$=m.anchor=d?d.anchor:a("");let{patchFlag:F,dynamicChildren:U,slotScopeIds:K}=m;K&&(A=A?A.concat(K):K),d==null?(r(I,w,b),r($,w,b),le(m.children,w,$,_,C,N,A,k)):F>0&&F&64&&U&&d.dynamicChildren?(J(d.dynamicChildren,U,w,_,C,N,A),(m.key!=null||_&&m===_.subTree)&&Cp(d,m,!0)):Nt(d,m,w,$,_,C,N,A,k)},O=(d,m,w,b,_,C,N,A,k)=>{m.slotScopeIds=A,d==null?m.shapeFlag&512?_.ctx.activate(m,w,b,N,k):G(m,w,b,_,C,N,k):Z(d,m,k)},G=(d,m,w,b,_,C,N)=>{const A=d.component=a_(d,b,_);if(yp(d)&&(A.ctx.renderer=Nr),u_(A),A.asyncDep){if(_&&_.registerDep(A,Q),!d.el){const k=A.subTree=zt(nr);ie(null,k,m,w)}return}Q(A,d,m,w,_,C,N)},Z=(d,m,w)=>{const b=m.component=d.component;if(mw(d,m,w))if(b.asyncDep&&!b.asyncResolved){oe(b,m,w);return}else b.next=m,uw(b.update),b.update();else m.component=d.component,m.el=d.el,b.vnode=m},Q=(d,m,w,b,_,C,N)=>{const A=()=>{if(d.isMounted){let{next:$,bu:F,u:U,parent:K,vnode:ee}=d,ve=$,fe;jn(d,!1),$?($.el=ee.el,oe(d,$,N)):$=ee,F&&eu(F),(fe=$.props&&$.props.onVnodeBeforeUpdate)&&Bt(fe,K,$,ee),jn(d,!0);const me=tu(d),Pt=d.subTree;d.subTree=me,x(Pt,me,h(Pt.el),Xi(Pt),d,_,C),$.el=me.el,ve===null&&gw(d,me.el),U&&pt(U,_),(fe=$.props&&$.props.onVnodeUpdated)&&pt(()=>Bt(fe,K,$,ee),_)}else{let $;const{el:F,props:U}=m,{bm:K,m:ee,parent:ve}=d,fe=Ru(m);if(jn(d,!1),K&&eu(K),!fe&&($=U&&U.onVnodeBeforeMount)&&Bt($,ve,m),jn(d,!0),F&&Xa){const me=()=>{d.subTree=tu(d),Xa(F,d.subTree,d,_,null)};fe?m.type.__asyncLoader().then(()=>!d.isUnmounted&&me()):me()}else{const me=d.subTree=tu(d);x(null,me,w,b,d,_,C),m.el=me.el}if(ee&&pt(ee,_),!fe&&($=U&&U.onVnodeMounted)){const me=m;pt(()=>Bt($,ve,me),_)}m.shapeFlag&256&&d.a&&pt(d.a,_),d.isMounted=!0,m=w=b=null}},k=d.effect=new Cc(A,()=>up(d.update),d.scope),I=d.update=k.run.bind(k);I.id=d.uid,jn(d,!0),I()},oe=(d,m,w)=>{m.component=d;const b=d.vnode.props;d.vnode=m,d.next=null,$w(d,m.props,b,w),jw(d,m.children,w),ws(),Lc(void 0,d.update),_s()},Nt=(d,m,w,b,_,C,N,A,k=!1)=>{const I=d&&d.children,$=d?d.shapeFlag:0,F=m.children,{patchFlag:U,shapeFlag:K}=m;if(U>0){if(U&128){gn(I,F,w,b,_,C,N,A,k);return}else if(U&256){Dr(I,F,w,b,_,C,N,A,k);return}}K&8?($&16&&en(I,_,C),F!==I&&l(w,F)):$&16?K&16?gn(I,F,w,b,_,C,N,A,k):en(I,_,C,!0):($&8&&l(w,""),K&16&&le(F,w,b,_,C,N,A,k))},Dr=(d,m,w,b,_,C,N,A,k)=>{d=d||Hr,m=m||Hr;const I=d.length,$=m.length,F=Math.min(I,$);let U;for(U=0;U<F;U++){const K=m[U]=k?En(m[U]):Vt(m[U]);x(d[U],K,w,null,_,C,N,A,k)}I>$?en(d,_,C,!0,!1,F):le(m,w,b,_,C,N,A,k,F)},gn=(d,m,w,b,_,C,N,A,k)=>{let I=0;const $=m.length;let F=d.length-1,U=$-1;for(;I<=F&&I<=U;){const K=d[I],ee=m[I]=k?En(m[I]):Vt(m[I]);if(Rs(K,ee))x(K,ee,w,null,_,C,N,A,k);else break;I++}for(;I<=F&&I<=U;){const K=d[F],ee=m[U]=k?En(m[U]):Vt(m[U]);if(Rs(K,ee))x(K,ee,w,null,_,C,N,A,k);else break;F--,U--}if(I>F){if(I<=U){const K=U+1,ee=K<$?m[K].el:b;for(;I<=U;)x(null,m[I]=k?En(m[I]):Vt(m[I]),w,ee,_,C,N,A,k),I++}}else if(I>U)for(;I<=F;)yn(d[I],_,C,!0),I++;else{const K=I,ee=I,ve=new Map;for(I=ee;I<=U;I++){const yt=m[I]=k?En(m[I]):Vt(m[I]);yt.key!=null&&ve.set(yt.key,I)}let fe,me=0;const Pt=U-ee+1;let Rr=!1,Dh=0;const Ns=new Array(Pt);for(I=0;I<Pt;I++)Ns[I]=0;for(I=K;I<=F;I++){const yt=d[I];if(me>=Pt){yn(yt,_,C,!0);continue}let Ut;if(yt.key!=null)Ut=ve.get(yt.key);else for(fe=ee;fe<=U;fe++)if(Ns[fe-ee]===0&&Rs(yt,m[fe])){Ut=fe;break}Ut===void 0?yn(yt,_,C,!0):(Ns[Ut-ee]=I+1,Ut>=Dh?Dh=Ut:Rr=!0,x(yt,m[Ut],w,null,_,C,N,A,k),me++)}const Nh=Rr?zw(Ns):Hr;for(fe=Nh.length-1,I=Pt-1;I>=0;I--){const yt=ee+I,Ut=m[yt],Rh=yt+1<$?m[yt+1].el:b;Ns[I]===0?x(null,Ut,w,Rh,_,C,N,A,k):Rr&&(fe<0||I!==Nh[fe]?Rt(Ut,w,Rh,2):fe--)}}},Rt=(d,m,w,b,_=null)=>{const{el:C,type:N,transition:A,children:k,shapeFlag:I}=d;if(I&6){Rt(d.component.subTree,m,w,b);return}if(I&128){d.suspense.move(m,w,b);return}if(I&64){N.move(d,m,w,Nr);return}if(N===nn){r(C,m,w);for(let F=0;F<k.length;F++)Rt(k[F],m,w,b);r(d.anchor,m,w);return}if(N===_o){ce(d,m,w);return}if(b!==2&&I&1&&A)if(b===0)A.beforeEnter(C),r(C,m,w),pt(()=>A.enter(C),_);else{const{leave:F,delayLeave:U,afterLeave:K}=A,ee=()=>r(C,m,w),ve=()=>{F(C,()=>{ee(),K&&K()})};U?U(C,ee,ve):ve()}else r(C,m,w)},yn=(d,m,w,b=!1,_=!1)=>{const{type:C,props:N,ref:A,children:k,dynamicChildren:I,shapeFlag:$,patchFlag:F,dirs:U}=d;if(A!=null&&Lu(A,null,w,d,!0),$&256){m.ctx.deactivate(d);return}const K=$&1&&U,ee=!Ru(d);let ve;if(ee&&(ve=N&&N.onVnodeBeforeUnmount)&&Bt(ve,m,d),$&6)hv(d.component,w,b);else{if($&128){d.suspense.unmount(w,b);return}K&&Bn(d,null,m,"beforeUnmount"),$&64?d.type.remove(d,m,w,_,Nr,b):I&&(C!==nn||F>0&&F&64)?en(I,m,w,!1,!0):(C===nn&&F&384||!_&&$&16)&&en(k,m,w),b&&kh(d)}(ee&&(ve=N&&N.onVnodeUnmounted)||K)&&pt(()=>{ve&&Bt(ve,m,d),K&&Bn(d,null,m,"unmounted")},w)},kh=d=>{const{type:m,el:w,anchor:b,transition:_}=d;if(m===nn){lv(w,b);return}if(m===_o){st(d);return}const C=()=>{s(w),_&&!_.persisted&&_.afterLeave&&_.afterLeave()};if(d.shapeFlag&1&&_&&!_.persisted){const{leave:N,delayLeave:A}=_,k=()=>N(w,C);A?A(d.el,C,k):k()}else C()},lv=(d,m)=>{let w;for(;d!==m;)w=f(d),s(d),d=w;s(m)},hv=(d,m,w)=>{const{bum:b,scope:_,update:C,subTree:N,um:A}=d;b&&eu(b),_.stop(),C&&(C.active=!1,yn(N,d,m,w)),A&&pt(A,m),pt(()=>{d.isUnmounted=!0},m),m&&m.pendingBranch&&!m.isUnmounted&&d.asyncDep&&!d.asyncResolved&&d.suspenseId===m.pendingId&&(m.deps--,m.deps===0&&m.resolve())},en=(d,m,w,b=!1,_=!1,C=0)=>{for(let N=C;N<d.length;N++)yn(d[N],m,w,b,_)},Xi=d=>d.shapeFlag&6?Xi(d.component.subTree):d.shapeFlag&128?d.suspense.next():f(d.anchor||d.el),Oh=(d,m,w)=>{d==null?m._vnode&&yn(m._vnode,null,null,!0):x(m._vnode||null,d,m,null,null,null,w),hp(),m._vnode=d},Nr={p:x,um:yn,m:Rt,r:kh,mt:G,mc:le,pc:Nt,pbc:J,n:Xi,o:t};let Ja,Xa;return e&&([Ja,Xa]=e(Nr)),{render:Oh,hydrate:Ja,createApp:Kw(Oh,Ja)}}function jn({effect:t,update:e},n){t.allowRecurse=e.allowRecurse=n}function Cp(t,e,n=!1){const r=t.children,s=e.children;if(H(r)&&H(s))for(let i=0;i<r.length;i++){const o=r[i];let a=s[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[i]=En(s[i]),a.el=o.el),n||Cp(o,a))}}function zw(t){const e=t.slice(),n=[0];let r,s,i,o,a;const u=t.length;for(r=0;r<u;r++){const c=t[r];if(c!==0){if(s=n[n.length-1],t[s]<c){e[r]=s,n.push(r);continue}for(i=0,o=n.length-1;i<o;)a=i+o>>1,t[n[a]]<c?i=a+1:o=a;c<t[n[i]]&&(i>0&&(e[r]=n[i-1]),n[i]=r)}}for(i=n.length,o=n[i-1];i-- >0;)n[i]=o,o=e[o];return n}const Ww=t=>t.__isTeleport,Qw=Symbol(),nn=Symbol(void 0),Uc=Symbol(void 0),nr=Symbol(void 0),_o=Symbol(void 0),Ks=[];let Zn=null;function Yw(t=!1){Ks.push(Zn=t?null:[])}function Jw(){Ks.pop(),Zn=Ks[Ks.length-1]||null}let Po=1;function Qh(t){Po+=t}function kp(t){return t.dynamicChildren=Po>0?Zn||Hr:null,Jw(),Po>0&&Zn&&Zn.push(t),t}function I1(t,e,n,r,s,i){return kp(Dp(t,e,n,r,s,i,!0))}function Xw(t,e,n,r,s){return kp(zt(t,e,n,r,s,!0))}function Zw(t){return t?t.__v_isVNode===!0:!1}function Rs(t,e){return t.type===e.type&&t.key===e.key}const da="__vInternal",Op=({key:t})=>t!=null?t:null,bo=({ref:t,ref_key:e,ref_for:n})=>t!=null?We(t)||tt(t)||z(t)?{i:sn,r:t,k:e,f:!!n}:t:null;function Dp(t,e=null,n=null,r=0,s=null,i=t===nn?0:1,o=!1,a=!1){const u={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&Op(e),ref:e&&bo(e),scopeId:pp,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:s,dynamicChildren:null,appContext:null};return a?(Bc(u,n),i&128&&t.normalize(u)):n&&(u.shapeFlag|=We(n)?8:16),Po>0&&!o&&Zn&&(u.patchFlag>0||i&6)&&u.patchFlag!==32&&Zn.push(u),u}const zt=e_;function e_(t,e=null,n=null,r=0,s=null,i=!1){if((!t||t===Qw)&&(t=nr),Zw(t)){const a=ei(t,e,!0);return n&&Bc(a,n),a}if(f_(t)&&(t=t.__vccOpts),e){e=t_(e);let{class:a,style:u}=e;a&&!We(a)&&(e.class=Ec(a)),Qe(u)&&(sp(u)&&!H(u)&&(u=ft({},u)),e.style=bc(u))}const o=We(t)?1:yw(t)?128:Ww(t)?64:Qe(t)?4:z(t)?2:0;return Dp(t,e,n,r,s,o,i,!0)}function t_(t){return t?sp(t)||da in t?ft({},t):t:null}function ei(t,e,n=!1){const{props:r,ref:s,patchFlag:i,children:o}=t,a=e?r_(r||{},e):r;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:a,key:a&&Op(a),ref:e&&e.ref?n&&s?H(s)?s.concat(bo(e)):[s,bo(e)]:bo(e):s,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==nn?i===-1?16:i|16:i,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&ei(t.ssContent),ssFallback:t.ssFallback&&ei(t.ssFallback),el:t.el,anchor:t.anchor}}function n_(t=" ",e=0){return zt(Uc,null,t,e)}function S1(t,e){const n=zt(_o,null,t);return n.staticCount=e,n}function x1(t="",e=!1){return e?(Yw(),Xw(nr,null,t)):zt(nr,null,t)}function Vt(t){return t==null||typeof t=="boolean"?zt(nr):H(t)?zt(nn,null,t.slice()):typeof t=="object"?En(t):zt(Uc,null,String(t))}function En(t){return t.el===null||t.memo?t:ei(t)}function Bc(t,e){let n=0;const{shapeFlag:r}=t;if(e==null)e=null;else if(H(e))n=16;else if(typeof e=="object")if(r&65){const s=e.default;s&&(s._c&&(s._d=!1),Bc(t,s()),s._c&&(s._d=!0));return}else{n=32;const s=e._;!s&&!(da in e)?e._ctx=sn:s===3&&sn&&(sn.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else z(e)?(e={default:e,_ctx:sn},n=32):(e=String(e),r&64?(n=16,e=[n_(e)]):n=8);t.children=e,t.shapeFlag|=n}function r_(...t){const e={};for(let n=0;n<t.length;n++){const r=t[n];for(const s in r)if(s==="class")e.class!==r.class&&(e.class=Ec([e.class,r.class]));else if(s==="style")e.style=bc([e.style,r.style]);else if(aa(s)){const i=e[s],o=r[s];o&&i!==o&&!(H(i)&&i.includes(o))&&(e[s]=i?[].concat(i,o):o)}else s!==""&&(e[s]=r[s])}return e}function Bt(t,e,n,r=null){Lt(t,e,7,[n,r])}const qu=t=>t?Np(t)?jc(t)||t.proxy:qu(t.parent):null,Mo=ft(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>qu(t.parent),$root:t=>qu(t.root),$emit:t=>t.emit,$options:t=>bp(t),$forceUpdate:t=>()=>up(t.update),$nextTick:t=>ow.bind(t.proxy),$watch:t=>_w.bind(t)}),s_={get({_:t},e){const{ctx:n,setupState:r,data:s,props:i,accessCache:o,type:a,appContext:u}=t;let c;if(e[0]!=="$"){const p=o[e];if(p!==void 0)switch(p){case 1:return r[e];case 2:return s[e];case 4:return n[e];case 3:return i[e]}else{if(r!==pe&&ne(r,e))return o[e]=1,r[e];if(s!==pe&&ne(s,e))return o[e]=2,s[e];if((c=t.propsOptions[0])&&ne(c,e))return o[e]=3,i[e];if(n!==pe&&ne(n,e))return o[e]=4,n[e];Pu&&(o[e]=0)}}const l=Mo[e];let h,f;if(l)return e==="$attrs"&&Tt(t,"get",e),l(t);if((h=a.__cssModules)&&(h=h[e]))return h;if(n!==pe&&ne(n,e))return o[e]=4,n[e];if(f=u.config.globalProperties,ne(f,e))return f[e]},set({_:t},e,n){const{data:r,setupState:s,ctx:i}=t;return s!==pe&&ne(s,e)?(s[e]=n,!0):r!==pe&&ne(r,e)?(r[e]=n,!0):ne(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(i[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:r,appContext:s,propsOptions:i}},o){let a;return!!n[o]||t!==pe&&ne(t,o)||e!==pe&&ne(e,o)||(a=i[0])&&ne(a,o)||ne(r,o)||ne(Mo,o)||ne(s.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?this.set(t,e,n.get(),null):n.value!=null&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}},i_=Ap();let o_=0;function a_(t,e,n){const r=t.type,s=(e?e.appContext:t.appContext)||i_,i={uid:o_++,vnode:t,type:r,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new Sv(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Tp(r,s),emitsOptions:dp(r,s),emit:null,emitted:null,propsDefaults:pe,inheritAttrs:r.inheritAttrs,ctx:pe,data:pe,props:pe,attrs:pe,slots:pe,refs:pe,setupState:pe,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=hw.bind(null,i),t.ce&&t.ce(i),i}let Ze=null;const es=t=>{Ze=t,t.scope.on()},er=()=>{Ze&&Ze.scope.off(),Ze=null};function Np(t){return t.vnode.shapeFlag&4}let ti=!1;function u_(t,e=!1){ti=e;const{props:n,children:r}=t.vnode,s=Np(t);qw(t,n,s,e),Bw(t,r);const i=s?c_(t,e):void 0;return ti=!1,i}function c_(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=ip(new Proxy(t.ctx,s_));const{setup:r}=n;if(r){const s=t.setupContext=r.length>1?h_(t):null;es(t),ws();const i=An(r,t,0,[t.props,s]);if(_s(),er(),jd(i)){if(i.then(er,er),e)return i.then(o=>{Yh(t,o,e)}).catch(o=>{ha(o,t,0)});t.asyncDep=i}else Yh(t,i,e)}else Rp(t,e)}function Yh(t,e,n){z(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Qe(e)&&(t.setupState=op(e)),Rp(t,n)}let Jh;function Rp(t,e,n){const r=t.type;if(!t.render){if(!e&&Jh&&!r.render){const s=r.template;if(s){const{isCustomElement:i,compilerOptions:o}=t.appContext.config,{delimiters:a,compilerOptions:u}=r,c=ft(ft({isCustomElement:i,delimiters:a},o),u);r.render=Jh(s,c)}}t.render=r.render||Ft}es(t),ws(),Rw(t),_s(),er()}function l_(t){return new Proxy(t.attrs,{get(e,n){return Tt(t,"get","$attrs"),e[n]}})}function h_(t){const e=r=>{t.exposed=r||{}};let n;return{get attrs(){return n||(n=l_(t))},slots:t.slots,emit:t.emit,expose:e}}function jc(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(op(ip(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in Mo)return Mo[n](t)}}))}function f_(t){return z(t)&&"__vccOpts"in t}const d_=(t,e)=>sw(t,e,ti),p_="3.2.31",m_="http://www.w3.org/2000/svg",Gn=typeof document!="undefined"?document:null,Xh=Gn&&Gn.createElement("template"),g_={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,r)=>{const s=e?Gn.createElementNS(m_,t):Gn.createElement(t,n?{is:n}:void 0);return t==="select"&&r&&r.multiple!=null&&s.setAttribute("multiple",r.multiple),s},createText:t=>Gn.createTextNode(t),createComment:t=>Gn.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Gn.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},cloneNode(t){const e=t.cloneNode(!0);return"_value"in t&&(e._value=t._value),e},insertStaticContent(t,e,n,r,s,i){const o=n?n.previousSibling:e.lastChild;if(s&&(s===i||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),n),!(s===i||!(s=s.nextSibling)););else{Xh.innerHTML=r?`<svg>${t}</svg>`:t;const a=Xh.content;if(r){const u=a.firstChild;for(;u.firstChild;)a.appendChild(u.firstChild);a.removeChild(u)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}};function y_(t,e,n){const r=t._vtc;r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}function v_(t,e,n){const r=t.style,s=We(n);if(n&&!s){for(const i in n)$u(r,i,n[i]);if(e&&!We(e))for(const i in e)n[i]==null&&$u(r,i,"")}else{const i=r.display;s?e!==n&&(r.cssText=n):e&&t.removeAttribute("style"),"_vod"in t&&(r.display=i)}}const Zh=/\s*!important$/;function $u(t,e,n){if(H(n))n.forEach(r=>$u(t,e,r));else if(e.startsWith("--"))t.setProperty(e,n);else{const r=w_(t,e);Zh.test(n)?t.setProperty(vs(r),n.replace(Zh,""),"important"):t[r]=n}}const ef=["Webkit","Moz","ms"],su={};function w_(t,e){const n=su[e];if(n)return n;let r=Zr(e);if(r!=="filter"&&r in t)return su[e]=r;r=Gd(r);for(let s=0;s<ef.length;s++){const i=ef[s]+r;if(i in t)return su[e]=i}return e}const tf="http://www.w3.org/1999/xlink";function __(t,e,n,r,s){if(r&&e.startsWith("xlink:"))n==null?t.removeAttributeNS(tf,e.slice(6,e.length)):t.setAttributeNS(tf,e,n);else{const i=dv(e);n==null||i&&!$d(n)?t.removeAttribute(e):t.setAttribute(e,i?"":n)}}function b_(t,e,n,r,s,i,o){if(e==="innerHTML"||e==="textContent"){r&&o(r,s,i),t[e]=n==null?"":n;return}if(e==="value"&&t.tagName!=="PROGRESS"&&!t.tagName.includes("-")){t._value=n;const a=n==null?"":n;(t.value!==a||t.tagName==="OPTION")&&(t.value=a),n==null&&t.removeAttribute(e);return}if(n===""||n==null){const a=typeof t[e];if(a==="boolean"){t[e]=$d(n);return}else if(n==null&&a==="string"){t[e]="",t.removeAttribute(e);return}else if(a==="number"){try{t[e]=0}catch{}t.removeAttribute(e);return}}try{t[e]=n}catch{}}let Fo=Date.now,Pp=!1;if(typeof window!="undefined"){Fo()>document.createEvent("Event").timeStamp&&(Fo=()=>performance.now());const t=navigator.userAgent.match(/firefox\/(\d+)/i);Pp=!!(t&&Number(t[1])<=53)}let Uu=0;const E_=Promise.resolve(),T_=()=>{Uu=0},I_=()=>Uu||(E_.then(T_),Uu=Fo());function S_(t,e,n,r){t.addEventListener(e,n,r)}function x_(t,e,n,r){t.removeEventListener(e,n,r)}function A_(t,e,n,r,s=null){const i=t._vei||(t._vei={}),o=i[e];if(r&&o)o.value=r;else{const[a,u]=C_(e);if(r){const c=i[e]=k_(r,s);S_(t,a,c,u)}else o&&(x_(t,a,o,u),i[e]=void 0)}}const nf=/(?:Once|Passive|Capture)$/;function C_(t){let e;if(nf.test(t)){e={};let n;for(;n=t.match(nf);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[vs(t.slice(2)),e]}function k_(t,e){const n=r=>{const s=r.timeStamp||Fo();(Pp||s>=n.attached-1)&&Lt(O_(r,n.value),e,5,[r])};return n.value=t,n.attached=I_(),n}function O_(t,e){if(H(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(r=>s=>!s._stopped&&r&&r(s))}else return e}const rf=/^on[a-z]/,D_=(t,e,n,r,s=!1,i,o,a,u)=>{e==="class"?y_(t,r,s):e==="style"?v_(t,n,r):aa(e)?Tc(e)||A_(t,e,n,r,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):N_(t,e,r,s))?b_(t,e,r,i,o,a,u):(e==="true-value"?t._trueValue=r:e==="false-value"&&(t._falseValue=r),__(t,e,r,s))};function N_(t,e,n,r){return r?!!(e==="innerHTML"||e==="textContent"||e in t&&rf.test(e)&&z(n)):e==="spellcheck"||e==="draggable"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA"||rf.test(e)&&We(n)?!1:e in t}const R_=ft({patchProp:D_},g_);let sf;function P_(){return sf||(sf=Gw(R_))}const A1=(...t)=>{const e=P_().createApp(...t),{mount:n}=e;return e.mount=r=>{const s=M_(r);if(!s)return;const i=e._component;!z(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.innerHTML="";const o=n(s,!1,s instanceof SVGElement);return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e};function M_(t){return We(t)?document.querySelector(t):t}var Qr=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},Vc={exports:{}},Mp=function(e,n){return function(){for(var s=new Array(arguments.length),i=0;i<s.length;i++)s[i]=arguments[i];return e.apply(n,s)}},F_=Mp,wr=Object.prototype.toString;function Kc(t){return wr.call(t)==="[object Array]"}function Bu(t){return typeof t=="undefined"}function L_(t){return t!==null&&!Bu(t)&&t.constructor!==null&&!Bu(t.constructor)&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)}function q_(t){return wr.call(t)==="[object ArrayBuffer]"}function $_(t){return typeof FormData!="undefined"&&t instanceof FormData}function U_(t){var e;return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&t.buffer instanceof ArrayBuffer,e}function B_(t){return typeof t=="string"}function j_(t){return typeof t=="number"}function Fp(t){return t!==null&&typeof t=="object"}function Eo(t){if(wr.call(t)!=="[object Object]")return!1;var e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}function V_(t){return wr.call(t)==="[object Date]"}function K_(t){return wr.call(t)==="[object File]"}function G_(t){return wr.call(t)==="[object Blob]"}function Lp(t){return wr.call(t)==="[object Function]"}function H_(t){return Fp(t)&&Lp(t.pipe)}function z_(t){return typeof URLSearchParams!="undefined"&&t instanceof URLSearchParams}function W_(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function Q_(){return typeof navigator!="undefined"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window!="undefined"&&typeof document!="undefined"}function Gc(t,e){if(!(t===null||typeof t=="undefined"))if(typeof t!="object"&&(t=[t]),Kc(t))for(var n=0,r=t.length;n<r;n++)e.call(null,t[n],n,t);else for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.call(null,t[s],s,t)}function ju(){var t={};function e(s,i){Eo(t[i])&&Eo(s)?t[i]=ju(t[i],s):Eo(s)?t[i]=ju({},s):Kc(s)?t[i]=s.slice():t[i]=s}for(var n=0,r=arguments.length;n<r;n++)Gc(arguments[n],e);return t}function Y_(t,e,n){return Gc(e,function(s,i){n&&typeof s=="function"?t[i]=F_(s,n):t[i]=s}),t}function J_(t){return t.charCodeAt(0)===65279&&(t=t.slice(1)),t}var St={isArray:Kc,isArrayBuffer:q_,isBuffer:L_,isFormData:$_,isArrayBufferView:U_,isString:B_,isNumber:j_,isObject:Fp,isPlainObject:Eo,isUndefined:Bu,isDate:V_,isFile:K_,isBlob:G_,isFunction:Lp,isStream:H_,isURLSearchParams:z_,isStandardBrowserEnv:Q_,forEach:Gc,merge:ju,extend:Y_,trim:W_,stripBOM:J_},Pr=St;function of(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var qp=function(e,n,r){if(!n)return e;var s;if(r)s=r(n);else if(Pr.isURLSearchParams(n))s=n.toString();else{var i=[];Pr.forEach(n,function(u,c){u===null||typeof u=="undefined"||(Pr.isArray(u)?c=c+"[]":u=[u],Pr.forEach(u,function(h){Pr.isDate(h)?h=h.toISOString():Pr.isObject(h)&&(h=JSON.stringify(h)),i.push(of(c)+"="+of(h))}))}),s=i.join("&")}if(s){var o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e},X_=St;function pa(){this.handlers=[]}pa.prototype.use=function(e,n,r){return this.handlers.push({fulfilled:e,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1};pa.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)};pa.prototype.forEach=function(e){X_.forEach(this.handlers,function(r){r!==null&&e(r)})};var Z_=pa,eb=St,tb=function(e,n){eb.forEach(e,function(s,i){i!==n&&i.toUpperCase()===n.toUpperCase()&&(e[n]=s,delete e[i])})},$p=function(e,n,r,s,i){return e.config=n,r&&(e.code=r),e.request=s,e.response=i,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e},nb=$p,Up=function(e,n,r,s,i){var o=new Error(e);return nb(o,n,r,s,i)},rb=Up,sb=function(e,n,r){var s=r.config.validateStatus;!r.status||!s||s(r.status)?e(r):n(rb("Request failed with status code "+r.status,r.config,null,r.request,r))},so=St,ib=so.isStandardBrowserEnv()?function(){return{write:function(n,r,s,i,o,a){var u=[];u.push(n+"="+encodeURIComponent(r)),so.isNumber(s)&&u.push("expires="+new Date(s).toGMTString()),so.isString(i)&&u.push("path="+i),so.isString(o)&&u.push("domain="+o),a===!0&&u.push("secure"),document.cookie=u.join("; ")},read:function(n){var r=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove:function(n){this.write(n,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),ob=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)},ab=function(e,n){return n?e.replace(/\/+$/,"")+"/"+n.replace(/^\/+/,""):e},ub=ob,cb=ab,lb=function(e,n){return e&&!ub(n)?cb(e,n):n},iu=St,hb=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],fb=function(e){var n={},r,s,i;return e&&iu.forEach(e.split(`
`),function(a){if(i=a.indexOf(":"),r=iu.trim(a.substr(0,i)).toLowerCase(),s=iu.trim(a.substr(i+1)),r){if(n[r]&&hb.indexOf(r)>=0)return;r==="set-cookie"?n[r]=(n[r]?n[r]:[]).concat([s]):n[r]=n[r]?n[r]+", "+s:s}}),n},af=St,db=af.isStandardBrowserEnv()?function(){var e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a"),r;function s(i){var o=i;return e&&(n.setAttribute("href",o),o=n.href),n.setAttribute("href",o),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return r=s(window.location.href),function(o){var a=af.isString(o)?s(o):o;return a.protocol===r.protocol&&a.host===r.host}}():function(){return function(){return!0}}(),io=St,pb=sb,mb=ib,gb=qp,yb=lb,vb=fb,wb=db,ou=Up,uf=function(e){return new Promise(function(r,s){var i=e.data,o=e.headers,a=e.responseType;io.isFormData(i)&&delete o["Content-Type"];var u=new XMLHttpRequest;if(e.auth){var c=e.auth.username||"",l=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";o.Authorization="Basic "+btoa(c+":"+l)}var h=yb(e.baseURL,e.url);u.open(e.method.toUpperCase(),gb(h,e.params,e.paramsSerializer),!0),u.timeout=e.timeout;function f(){if(!!u){var g="getAllResponseHeaders"in u?vb(u.getAllResponseHeaders()):null,T=!a||a==="text"||a==="json"?u.responseText:u.response,x={data:T,status:u.status,statusText:u.statusText,headers:g,config:e,request:u};pb(r,s,x),u=null}}if("onloadend"in u?u.onloadend=f:u.onreadystatechange=function(){!u||u.readyState!==4||u.status===0&&!(u.responseURL&&u.responseURL.indexOf("file:")===0)||setTimeout(f)},u.onabort=function(){!u||(s(ou("Request aborted",e,"ECONNABORTED",u)),u=null)},u.onerror=function(){s(ou("Network Error",e,null,u)),u=null},u.ontimeout=function(){var T="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(T=e.timeoutErrorMessage),s(ou(T,e,e.transitional&&e.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",u)),u=null},io.isStandardBrowserEnv()){var p=(e.withCredentials||wb(h))&&e.xsrfCookieName?mb.read(e.xsrfCookieName):void 0;p&&(o[e.xsrfHeaderName]=p)}"setRequestHeader"in u&&io.forEach(o,function(T,x){typeof i=="undefined"&&x.toLowerCase()==="content-type"?delete o[x]:u.setRequestHeader(x,T)}),io.isUndefined(e.withCredentials)||(u.withCredentials=!!e.withCredentials),a&&a!=="json"&&(u.responseType=e.responseType),typeof e.onDownloadProgress=="function"&&u.addEventListener("progress",e.onDownloadProgress),typeof e.onUploadProgress=="function"&&u.upload&&u.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(T){!u||(u.abort(),s(T),u=null)}),i||(i=null),u.send(i)})},je=St,cf=tb,_b=$p,bb={"Content-Type":"application/x-www-form-urlencoded"};function lf(t,e){!je.isUndefined(t)&&je.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}function Eb(){var t;return(typeof XMLHttpRequest!="undefined"||typeof process!="undefined"&&Object.prototype.toString.call(process)==="[object process]")&&(t=uf),t}function Tb(t,e,n){if(je.isString(t))try{return(e||JSON.parse)(t),je.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(t)}var ma={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:Eb(),transformRequest:[function(e,n){return cf(n,"Accept"),cf(n,"Content-Type"),je.isFormData(e)||je.isArrayBuffer(e)||je.isBuffer(e)||je.isStream(e)||je.isFile(e)||je.isBlob(e)?e:je.isArrayBufferView(e)?e.buffer:je.isURLSearchParams(e)?(lf(n,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):je.isObject(e)||n&&n["Content-Type"]==="application/json"?(lf(n,"application/json"),Tb(e)):e}],transformResponse:[function(e){var n=this.transitional,r=n&&n.silentJSONParsing,s=n&&n.forcedJSONParsing,i=!r&&this.responseType==="json";if(i||s&&je.isString(e)&&e.length)try{return JSON.parse(e)}catch(o){if(i)throw o.name==="SyntaxError"?_b(o,this,"E_JSON_PARSE"):o}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300}};ma.headers={common:{Accept:"application/json, text/plain, */*"}};je.forEach(["delete","get","head"],function(e){ma.headers[e]={}});je.forEach(["post","put","patch"],function(e){ma.headers[e]=je.merge(bb)});var Hc=ma,Ib=St,Sb=Hc,xb=function(e,n,r){var s=this||Sb;return Ib.forEach(r,function(o){e=o.call(s,e,n)}),e},Bp=function(e){return!!(e&&e.__CANCEL__)},hf=St,au=xb,Ab=Bp,Cb=Hc;function uu(t){t.cancelToken&&t.cancelToken.throwIfRequested()}var kb=function(e){uu(e),e.headers=e.headers||{},e.data=au.call(e,e.data,e.headers,e.transformRequest),e.headers=hf.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),hf.forEach(["delete","get","head","post","put","patch","common"],function(s){delete e.headers[s]});var n=e.adapter||Cb.adapter;return n(e).then(function(s){return uu(e),s.data=au.call(e,s.data,s.headers,e.transformResponse),s},function(s){return Ab(s)||(uu(e),s&&s.response&&(s.response.data=au.call(e,s.response.data,s.response.headers,e.transformResponse))),Promise.reject(s)})},Je=St,jp=function(e,n){n=n||{};var r={},s=["url","method","data"],i=["headers","auth","proxy","params"],o=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],a=["validateStatus"];function u(f,p){return Je.isPlainObject(f)&&Je.isPlainObject(p)?Je.merge(f,p):Je.isPlainObject(p)?Je.merge({},p):Je.isArray(p)?p.slice():p}function c(f){Je.isUndefined(n[f])?Je.isUndefined(e[f])||(r[f]=u(void 0,e[f])):r[f]=u(e[f],n[f])}Je.forEach(s,function(p){Je.isUndefined(n[p])||(r[p]=u(void 0,n[p]))}),Je.forEach(i,c),Je.forEach(o,function(p){Je.isUndefined(n[p])?Je.isUndefined(e[p])||(r[p]=u(void 0,e[p])):r[p]=u(void 0,n[p])}),Je.forEach(a,function(p){p in n?r[p]=u(e[p],n[p]):p in e&&(r[p]=u(void 0,e[p]))});var l=s.concat(i).concat(o).concat(a),h=Object.keys(e).concat(Object.keys(n)).filter(function(p){return l.indexOf(p)===-1});return Je.forEach(h,c),r};const Ob="axios",Db="0.21.4",Nb="Promise based HTTP client for the browser and node.js",Rb="index.js",Pb={test:"grunt test",start:"node ./sandbox/server.js",build:"NODE_ENV=production grunt build",preversion:"npm test",version:"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json",postversion:"git push && git push --tags",examples:"node ./examples/server.js",coveralls:"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js",fix:"eslint --fix lib/**/*.js"},Mb={type:"git",url:"https://github.com/axios/axios.git"},Fb=["xhr","http","ajax","promise","node"],Lb="Matt Zabriskie",qb="MIT",$b={url:"https://github.com/axios/axios/issues"},Ub="https://axios-http.com",Bb={coveralls:"^3.0.0","es6-promise":"^4.2.4",grunt:"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1",karma:"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2",minimist:"^1.2.0",mocha:"^8.2.1",sinon:"^4.5.0","terser-webpack-plugin":"^4.2.3",typescript:"^4.0.5","url-search-params":"^0.10.0",webpack:"^4.44.2","webpack-dev-server":"^3.11.0"},jb={"./lib/adapters/http.js":"./lib/adapters/xhr.js"},Vb="dist/axios.min.js",Kb="dist/axios.min.js",Gb="./index.d.ts",Hb={"follow-redirects":"^1.14.0"},zb=[{path:"./dist/axios.min.js",threshold:"5kB"}];var Wb={name:Ob,version:Db,description:Nb,main:Rb,scripts:Pb,repository:Mb,keywords:Fb,author:Lb,license:qb,bugs:$b,homepage:Ub,devDependencies:Bb,browser:jb,jsdelivr:Vb,unpkg:Kb,typings:Gb,dependencies:Hb,bundlesize:zb},Vp=Wb,zc={};["object","boolean","number","function","string","symbol"].forEach(function(t,e){zc[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}});var ff={},Qb=Vp.version.split(".");function Kp(t,e){for(var n=e?e.split("."):Qb,r=t.split("."),s=0;s<3;s++){if(n[s]>r[s])return!0;if(n[s]<r[s])return!1}return!1}zc.transitional=function(e,n,r){var s=n&&Kp(n);function i(o,a){return"[Axios v"+Vp.version+"] Transitional option '"+o+"'"+a+(r?". "+r:"")}return function(o,a,u){if(e===!1)throw new Error(i(a," has been removed in "+n));return s&&!ff[a]&&(ff[a]=!0,console.warn(i(a," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(o,a,u):!0}};function Yb(t,e,n){if(typeof t!="object")throw new TypeError("options must be an object");for(var r=Object.keys(t),s=r.length;s-- >0;){var i=r[s],o=e[i];if(o){var a=t[i],u=a===void 0||o(a,i,t);if(u!==!0)throw new TypeError("option "+i+" must be "+u);continue}if(n!==!0)throw Error("Unknown option "+i)}}var Jb={isOlderVersion:Kp,assertOptions:Yb,validators:zc},Gp=St,Xb=qp,df=Z_,pf=kb,ga=jp,Hp=Jb,Mr=Hp.validators;function Ai(t){this.defaults=t,this.interceptors={request:new df,response:new df}}Ai.prototype.request=function(e){typeof e=="string"?(e=arguments[1]||{},e.url=arguments[0]):e=e||{},e=ga(this.defaults,e),e.method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var n=e.transitional;n!==void 0&&Hp.assertOptions(n,{silentJSONParsing:Mr.transitional(Mr.boolean,"1.0.0"),forcedJSONParsing:Mr.transitional(Mr.boolean,"1.0.0"),clarifyTimeoutError:Mr.transitional(Mr.boolean,"1.0.0")},!1);var r=[],s=!0;this.interceptors.request.forEach(function(f){typeof f.runWhen=="function"&&f.runWhen(e)===!1||(s=s&&f.synchronous,r.unshift(f.fulfilled,f.rejected))});var i=[];this.interceptors.response.forEach(function(f){i.push(f.fulfilled,f.rejected)});var o;if(!s){var a=[pf,void 0];for(Array.prototype.unshift.apply(a,r),a=a.concat(i),o=Promise.resolve(e);a.length;)o=o.then(a.shift(),a.shift());return o}for(var u=e;r.length;){var c=r.shift(),l=r.shift();try{u=c(u)}catch(h){l(h);break}}try{o=pf(u)}catch(h){return Promise.reject(h)}for(;i.length;)o=o.then(i.shift(),i.shift());return o};Ai.prototype.getUri=function(e){return e=ga(this.defaults,e),Xb(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")};Gp.forEach(["delete","get","head","options"],function(e){Ai.prototype[e]=function(n,r){return this.request(ga(r||{},{method:e,url:n,data:(r||{}).data}))}});Gp.forEach(["post","put","patch"],function(e){Ai.prototype[e]=function(n,r,s){return this.request(ga(s||{},{method:e,url:n,data:r}))}});var Zb=Ai;function Wc(t){this.message=t}Wc.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")};Wc.prototype.__CANCEL__=!0;var zp=Wc,e0=zp;function Lo(t){if(typeof t!="function")throw new TypeError("executor must be a function.");var e;this.promise=new Promise(function(s){e=s});var n=this;t(function(s){n.reason||(n.reason=new e0(s),e(n.reason))})}Lo.prototype.throwIfRequested=function(){if(this.reason)throw this.reason};Lo.source=function(){var e,n=new Lo(function(s){e=s});return{token:n,cancel:e}};var t0=Lo,n0=function(e){return function(r){return e.apply(null,r)}},r0=function(e){return typeof e=="object"&&e.isAxiosError===!0},mf=St,s0=Mp,To=Zb,i0=jp,o0=Hc;function Wp(t){var e=new To(t),n=s0(To.prototype.request,e);return mf.extend(n,To.prototype,e),mf.extend(n,e),n}var qt=Wp(o0);qt.Axios=To;qt.create=function(e){return Wp(i0(qt.defaults,e))};qt.Cancel=zp;qt.CancelToken=t0;qt.isCancel=Bp;qt.all=function(e){return Promise.all(e)};qt.spread=n0;qt.isAxiosError=r0;Vc.exports=qt;Vc.exports.default=qt;var a0=Vc.exports,rr={exports:{}},Vu={exports:{}},ni=1e3,ri=ni*60,si=ri*60,ii=si*24,u0=ii*365.25,c0=function(t,e){e=e||{};var n=typeof t;if(n==="string"&&t.length>0)return l0(t);if(n==="number"&&isNaN(t)===!1)return e.long?f0(t):h0(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function l0(t){if(t=String(t),!(t.length>100)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(!!e){var n=parseFloat(e[1]),r=(e[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return n*u0;case"days":case"day":case"d":return n*ii;case"hours":case"hour":case"hrs":case"hr":case"h":return n*si;case"minutes":case"minute":case"mins":case"min":case"m":return n*ri;case"seconds":case"second":case"secs":case"sec":case"s":return n*ni;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}function h0(t){return t>=ii?Math.round(t/ii)+"d":t>=si?Math.round(t/si)+"h":t>=ri?Math.round(t/ri)+"m":t>=ni?Math.round(t/ni)+"s":t+"ms"}function f0(t){return oo(t,ii,"day")||oo(t,si,"hour")||oo(t,ri,"minute")||oo(t,ni,"second")||t+" ms"}function oo(t,e,n){if(!(t<e))return t<e*1.5?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}(function(t,e){e=t.exports=s.debug=s.default=s,e.coerce=u,e.disable=o,e.enable=i,e.enabled=a,e.humanize=c0,e.names=[],e.skips=[],e.formatters={};var n;function r(c){var l=0,h;for(h in c)l=(l<<5)-l+c.charCodeAt(h),l|=0;return e.colors[Math.abs(l)%e.colors.length]}function s(c){function l(){if(!!l.enabled){var h=l,f=+new Date,p=f-(n||f);h.diff=p,h.prev=n,h.curr=f,n=f;for(var g=new Array(arguments.length),T=0;T<g.length;T++)g[T]=arguments[T];g[0]=e.coerce(g[0]),typeof g[0]!="string"&&g.unshift("%O");var x=0;g[0]=g[0].replace(/%([a-zA-Z%])/g,function(ie,ue){if(ie==="%%")return ie;x++;var ce=e.formatters[ue];if(typeof ce=="function"){var st=g[x];ie=ce.call(h,st),g.splice(x,1),x--}return ie}),e.formatArgs.call(h,g);var M=l.log||e.log||console.log.bind(console);M.apply(h,g)}}return l.namespace=c,l.enabled=e.enabled(c),l.useColors=e.useColors(),l.color=r(c),typeof e.init=="function"&&e.init(l),l}function i(c){e.save(c),e.names=[],e.skips=[];for(var l=(typeof c=="string"?c:"").split(/[\s,]+/),h=l.length,f=0;f<h;f++)!l[f]||(c=l[f].replace(/\*/g,".*?"),c[0]==="-"?e.skips.push(new RegExp("^"+c.substr(1)+"$")):e.names.push(new RegExp("^"+c+"$")))}function o(){e.enable("")}function a(c){var l,h;for(l=0,h=e.skips.length;l<h;l++)if(e.skips[l].test(c))return!1;for(l=0,h=e.names.length;l<h;l++)if(e.names[l].test(c))return!0;return!1}function u(c){return c instanceof Error?c.stack||c.message:c}})(Vu,Vu.exports);(function(t,e){e=t.exports=Vu.exports,e.log=s,e.formatArgs=r,e.save=i,e.load=o,e.useColors=n,e.storage=typeof chrome!="undefined"&&typeof chrome.storage!="undefined"?chrome.storage.local:a(),e.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function n(){return typeof window!="undefined"&&window.process&&window.process.type==="renderer"?!0:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}e.formatters.j=function(u){try{return JSON.stringify(u)}catch(c){return"[UnexpectedJSONParseError]: "+c.message}};function r(u){var c=this.useColors;if(u[0]=(c?"%c":"")+this.namespace+(c?" %c":" ")+u[0]+(c?"%c ":" ")+"+"+e.humanize(this.diff),!!c){var l="color: "+this.color;u.splice(1,0,l,"color: inherit");var h=0,f=0;u[0].replace(/%[a-zA-Z%]/g,function(p){p!=="%%"&&(h++,p==="%c"&&(f=h))}),u.splice(f,0,l)}}function s(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function i(u){try{u==null?e.storage.removeItem("debug"):e.storage.debug=u}catch{}}function o(){var u;try{u=e.storage.debug}catch{}return!u&&typeof process!="undefined"&&"env"in process&&(u={}.DEBUG),u}e.enable(o());function a(){try{return window.localStorage}catch{}}})(rr,rr.exports);var Qc={exports:{}};(function(t,e){(function(n,r){t.exports=r(n)})(typeof self!="undefined"?self:typeof window!="undefined"?window:Qr,function(n){n=n||{};var r=n.Base64,s="2.6.4",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=function(O){for(var G={},Z=0,Q=O.length;Z<Q;Z++)G[O.charAt(Z)]=Z;return G}(i),a=String.fromCharCode,u=function(O){if(O.length<2){var G=O.charCodeAt(0);return G<128?O:G<2048?a(192|G>>>6)+a(128|G&63):a(224|G>>>12&15)+a(128|G>>>6&63)+a(128|G&63)}else{var G=65536+(O.charCodeAt(0)-55296)*1024+(O.charCodeAt(1)-56320);return a(240|G>>>18&7)+a(128|G>>>12&63)+a(128|G>>>6&63)+a(128|G&63)}},c=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,l=function(O){return O.replace(c,u)},h=function(O){var G=[0,2,1][O.length%3],Z=O.charCodeAt(0)<<16|(O.length>1?O.charCodeAt(1):0)<<8|(O.length>2?O.charCodeAt(2):0),Q=[i.charAt(Z>>>18),i.charAt(Z>>>12&63),G>=2?"=":i.charAt(Z>>>6&63),G>=1?"=":i.charAt(Z&63)];return Q.join("")},f=n.btoa&&typeof n.btoa=="function"?function(O){return n.btoa(O)}:function(O){if(O.match(/[^\x00-\xFF]/))throw new RangeError("The string contains invalid characters.");return O.replace(/[\s\S]{1,3}/g,h)},p=function(O){return f(l(String(O)))},g=function(O){return O.replace(/[+\/]/g,function(G){return G=="+"?"-":"_"}).replace(/=/g,"")},T=function(O,G){return G?g(p(O)):p(O)},x=function(O){return T(O,!0)},M;n.Uint8Array&&(M=function(O,G){for(var Z="",Q=0,oe=O.length;Q<oe;Q+=3){var Nt=O[Q],Dr=O[Q+1],gn=O[Q+2],Rt=Nt<<16|Dr<<8|gn;Z+=i.charAt(Rt>>>18)+i.charAt(Rt>>>12&63)+(typeof Dr!="undefined"?i.charAt(Rt>>>6&63):"=")+(typeof gn!="undefined"?i.charAt(Rt&63):"=")}return G?g(Z):Z});var ie=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,ue=function(O){switch(O.length){case 4:var G=(7&O.charCodeAt(0))<<18|(63&O.charCodeAt(1))<<12|(63&O.charCodeAt(2))<<6|63&O.charCodeAt(3),Z=G-65536;return a((Z>>>10)+55296)+a((Z&1023)+56320);case 3:return a((15&O.charCodeAt(0))<<12|(63&O.charCodeAt(1))<<6|63&O.charCodeAt(2));default:return a((31&O.charCodeAt(0))<<6|63&O.charCodeAt(1))}},ce=function(O){return O.replace(ie,ue)},st=function(O){var G=O.length,Z=G%4,Q=(G>0?o[O.charAt(0)]<<18:0)|(G>1?o[O.charAt(1)]<<12:0)|(G>2?o[O.charAt(2)]<<6:0)|(G>3?o[O.charAt(3)]:0),oe=[a(Q>>>16),a(Q>>>8&255),a(Q&255)];return oe.length-=[0,0,2,1][Z],oe.join("")},xt=n.atob&&typeof n.atob=="function"?function(O){return n.atob(O)}:function(O){return O.replace(/\S{1,4}/g,st)},q=function(O){return xt(String(O).replace(/[^A-Za-z0-9\+\/]/g,""))},W=function(O){return ce(xt(O))},le=function(O){return String(O).replace(/[-_]/g,function(G){return G=="-"?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,"")},de=function(O){return W(le(O))},J;n.Uint8Array&&(J=function(O){return Uint8Array.from(q(le(O)),function(G){return G.charCodeAt(0)})});var dt=function(){var O=n.Base64;return n.Base64=r,O};if(n.Base64={VERSION:s,atob:q,btoa:f,fromBase64:de,toBase64:T,utob:l,encode:T,encodeURI:x,btou:ce,decode:de,noConflict:dt,fromUint8Array:M,toUint8Array:J},typeof Object.defineProperty=="function"){var mn=function(O){return{value:O,enumerable:!1,writable:!0,configurable:!0}};n.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",mn(function(){return de(this)})),Object.defineProperty(String.prototype,"toBase64",mn(function(O){return T(this,O)})),Object.defineProperty(String.prototype,"toBase64URI",mn(function(){return T(this,!0)}))}}return n.Meteor&&(Base64=n.Base64),t.exports&&(t.exports.Base64=n.Base64),{Base64:n.Base64}})})(Qc);var d0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p0=function(){function t(e,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),m0=a0,g0=Qp(m0),y0=rr.exports,v0=Qp(y0),w0=Qc.exports;function Qp(t){return t&&t.__esModule?t:{default:t}}function _0(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}else return Array.from(t)}function Yp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b0(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function E0(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}/**
* @file
* @copyright  2016 Yahoo Inc.
* @license    Licensed under {@link https://spdx.org/licenses/BSD-3-Clause-Clear.html BSD-3-Clause-Clear}.
*             Github.js is freely distributable.
*/var Gs=(0,v0.default)("github:request"),Jp=function(t){E0(e,t);function e(n,r,s){Yp(this,e);var i=b0(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,n));return i.path=r,i.request=s.config,i.response=(s||{}).response||s,i.status=s.status,i}return e}(Error),T0=function(){function t(e,n,r){Yp(this,t),this.__apiBase=n||"https://api.github.com",this.__auth={token:e.token,username:e.username,password:e.password},this.__AcceptHeader=r||"v3",e.token?this.__authorizationHeader="token "+e.token:e.username&&e.password&&(this.__authorizationHeader="Basic "+w0.Base64.encode(e.username+":"+e.password))}return p0(t,[{key:"__getURL",value:function(n){var r=n;n.indexOf("//")===-1&&(r=this.__apiBase+n);var s="timestamp="+new Date().getTime();return r.replace(/(timestamp=\d+)/,s)}},{key:"__getRequestHeaders",value:function(n,r){var s={"Content-Type":"application/json;charset=UTF-8",Accept:"application/vnd.github."+(r||this.__AcceptHeader)};return n&&(s.Accept+=".raw"),s.Accept+="+json",this.__authorizationHeader&&(s.Authorization=this.__authorizationHeader),s}},{key:"_getOptionsWithDefaults",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return n.visibility||n.affiliation||(n.type=n.type||"all"),n.sort=n.sort||"updated",n.per_page=n.per_page||"100",n}},{key:"_dateToISO",value:function(n){return n&&n instanceof Date&&(n=n.toISOString()),n}},{key:"_request",value:function(n,r,s,i,o){var a=this.__getURL(r),u=(s||{}).AcceptHeader;u&&delete s.AcceptHeader;var c=this.__getRequestHeaders(o,u),l={},h=s&&(typeof s=="undefined"?"undefined":d0(s))==="object"&&S0(n);h&&(l=s,s=void 0);var f={url:a,method:n,headers:c,params:l,data:s,responseType:o?"text":"json"};Gs(f.method+" to "+f.url);var p=(0,g0.default)(f).catch(gf(i,r));return i&&p.then(function(g){g.data&&Object.keys(g.data).length>0?i(null,g.data,g):f.method!=="GET"&&Object.keys(g.data).length<1?i(null,g.status<300,g):i(null,g.data,g)}),p}},{key:"_request204or404",value:function(n,r,s){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"GET";return this._request(i,n,r).then(function(a){return s&&s(null,!0,a),!0},function(a){if(a.response.status===404)return s&&s(null,!1,a),!1;throw s&&s(a),a})}},{key:"_requestAllPages",value:function(n,r,s,i){var o=this;return i=i||[],this._request("GET",n,r).then(function(a){var u,c=void 0;if(a.data instanceof Array)c=a.data;else if(a.data.items instanceof Array)c=a.data.items;else{var l="cannot figure out how to append "+a.data+" to the result set";throw new Jp(l,n,a)}(u=i).push.apply(u,_0(c));var h=x0(a.headers.link);return h&&(r||(r={}),r.page=parseInt(h.match(/([&\?]page=[0-9]*)/g).shift().split("=").pop()),!(r&&typeof r.page!="number"))?(Gs("getting next page: "+h),o._requestAllPages(h,r,s,i)):(s&&s(null,i,a),a.data=i,a)}).catch(gf(s,n))}}]),t}(),Jt=T0,I0=["GET","HEAD","DELETE"];function S0(t){return I0.indexOf(t)!==-1}function x0(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",e=t.split(/\s*,\s*/);return e.reduce(function(n,r){return r.search(/rel="next"/)!==-1?(r.match(/<(.*)>/)||[])[1]:n},void 0)}function gf(t,e){return function(r){var s=void 0;if(r.hasOwnProperty("config")){var i=r.response,o=i.status,a=i.statusText,u=r.config,c=u.method,l=u.url,h=o+" error making request "+c+" "+l+': "'+a+'"';s=new Jp(h,e,r),Gs(h+" "+JSON.stringify(r.data))}else s=r;if(t)Gs("going to error callback"),t(s);else throw Gs("throwing error"),s}}var A0=function(){function t(e,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),C0=Jt,k0=O0(C0);function O0(t){return t&&t.__esModule?t:{default:t}}function D0(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function N0(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function R0(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}/**
* @file
* @copyright  2013 Michael Aufreiter (Development Seed) and 2016 Yahoo Inc.
* @license    Licensed under {@link https://spdx.org/licenses/BSD-3-Clause-Clear.html BSD-3-Clause-Clear}.
*             Github.js is freely distributable.
*/var P0=function(t){R0(e,t);function e(n,r,s){D0(this,e);var i=N0(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r,s));return i.__id=n,i}return A0(e,[{key:"read",value:function(r){return this._request("GET","/gists/"+this.__id,null,r)}},{key:"create",value:function(r,s){var i=this;return this._request("POST","/gists",r,s).then(function(o){return i.__id=o.data.id,o})}},{key:"delete",value:function(r){return this._request("DELETE","/gists/"+this.__id,null,r)}},{key:"fork",value:function(r){return this._request("POST","/gists/"+this.__id+"/forks",null,r)}},{key:"update",value:function(r,s){return this._request("PATCH","/gists/"+this.__id,r,s)}},{key:"star",value:function(r){return this._request("PUT","/gists/"+this.__id+"/star",null,r)}},{key:"unstar",value:function(r){return this._request("DELETE","/gists/"+this.__id+"/star",null,r)}},{key:"isStarred",value:function(r){return this._request204or404("/gists/"+this.__id+"/star",null,r)}},{key:"listCommits",value:function(r){return this._requestAllPages("/gists/"+this.__id+"/commits",null,r)}},{key:"getRevision",value:function(r,s){return this._request("GET","/gists/"+this.__id+"/"+r,null,s)}},{key:"listComments",value:function(r){return this._requestAllPages("/gists/"+this.__id+"/comments",null,r)}},{key:"getComment",value:function(r,s){return this._request("GET","/gists/"+this.__id+"/comments/"+r,null,s)}},{key:"createComment",value:function(r,s){return this._request("POST","/gists/"+this.__id+"/comments",{body:r},s)}},{key:"editComment",value:function(r,s,i){return this._request("PATCH","/gists/"+this.__id+"/comments/"+r,{body:s},i)}},{key:"deleteComment",value:function(r,s){return this._request("DELETE","/gists/"+this.__id+"/comments/"+r,null,s)}}]),e}(k0.default),M0=P0,F0=function(){function t(e,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),L0=Jt,q0=Xp(L0),$0=rr.exports,U0=Xp($0);function Xp(t){return t&&t.__esModule?t:{default:t}}function B0(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function j0(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function V0(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}/**
* @file
* @copyright  2013 Michael Aufreiter (Development Seed) and 2016 Yahoo Inc.
* @license    Licensed under {@link https://spdx.org/licenses/BSD-3-Clause-Clear.html BSD-3-Clause-Clear}.
*             Github.js is freely distributable.
*/var K0=(0,U0.default)("github:user"),G0=function(t){V0(e,t);function e(n,r,s){B0(this,e);var i=j0(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r,s));return i.__user=n,i}return F0(e,[{key:"__getScopedUrl",value:function(r){if(this.__user)return r?"/users/"+this.__user+"/"+r:"/users/"+this.__user;switch(r){case"":return"/user";case"notifications":case"gists":return"/"+r;default:return"/user/"+r}}},{key:"listRepos",value:function(r,s){return typeof r=="function"&&(s=r,r={}),r=this._getOptionsWithDefaults(r),K0("Fetching repositories with options: "+JSON.stringify(r)),this._requestAllPages(this.__getScopedUrl("repos"),r,s)}},{key:"listOrgs",value:function(r){return this._request("GET",this.__getScopedUrl("orgs"),null,r)}},{key:"listFollowers",value:function(r){return this._request("GET",this.__getScopedUrl("followers"),null,r)}},{key:"listFollowing",value:function(r){return this._request("GET",this.__getScopedUrl("following"),null,r)}},{key:"listGists",value:function(r){return this._request("GET",this.__getScopedUrl("gists"),null,r)}},{key:"listNotifications",value:function(r,s){return r=r||{},typeof r=="function"&&(s=r,r={}),r.since=this._dateToISO(r.since),r.before=this._dateToISO(r.before),this._request("GET",this.__getScopedUrl("notifications"),r,s)}},{key:"getProfile",value:function(r){return this._request("GET",this.__getScopedUrl(""),null,r)}},{key:"listStarredRepos",value:function(r){var s=this._getOptionsWithDefaults();return this._requestAllPages(this.__getScopedUrl("starred"),s,r)}},{key:"listStarredGists",value:function(r,s){return r=r||{},typeof r=="function"&&(s=r,r={}),r.since=this._dateToISO(r.since),this._request("GET","/gists/starred",r,s)}},{key:"getEmails",value:function(r){return this._request("GET","/user/emails",null,r)}},{key:"follow",value:function(r,s){return this._request("PUT","/user/following/"+r,null,s)}},{key:"unfollow",value:function(r,s){return this._request("DELETE","/user/following/"+r,null,s)}},{key:"createRepo",value:function(r,s){return this._request("POST","/user/repos",r,s)}}]),e}(q0.default),H0=G0,z0=function(){function t(e,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),W0=Jt,Q0=Y0(W0);function Y0(t){return t&&t.__esModule?t:{default:t}}function J0(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function X0(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function Z0(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}/**
* @file
* @copyright  2013 Michael Aufreiter (Development Seed) and 2016 Yahoo Inc.
* @license    Licensed under {@link https://spdx.org/licenses/BSD-3-Clause-Clear.html BSD-3-Clause-Clear}.
*             Github.js is freely distributable.
*/var eE=function(t){Z0(e,t);function e(n,r,s){J0(this,e);var i=X0(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r,s));return i.__repository=n,i}return z0(e,[{key:"createIssue",value:function(r,s){return this._request("POST","/repos/"+this.__repository+"/issues",r,s)}},{key:"listIssues",value:function(r,s){return this._requestAllPages("/repos/"+this.__repository+"/issues",r,s)}},{key:"listIssueEvents",value:function(r,s){return this._request("GET","/repos/"+this.__repository+"/issues/"+r+"/events",null,s)}},{key:"listIssueComments",value:function(r,s){return this._request("GET","/repos/"+this.__repository+"/issues/"+r+"/comments",null,s)}},{key:"getIssueComment",value:function(r,s){return this._request("GET","/repos/"+this.__repository+"/issues/comments/"+r,null,s)}},{key:"createIssueComment",value:function(r,s,i){return this._request("POST","/repos/"+this.__repository+"/issues/"+r+"/comments",{body:s},i)}},{key:"editIssueComment",value:function(r,s,i){return this._request("PATCH","/repos/"+this.__repository+"/issues/comments/"+r,{body:s},i)}},{key:"deleteIssueComment",value:function(r,s){return this._request("DELETE","/repos/"+this.__repository+"/issues/comments/"+r,null,s)}},{key:"editIssue",value:function(r,s,i){return this._request("PATCH","/repos/"+this.__repository+"/issues/"+r,s,i)}},{key:"getIssue",value:function(r,s){return this._request("GET","/repos/"+this.__repository+"/issues/"+r,null,s)}},{key:"listMilestones",value:function(r,s){return this._request("GET","/repos/"+this.__repository+"/milestones",r,s)}},{key:"getMilestone",value:function(r,s){return this._request("GET","/repos/"+this.__repository+"/milestones/"+r,null,s)}},{key:"createMilestone",value:function(r,s){return this._request("POST","/repos/"+this.__repository+"/milestones",r,s)}},{key:"editMilestone",value:function(r,s,i){return this._request("PATCH","/repos/"+this.__repository+"/milestones/"+r,s,i)}},{key:"deleteMilestone",value:function(r,s){return this._request("DELETE","/repos/"+this.__repository+"/milestones/"+r,null,s)}},{key:"createLabel",value:function(r,s){return this._request("POST","/repos/"+this.__repository+"/labels",r,s)}},{key:"listLabels",value:function(r,s){return this._request("GET","/repos/"+this.__repository+"/labels",r,s)}},{key:"getLabel",value:function(r,s){return this._request("GET","/repos/"+this.__repository+"/labels/"+r,null,s)}},{key:"editLabel",value:function(r,s,i){return this._request("PATCH","/repos/"+this.__repository+"/labels/"+r,s,i)}},{key:"deleteLabel",value:function(r,s){return this._request("DELETE","/repos/"+this.__repository+"/labels/"+r,null,s)}}]),e}(Q0.default),tE=eE,nE=function(){function t(e,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),rE=Jt,sE=Zp(rE),iE=rr.exports,oE=Zp(iE);function Zp(t){return t&&t.__esModule?t:{default:t}}function aE(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function uE(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function cE(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}/**
* @file
* @copyright  2013 Michael Aufreiter (Development Seed) and 2016 Yahoo Inc.
* @license    Licensed under {@link https://spdx.org/licenses/BSD-3-Clause-Clear.html BSD-3-Clause-Clear}.
*             Github.js is freely distributable.
*/var lE=(0,oE.default)("github:search"),hE=function(t){cE(e,t);function e(n,r,s){aE(this,e);var i=uE(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r,s));return i.__defaults=i._getOptionsWithDefaults(n),i}return nE(e,[{key:"_search",value:function(r){var s=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,a={};return Object.keys(this.__defaults).forEach(function(u){a[u]=s.__defaults[u]}),Object.keys(i).forEach(function(u){a[u]=i[u]}),lE("searching "+r+" with options:",a),this._requestAllPages("/search/"+r,a,o)}},{key:"forRepositories",value:function(r,s){return this._search("repositories",r,s)}},{key:"forCode",value:function(r,s){return this._search("code",r,s)}},{key:"forIssues",value:function(r,s){return this._search("issues",r,s)}},{key:"forUsers",value:function(r,s){return this._search("users",r,s)}}]),e}(sE.default),fE=hE,dE=function(){function t(e,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),pE=Jt,mE=gE(pE);function gE(t){return t&&t.__esModule?t:{default:t}}function yE(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vE(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function wE(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}/**
* @file
* @copyright  2013 Michael Aufreiter (Development Seed) and 2016 Yahoo Inc.
* @license    Licensed under {@link https://spdx.org/licenses/BSD-3-Clause-Clear.html BSD-3-Clause-Clear}.
*             Github.js is freely distributable.
*/var _E=function(t){wE(e,t);function e(n,r){return yE(this,e),vE(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,n,r))}return dE(e,[{key:"getRateLimit",value:function(r){return this._request("GET","/rate_limit",null,r)}}]),e}(mE.default),bE=_E,Ku={exports:{}};/*! https://mths.be/utf8js v2.1.2 by @mathias */(function(t,e){(function(n){var r=e,s=t&&t.exports==r&&t,i=typeof Qr=="object"&&Qr;(i.global===i||i.window===i)&&(n=i);var o=String.fromCharCode;function a(q){for(var W=[],le=0,de=q.length,J,dt;le<de;)J=q.charCodeAt(le++),J>=55296&&J<=56319&&le<de?(dt=q.charCodeAt(le++),(dt&64512)==56320?W.push(((J&1023)<<10)+(dt&1023)+65536):(W.push(J),le--)):W.push(J);return W}function u(q){for(var W=q.length,le=-1,de,J="";++le<W;)de=q[le],de>65535&&(de-=65536,J+=o(de>>>10&1023|55296),de=56320|de&1023),J+=o(de);return J}function c(q){if(q>=55296&&q<=57343)throw Error("Lone surrogate U+"+q.toString(16).toUpperCase()+" is not a scalar value")}function l(q,W){return o(q>>W&63|128)}function h(q){if((q&4294967168)==0)return o(q);var W="";return(q&4294965248)==0?W=o(q>>6&31|192):(q&4294901760)==0?(c(q),W=o(q>>12&15|224),W+=l(q,6)):(q&4292870144)==0&&(W=o(q>>18&7|240),W+=l(q,12),W+=l(q,6)),W+=o(q&63|128),W}function f(q){for(var W=a(q),le=W.length,de=-1,J,dt="";++de<le;)J=W[de],dt+=h(J);return dt}function p(){if(M>=x)throw Error("Invalid byte index");var q=T[M]&255;if(M++,(q&192)==128)return q&63;throw Error("Invalid continuation byte")}function g(){var q,W,le,de,J;if(M>x)throw Error("Invalid byte index");if(M==x)return!1;if(q=T[M]&255,M++,(q&128)==0)return q;if((q&224)==192){if(W=p(),J=(q&31)<<6|W,J>=128)return J;throw Error("Invalid continuation byte")}if((q&240)==224){if(W=p(),le=p(),J=(q&15)<<12|W<<6|le,J>=2048)return c(J),J;throw Error("Invalid continuation byte")}if((q&248)==240&&(W=p(),le=p(),de=p(),J=(q&7)<<18|W<<12|le<<6|de,J>=65536&&J<=1114111))return J;throw Error("Invalid UTF-8 detected")}var T,x,M;function ie(q){T=a(q),x=T.length,M=0;for(var W=[],le;(le=g())!==!1;)W.push(le);return u(W)}var ue={version:"2.1.2",encode:f,decode:ie};if(r&&!r.nodeType)if(s)s.exports=ue;else{var ce={},st=ce.hasOwnProperty;for(var xt in ue)st.call(ue,xt)&&(r[xt]=ue[xt])}else n.utf8=ue})(Qr)})(Ku,Ku.exports);var EE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},TE=function(){function t(e,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),IE=Jt,SE=Yc(IE),xE=Ku.exports,AE=Yc(xE),yf=Qc.exports,CE=rr.exports,kE=Yc(CE);function Yc(t){return t&&t.__esModule?t:{default:t}}function OE(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function DE(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function NE(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}/**
* @file
* @copyright  2013 Michael Aufreiter (Development Seed) and 2016 Yahoo Inc.
* @license    Licensed under {@link https://spdx.org/licenses/BSD-3-Clause-Clear.html BSD-3-Clause-Clear}.
*             Github.js is freely distributable.
*/var Ps=(0,kE.default)("github:repository"),RE=function(t){NE(e,t);function e(n,r,s){OE(this,e);var i=DE(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r,s));return i.__fullname=n,i.__currentTree={branch:null,sha:null},i}return TE(e,[{key:"getRef",value:function(r,s){return this._request("GET","/repos/"+this.__fullname+"/git/refs/"+r,null,s)}},{key:"createRef",value:function(r,s){return this._request("POST","/repos/"+this.__fullname+"/git/refs",r,s)}},{key:"deleteRef",value:function(r,s){return this._request("DELETE","/repos/"+this.__fullname+"/git/refs/"+r,null,s)}},{key:"deleteRepo",value:function(r){return this._request("DELETE","/repos/"+this.__fullname,null,r)}},{key:"listTags",value:function(r){return this._request("GET","/repos/"+this.__fullname+"/tags",null,r)}},{key:"listPullRequests",value:function(r,s){return r=r||{},this._request("GET","/repos/"+this.__fullname+"/pulls",r,s)}},{key:"getPullRequest",value:function(r,s){return this._request("GET","/repos/"+this.__fullname+"/pulls/"+r,null,s)}},{key:"listPullRequestFiles",value:function(r,s){return this._request("GET","/repos/"+this.__fullname+"/pulls/"+r+"/files",null,s)}},{key:"compareBranches",value:function(r,s,i){return this._request("GET","/repos/"+this.__fullname+"/compare/"+r+"..."+s,null,i)}},{key:"listBranches",value:function(r){return this._request("GET","/repos/"+this.__fullname+"/branches",null,r)}},{key:"getBlob",value:function(r,s){return this._request("GET","/repos/"+this.__fullname+"/git/blobs/"+r,null,s,"raw")}},{key:"getBranch",value:function(r,s){return this._request("GET","/repos/"+this.__fullname+"/branches/"+r,null,s)}},{key:"getCommit",value:function(r,s){return this._request("GET","/repos/"+this.__fullname+"/git/commits/"+r,null,s)}},{key:"listCommits",value:function(r,s){return r=r||{},typeof r=="function"&&(s=r,r={}),r.since=this._dateToISO(r.since),r.until=this._dateToISO(r.until),this._request("GET","/repos/"+this.__fullname+"/commits",r,s)}},{key:"listCommitsOnPR",value:function(r,s,i){return s=s||{},typeof s=="function"&&(i=s,s={}),this._request("GET","/repos/"+this.__fullname+"/pulls/"+r+"/commits",s,i)}},{key:"getSingleCommit",value:function(r,s){return r=r||"",this._request("GET","/repos/"+this.__fullname+"/commits/"+r,null,s)}},{key:"getSha",value:function(r,s,i){return r=r?"?ref="+r:"",this._request("GET","/repos/"+this.__fullname+"/contents/"+s+r,null,i)}},{key:"listStatuses",value:function(r,s){return this._request("GET","/repos/"+this.__fullname+"/commits/"+r+"/statuses",null,s)}},{key:"getCombinedStatus",value:function(r,s){return this._request("GET","/repos/"+this.__fullname+"/commits/"+r+"/status",null,s)}},{key:"getTree",value:function(r,s){return this._request("GET","/repos/"+this.__fullname+"/git/trees/"+r,null,s)}},{key:"createBlob",value:function(r,s){var i=this._getContentObject(r);return Ps("sending content",i),this._request("POST","/repos/"+this.__fullname+"/git/blobs",i,s)}},{key:"_getContentObject",value:function(r){if(typeof r=="string")return Ps("contet is a string"),{content:AE.default.encode(r),encoding:"utf-8"};if(typeof Buffer!="undefined"&&r instanceof Buffer)return Ps("We appear to be in Node"),{content:r.toString("base64"),encoding:"base64"};if(typeof Blob!="undefined"&&r instanceof Blob)return Ps("We appear to be in the browser"),{content:yf.Base64.encode(r),encoding:"base64"};throw Ps("Not sure what this content is: "+(typeof r=="undefined"?"undefined":EE(r))+", "+JSON.stringify(r)),new Error("Unknown content passed to postBlob. Must be string or Buffer (node) or Blob (web)")}},{key:"updateTree",value:function(r,s,i,o){var a={base_tree:r,tree:[{path:s,sha:i,mode:"100644",type:"blob"}]};return this._request("POST","/repos/"+this.__fullname+"/git/trees",a,o)}},{key:"createTree",value:function(r,s,i){return this._request("POST","/repos/"+this.__fullname+"/git/trees",{tree:r,base_tree:s},i)}},{key:"commit",value:function(r,s,i,o,a){var u=this;typeof o=="function"&&(a=o,o={});var c={message:i,tree:s,parents:[r]};return c=Object.assign({},o,c),this._request("POST","/repos/"+this.__fullname+"/git/commits",c,a).then(function(l){return u.__currentTree.sha=l.data.sha,l})}},{key:"updateHead",value:function(r,s,i,o){return this._request("PATCH","/repos/"+this.__fullname+"/git/refs/"+r,{sha:s,force:i},o)}},{key:"updateStatus",value:function(r,s,i){return this._request("POST","/repos/"+this.__fullname+"/statuses/"+r,s,i)}},{key:"updateRepository",value:function(r,s){return this._request("PATCH","/repos/"+this.__fullname,r,s)}},{key:"getDetails",value:function(r){return this._request("GET","/repos/"+this.__fullname,null,r)}},{key:"getContributors",value:function(r){return this._request("GET","/repos/"+this.__fullname+"/contributors",null,r)}},{key:"getContributorStats",value:function(r){return this._request("GET","/repos/"+this.__fullname+"/stats/contributors",null,r)}},{key:"getCollaborators",value:function(r){return this._request("GET","/repos/"+this.__fullname+"/collaborators",null,r)}},{key:"isCollaborator",value:function(r,s){return this._request("GET","/repos/"+this.__fullname+"/collaborators/"+r,null,s)}},{key:"getContents",value:function(r,s,i,o){return s=s?""+encodeURI(s):"",this._request("GET","/repos/"+this.__fullname+"/contents/"+s,{ref:r},o,i)}},{key:"getReadme",value:function(r,s,i){return this._request("GET","/repos/"+this.__fullname+"/readme",{ref:r},i,s)}},{key:"fork",value:function(r){return this._request("POST","/repos/"+this.__fullname+"/forks",null,r)}},{key:"forkToOrg",value:function(r,s){return this._request("POST","/repos/"+this.__fullname+"/forks?organization="+r,null,s)}},{key:"listForks",value:function(r){return this._request("GET","/repos/"+this.__fullname+"/forks",null,r)}},{key:"createBranch",value:function(r,s,i){var o=this;return typeof s=="function"&&(i=s,s=r,r="master"),this.getRef("heads/"+r).then(function(a){var u=a.data.object.sha;return o.createRef({sha:u,ref:"refs/heads/"+s},i)})}},{key:"createPullRequest",value:function(r,s){return this._request("POST","/repos/"+this.__fullname+"/pulls",r,s)}},{key:"updatePullRequest",value:function(r,s,i){return this._request("PATCH","/repos/"+this.__fullname+"/pulls/"+r,s,i)}},{key:"listHooks",value:function(r){return this._request("GET","/repos/"+this.__fullname+"/hooks",null,r)}},{key:"getHook",value:function(r,s){return this._request("GET","/repos/"+this.__fullname+"/hooks/"+r,null,s)}},{key:"createHook",value:function(r,s){return this._request("POST","/repos/"+this.__fullname+"/hooks",r,s)}},{key:"updateHook",value:function(r,s,i){return this._request("PATCH","/repos/"+this.__fullname+"/hooks/"+r,s,i)}},{key:"deleteHook",value:function(r,s){return this._request("DELETE","/repos/"+this.__fullname+"/hooks/"+r,null,s)}},{key:"listKeys",value:function(r){return this._request("GET","/repos/"+this.__fullname+"/keys",null,r)}},{key:"getKey",value:function(r,s){return this._request("GET","/repos/"+this.__fullname+"/keys/"+r,null,s)}},{key:"createKey",value:function(r,s){return this._request("POST","/repos/"+this.__fullname+"/keys",r,s)}},{key:"deleteKey",value:function(r,s){return this._request("DELETE","/repos/"+this.__fullname+"/keys/"+r,null,s)}},{key:"deleteFile",value:function(r,s,i){var o=this;return this.getSha(r,s).then(function(a){var u={message:"Delete the file at '"+s+"'",sha:a.data.sha,branch:r};return o._request("DELETE","/repos/"+o.__fullname+"/contents/"+s,u,i)})}},{key:"move",value:function(r,s,i,o){var a=this,u=void 0;return this.getRef("heads/"+r).then(function(c){var l=c.data.object;return a.getTree(l.sha+"?recursive=true")}).then(function(c){var l=c.data,h=l.tree,f=l.sha;u=f;var p=h.map(function(g){return g.path===s&&(g.path=i),g.type==="tree"&&delete g.sha,g});return a.createTree(p)}).then(function(c){var l=c.data;return a.commit(u,l.sha,"Renamed '"+s+"' to '"+i+"'")}).then(function(c){var l=c.data;return a.updateHead("heads/"+r,l.sha,!0,o)})}},{key:"writeFile",value:function(r,s,i,o,a,u){var c=this;a=a||{},typeof a=="function"&&(u=a,a={});var l=s?encodeURI(s):"",h=a.encode!==!1,f={branch:r,message:o,author:a.author,committer:a.committer,content:h?yf.Base64.encode(i):i};return this.getSha(r,l).then(function(p){return f.sha=p.data.sha,c._request("PUT","/repos/"+c.__fullname+"/contents/"+l,f,u)},function(){return c._request("PUT","/repos/"+c.__fullname+"/contents/"+l,f,u)})}},{key:"isStarred",value:function(r){return this._request204or404("/user/starred/"+this.__fullname,null,r)}},{key:"star",value:function(r){return this._request("PUT","/user/starred/"+this.__fullname,null,r)}},{key:"unstar",value:function(r){return this._request("DELETE","/user/starred/"+this.__fullname,null,r)}},{key:"createRelease",value:function(r,s){return this._request("POST","/repos/"+this.__fullname+"/releases",r,s)}},{key:"updateRelease",value:function(r,s,i){return this._request("PATCH","/repos/"+this.__fullname+"/releases/"+r,s,i)}},{key:"listReleases",value:function(r){return this._request("GET","/repos/"+this.__fullname+"/releases",null,r)}},{key:"getRelease",value:function(r,s){return this._request("GET","/repos/"+this.__fullname+"/releases/"+r,null,s)}},{key:"deleteRelease",value:function(r,s){return this._request("DELETE","/repos/"+this.__fullname+"/releases/"+r,null,s)}},{key:"mergePullRequest",value:function(r,s,i){return this._request("PUT","/repos/"+this.__fullname+"/pulls/"+r+"/merge",s,i)}},{key:"listProjects",value:function(r){return this._requestAllPages("/repos/"+this.__fullname+"/projects",{AcceptHeader:"inertia-preview"},r)}},{key:"createProject",value:function(r,s){return r=r||{},r.AcceptHeader="inertia-preview",this._request("POST","/repos/"+this.__fullname+"/projects",r,s)}}]),e}(SE.default),PE=RE,ME=function(){function t(e,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),FE=Jt,LE=qE(FE);function qE(t){return t&&t.__esModule?t:{default:t}}function $E(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function UE(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function BE(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}/**
* @file
* @copyright  2013 Michael Aufreiter (Development Seed) and 2016 Yahoo Inc.
* @license    Licensed under {@link https://spdx.org/licenses/BSD-3-Clause-Clear.html BSD-3-Clause-Clear}.
*             Github.js is freely distributable.
*/var jE=function(t){BE(e,t);function e(n,r,s){$E(this,e);var i=UE(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r,s));return i.__name=n,i}return ME(e,[{key:"createRepo",value:function(r,s){return this._request("POST","/orgs/"+this.__name+"/repos",r,s)}},{key:"getRepos",value:function(r){var s=this._getOptionsWithDefaults({direction:"desc"});return this._requestAllPages("/orgs/"+this.__name+"/repos",s,r)}},{key:"isMember",value:function(r,s){return this._request204or404("/orgs/"+this.__name+"/members/"+r,null,s)}},{key:"listMembers",value:function(r,s){return this._request("GET","/orgs/"+this.__name+"/members",r,s)}},{key:"getTeams",value:function(r){return this._requestAllPages("/orgs/"+this.__name+"/teams",void 0,r)}},{key:"createTeam",value:function(r,s){return this._request("POST","/orgs/"+this.__name+"/teams",r,s)}},{key:"listProjects",value:function(r){return this._requestAllPages("/orgs/"+this.__name+"/projects",{AcceptHeader:"inertia-preview"},r)}},{key:"createProject",value:function(r,s){return r=r||{},r.AcceptHeader="inertia-preview",this._request("POST","/orgs/"+this.__name+"/projects",r,s)}}]),e}(LE.default),VE=jE,KE=function(){function t(e,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),GE=Jt,HE=em(GE),zE=rr.exports,WE=em(zE);function em(t){return t&&t.__esModule?t:{default:t}}function QE(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function YE(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function JE(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}/**
* @file
* @copyright  2016 Matt Smith (Development Seed)
* @license    Licensed under {@link https://spdx.org/licenses/BSD-3-Clause-Clear.html BSD-3-Clause-Clear}.
*             Github.js is freely distributable.
*/var jt=(0,WE.default)("github:team"),XE=function(t){JE(e,t);function e(n,r,s){QE(this,e);var i=YE(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r,s));return i.__teamId=n,i}return KE(e,[{key:"getTeam",value:function(r){return jt("Fetching Team "+this.__teamId),this._request("Get","/teams/"+this.__teamId,void 0,r)}},{key:"listRepos",value:function(r){return jt("Fetching repositories for Team "+this.__teamId),this._requestAllPages("/teams/"+this.__teamId+"/repos",void 0,r)}},{key:"editTeam",value:function(r,s){return jt("Editing Team "+this.__teamId),this._request("PATCH","/teams/"+this.__teamId,r,s)}},{key:"listMembers",value:function(r,s){return jt("Getting members of Team "+this.__teamId),this._requestAllPages("/teams/"+this.__teamId+"/members",r,s)}},{key:"getMembership",value:function(r,s){return jt("Getting membership of user "+r+" in Team "+this.__teamId),this._request("GET","/teams/"+this.__teamId+"/memberships/"+r,void 0,s)}},{key:"addMembership",value:function(r,s,i){return jt("Adding user "+r+" to Team "+this.__teamId),this._request("PUT","/teams/"+this.__teamId+"/memberships/"+r,s,i)}},{key:"isManagedRepo",value:function(r,s,i){return jt("Getting repo management by Team "+this.__teamId+" for repo "+r+"/"+s),this._request204or404("/teams/"+this.__teamId+"/repos/"+r+"/"+s,void 0,i)}},{key:"manageRepo",value:function(r,s,i,o){return jt("Adding or Updating repo management by Team "+this.__teamId+" for repo "+r+"/"+s),this._request204or404("/teams/"+this.__teamId+"/repos/"+r+"/"+s,i,o,"PUT")}},{key:"unmanageRepo",value:function(r,s,i){return jt("Remove repo management by Team "+this.__teamId+" for repo "+r+"/"+s),this._request204or404("/teams/"+this.__teamId+"/repos/"+r+"/"+s,void 0,i,"DELETE")}},{key:"deleteTeam",value:function(r){return jt("Deleting Team "+this.__teamId),this._request204or404("/teams/"+this.__teamId,void 0,r,"DELETE")}}]),e}(HE.default),ZE=XE,eT=function(){function t(e,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),tT=Jt,nT=rT(tT);function rT(t){return t&&t.__esModule?t:{default:t}}function sT(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function iT(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function oT(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}/**
* @file
* @copyright  2013 Michael Aufreiter (Development Seed) and 2016 Yahoo Inc.
* @license    Licensed under {@link https://spdx.org/licenses/BSD-3-Clause-Clear.html BSD-3-Clause-Clear}.
*             Github.js is freely distributable.
*/var aT=function(t){oT(e,t);function e(n,r){return sT(this,e),iT(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,n,r))}return eT(e,[{key:"render",value:function(r,s){return this._request("POST","/markdown",r,s,!0)}}]),e}(nT.default),uT=aT,cT=function(){function t(e,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),lT=Jt,hT=fT(lT);function fT(t){return t&&t.__esModule?t:{default:t}}function dT(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}else return Array.from(t)}function pT(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mT(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function gT(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}/**
 * @file
 * @copyright  2013 Michael Aufreiter (Development Seed) and 2016 Yahoo Inc.
 * @license    Licensed under {@link https://spdx.org/licenses/BSD-3-Clause-Clear.html BSD-3-Clause-Clear}.
 *             Github.js is freely distributable.
 */var yT=function(t){gT(e,t);function e(n,r,s){pT(this,e);var i=mT(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r,s,"inertia-preview"));return i.__id=n,i}return cT(e,[{key:"getProject",value:function(r){return this._request("GET","/projects/"+this.__id,null,r)}},{key:"updateProject",value:function(r,s){return this._request("PATCH","/projects/"+this.__id,r,s)}},{key:"deleteProject",value:function(r){return this._request("DELETE","/projects/"+this.__id,null,r)}},{key:"listProjectColumns",value:function(r){return this._requestAllPages("/projects/"+this.__id+"/columns",null,r)}},{key:"getProjectColumn",value:function(r,s){return this._request("GET","/projects/columns/"+r,null,s)}},{key:"createProjectColumn",value:function(r,s){return this._request("POST","/projects/"+this.__id+"/columns",r,s)}},{key:"updateProjectColumn",value:function(r,s,i){return this._request("PATCH","/projects/columns/"+r,s,i)}},{key:"deleteProjectColumn",value:function(r,s){return this._request("DELETE","/projects/columns/"+r,null,s)}},{key:"moveProjectColumn",value:function(r,s,i){return this._request("POST","/projects/columns/"+r+"/moves",{position:s},i)}},{key:"listProjectCards",value:function(r){var s=this;return this.listProjectColumns().then(function(i){var o=i.data;return Promise.all(o.map(function(a){return s._requestAllPages("/projects/columns/"+a.id+"/cards",null)}))}).then(function(i){var o=i.reduce(function(a,u){var c=u.data;return a.push.apply(a,dT(c)),a},[]);return r&&r(null,o),o}).catch(function(i){if(r){r(i);return}throw i})}},{key:"listColumnCards",value:function(r,s){return this._requestAllPages("/projects/columns/"+r+"/cards",null,s)}},{key:"getProjectCard",value:function(r,s){return this._request("GET","/projects/columns/cards/"+r,null,s)}},{key:"createProjectCard",value:function(r,s,i){return this._request("POST","/projects/columns/"+r+"/cards",s,i)}},{key:"updateProjectCard",value:function(r,s,i){return this._request("PATCH","/projects/columns/cards/"+r,s,i)}},{key:"deleteProjectCard",value:function(r,s){return this._request("DELETE","/projects/columns/cards/"+r,null,s)}},{key:"moveProjectCard",value:function(r,s,i,o){return this._request("POST","/projects/columns/cards/"+r+"/moves",{position:s,column_id:i},o)}}]),e}(hT.default),vT=yT,wT=function(){function t(e,n){for(var r=0;r<n.length;r++){var s=n[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();/**
 * @file
 * @copyright  2013 Michael Aufreiter (Development Seed) and 2016 Yahoo Inc.
 * @license    Licensed under {@link https://spdx.org/licenses/BSD-3-Clause-Clear.html BSD-3-Clause-Clear}.
 *             Github.js is freely distributable.
 */var _T=M0,bT=Xt(_T),ET=H0,TT=Xt(ET),IT=tE,ST=Xt(IT),xT=fE,AT=Xt(xT),CT=bE,kT=Xt(CT),OT=PE,DT=Xt(OT),NT=VE,RT=Xt(NT),PT=ZE,MT=Xt(PT),FT=uT,LT=Xt(FT),qT=vT,$T=Xt(qT);function Xt(t){return t&&t.__esModule?t:{default:t}}function UT(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var BT=function(){function t(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"https://api.github.com";UT(this,t),this.__apiBase=n,this.__auth=e||{}}return wT(t,[{key:"getGist",value:function(n){return new bT.default(n,this.__auth,this.__apiBase)}},{key:"getUser",value:function(n){return new TT.default(n,this.__auth,this.__apiBase)}},{key:"getOrganization",value:function(n){return new RT.default(n,this.__auth,this.__apiBase)}},{key:"getTeam",value:function(n){return new MT.default(n,this.__auth,this.__apiBase)}},{key:"getRepo",value:function(n,r){return new DT.default(this._getFullName(n,r),this.__auth,this.__apiBase)}},{key:"getIssues",value:function(n,r){return new ST.default(this._getFullName(n,r),this.__auth,this.__apiBase)}},{key:"search",value:function(n){return new AT.default(n,this.__auth,this.__apiBase)}},{key:"getRateLimit",value:function(){return new kT.default(this.__auth,this.__apiBase)}},{key:"getMarkdown",value:function(){return new LT.default(this.__auth,this.__apiBase)}},{key:"getProject",value:function(n){return new $T.default(n,this.__auth,this.__apiBase)}},{key:"_getFullName",value:function(n,r){var s=n;return r&&(s=n+"/"+r),s}}]),t}(),C1=BT;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tm=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},jT=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},VT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,u=s+2<t.length,c=u?t[s+2]:0,l=i>>2,h=(i&3)<<4|a>>4;let f=(a&15)<<2|c>>6,p=c&63;u||(p=64,o||(f=64)),r.push(n[l],n[h],n[f],n[p])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(tm(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):jT(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const c=s<t.length?n[t.charAt(s)]:64;++s;const h=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||c==null||h==null)throw Error();const f=i<<2|a>>4;if(r.push(f),c!==64){const p=a<<4&240|c>>2;if(r.push(p),h!==64){const g=c<<6&192|h;r.push(g)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},Jc=function(t){const e=tm(t);return VT.encodeByteArray(e,!0)},vf=function(t){return Jc(t).replace(/\./g,"")};function qo(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!KT(n)||(t[n]=qo(t[n],e[n]));return t}function KT(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GT{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HT(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t),a="";return[vf(JSON.stringify(n)),vf(JSON.stringify(o)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sr(){return typeof navigator!="undefined"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function zT(){return typeof window!="undefined"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(sr())}function WT(){try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function QT(){return typeof self=="object"&&self.self===self}function YT(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function JT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function XT(){return sr().indexOf("Electron/")>=0}function ZT(){const t=sr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function eI(){return sr().indexOf("MSAppHost/")>=0}function tI(){return!WT()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function nm(){return typeof indexedDB=="object"}function nI(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rI="FirebaseError";class Ci extends Error{constructor(e,n,r){super(n);this.code=e,this.customData=r,this.name=rI,Object.setPrototypeOf(this,Ci.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ya.prototype.create)}}class ya{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?sI(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Ci(s,a,r)}}function sI(t,e){return t.replace(iI,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const iI=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wf(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Gu(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(_f(i)&&_f(o)){if(!Gu(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function _f(t){return t!==null&&typeof t=="object"}function oI(t,e){const n=new aI(t,e);return n.subscribe.bind(n)}class aI{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");uI(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=cu),s.error===void 0&&(s.error=cu),s.complete===void 0&&(s.complete=cu);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console!="undefined"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function uI(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function cu(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ke(t){return t&&t._delegate?t._delegate:t}class ir{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kn="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cI{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new GT;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(hI(e))try{this.getOrInitializeService({instanceIdentifier:Kn})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Kn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Kn){return this.instances.has(e)}getOptions(e=Kn){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(!!r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:lI(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Kn){return this.component?this.component.multipleInstances?e:Kn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function lI(t){return t===Kn?void 0:t}function hI(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new cI(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xc=[];var re;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(re||(re={}));const rm={debug:re.DEBUG,verbose:re.VERBOSE,info:re.INFO,warn:re.WARN,error:re.ERROR,silent:re.SILENT},dI=re.INFO,pI={[re.DEBUG]:"log",[re.VERBOSE]:"log",[re.INFO]:"info",[re.WARN]:"warn",[re.ERROR]:"error"},mI=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=pI[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Zc{constructor(e){this.name=e,this._logLevel=dI,this._logHandler=mI,this._userLogHandler=null,Xc.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in re))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?rm[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,re.DEBUG,...e),this._logHandler(this,re.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,re.VERBOSE,...e),this._logHandler(this,re.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,re.INFO,...e),this._logHandler(this,re.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,re.WARN,...e),this._logHandler(this,re.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,re.ERROR,...e),this._logHandler(this,re.ERROR,...e)}}function gI(t){Xc.forEach(e=>{e.setLogLevel(t)})}function yI(t,e){for(const n of Xc){let r=null;e&&e.level&&(r=rm[e.level]),t===null?n.userLogHandler=null:n.userLogHandler=(s,i,...o)=>{const a=o.map(u=>{if(u==null)return null;if(typeof u=="string")return u;if(typeof u=="number"||typeof u=="boolean")return u.toString();if(u instanceof Error)return u.message;try{return JSON.stringify(u)}catch{return null}}).filter(u=>u).join(" ");i>=(r!=null?r:s.logLevel)&&t({level:re[i].toLowerCase(),message:a,args:o,type:s.name})}}}function vI(t){return Array.prototype.slice.call(t)}function sm(t){return new Promise(function(e,n){t.onsuccess=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function el(t,e,n){var r,s=new Promise(function(i,o){r=t[e].apply(t,n),sm(r).then(i,o)});return s.request=r,s}function wI(t,e,n){var r=el(t,e,n);return r.then(function(s){if(!!s)return new oi(s,r.request)})}function bs(t,e,n){n.forEach(function(r){Object.defineProperty(t.prototype,r,{get:function(){return this[e][r]},set:function(s){this[e][r]=s}})})}function tl(t,e,n,r){r.forEach(function(s){s in n.prototype&&(t.prototype[s]=function(){return el(this[e],s,arguments)})})}function va(t,e,n,r){r.forEach(function(s){s in n.prototype&&(t.prototype[s]=function(){return this[e][s].apply(this[e],arguments)})})}function im(t,e,n,r){r.forEach(function(s){s in n.prototype&&(t.prototype[s]=function(){return wI(this[e],s,arguments)})})}function _r(t){this._index=t}bs(_r,"_index",["name","keyPath","multiEntry","unique"]);tl(_r,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]);im(_r,"_index",IDBIndex,["openCursor","openKeyCursor"]);function oi(t,e){this._cursor=t,this._request=e}bs(oi,"_cursor",["direction","key","primaryKey","value"]);tl(oi,"_cursor",IDBCursor,["update","delete"]);["advance","continue","continuePrimaryKey"].forEach(function(t){t in IDBCursor.prototype&&(oi.prototype[t]=function(){var e=this,n=arguments;return Promise.resolve().then(function(){return e._cursor[t].apply(e._cursor,n),sm(e._request).then(function(r){if(!!r)return new oi(r,e._request)})})})});function Zt(t){this._store=t}Zt.prototype.createIndex=function(){return new _r(this._store.createIndex.apply(this._store,arguments))};Zt.prototype.index=function(){return new _r(this._store.index.apply(this._store,arguments))};bs(Zt,"_store",["name","keyPath","indexNames","autoIncrement"]);tl(Zt,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]);im(Zt,"_store",IDBObjectStore,["openCursor","openKeyCursor"]);va(Zt,"_store",IDBObjectStore,["deleteIndex"]);function ki(t){this._tx=t,this.complete=new Promise(function(e,n){t.oncomplete=function(){e()},t.onerror=function(){n(t.error)},t.onabort=function(){n(t.error)}})}ki.prototype.objectStore=function(){return new Zt(this._tx.objectStore.apply(this._tx,arguments))};bs(ki,"_tx",["objectStoreNames","mode"]);va(ki,"_tx",IDBTransaction,["abort"]);function wa(t,e,n){this._db=t,this.oldVersion=e,this.transaction=new ki(n)}wa.prototype.createObjectStore=function(){return new Zt(this._db.createObjectStore.apply(this._db,arguments))};bs(wa,"_db",["name","version","objectStoreNames"]);va(wa,"_db",IDBDatabase,["deleteObjectStore","close"]);function _a(t){this._db=t}_a.prototype.transaction=function(){return new ki(this._db.transaction.apply(this._db,arguments))};bs(_a,"_db",["name","version","objectStoreNames"]);va(_a,"_db",IDBDatabase,["close"]);["openCursor","openKeyCursor"].forEach(function(t){[Zt,_r].forEach(function(e){t in e.prototype&&(e.prototype[t.replace("open","iterate")]=function(){var n=vI(arguments),r=n[n.length-1],s=this._store||this._index,i=s[t].apply(s,n.slice(0,-1));i.onsuccess=function(){r(i.result)}})})});[_r,Zt].forEach(function(t){t.prototype.getAll||(t.prototype.getAll=function(e,n){var r=this,s=[];return new Promise(function(i){r.iterateCursor(e,function(o){if(!o){i(s);return}if(s.push(o.value),n!==void 0&&s.length==n){i(s);return}o.continue()})})})});function _I(t,e,n){var r=el(indexedDB,"open",[t,e]),s=r.request;return s&&(s.onupgradeneeded=function(i){n&&n(new wa(s.result,i.oldVersion,s.transaction))}),r.then(function(i){return new _a(i)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bI{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(EI(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function EI(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Hu="@firebase/app",bf="0.7.18";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nl=new Zc("@firebase/app"),TI="@firebase/app-compat",II="@firebase/analytics-compat",SI="@firebase/analytics",xI="@firebase/app-check-compat",AI="@firebase/app-check",CI="@firebase/auth",kI="@firebase/auth-compat",OI="@firebase/database",DI="@firebase/database-compat",NI="@firebase/functions",RI="@firebase/functions-compat",PI="@firebase/installations",MI="@firebase/installations-compat",FI="@firebase/messaging",LI="@firebase/messaging-compat",qI="@firebase/performance",$I="@firebase/performance-compat",UI="@firebase/remote-config",BI="@firebase/remote-config-compat",jI="@firebase/storage",VI="@firebase/storage-compat",KI="@firebase/firestore",GI="@firebase/firestore-compat",HI="firebase",zI="9.6.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const or="[DEFAULT]",WI={[Hu]:"fire-core",[TI]:"fire-core-compat",[SI]:"fire-analytics",[II]:"fire-analytics-compat",[AI]:"fire-app-check",[xI]:"fire-app-check-compat",[CI]:"fire-auth",[kI]:"fire-auth-compat",[OI]:"fire-rtdb",[DI]:"fire-rtdb-compat",[NI]:"fire-fn",[RI]:"fire-fn-compat",[PI]:"fire-iid",[MI]:"fire-iid-compat",[FI]:"fire-fcm",[LI]:"fire-fcm-compat",[qI]:"fire-perf",[$I]:"fire-perf-compat",[UI]:"fire-rc",[BI]:"fire-rc-compat",[jI]:"fire-gcs",[VI]:"fire-gcs-compat",[KI]:"fire-fst",[GI]:"fire-fst-compat","fire-js":"fire-js",[HI]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nn=new Map,ai=new Map;function $o(t,e){try{t.container.addComponent(e)}catch(n){nl.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function om(t,e){t.container.addOrOverwriteComponent(e)}function ts(t){const e=t.name;if(ai.has(e))return nl.debug(`There were multiple attempts to register component ${e}.`),!1;ai.set(e,t);for(const n of Nn.values())$o(n,t);return!0}function am(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function QI(t,e,n=or){am(t,e).clearInstance(n)}function YI(){ai.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JI={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["storage-open"]:"Error thrown when opening storage. Original error: {$originalErrorMessage}.",["storage-get"]:"Error thrown when reading from storage. Original error: {$originalErrorMessage}.",["storage-set"]:"Error thrown when writing to storage. Original error: {$originalErrorMessage}.",["storage-delete"]:"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."},cn=new ya("app","Firebase",JI);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XI{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ir("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw cn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rl=zI;function um(t,e={}){typeof e!="object"&&(e={name:e});const n=Object.assign({name:or,automaticDataCollectionEnabled:!1},e),r=n.name;if(typeof r!="string"||!r)throw cn.create("bad-app-name",{appName:String(r)});const s=Nn.get(r);if(s){if(Gu(t,s.options)&&Gu(n,s.config))return s;throw cn.create("duplicate-app",{appName:r})}const i=new fI(r);for(const a of ai.values())i.addComponent(a);const o=new XI(t,n,i);return Nn.set(r,o),o}function ZI(t=or){const e=Nn.get(t);if(!e)throw cn.create("no-app",{appName:t});return e}function eS(){return Array.from(Nn.values())}async function cm(t){const e=t.name;Nn.has(e)&&(Nn.delete(e),await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function Cn(t,e,n){var r;let s=(r=WI[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),nl.warn(a.join(" "));return}ts(new ir(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}function lm(t,e){if(t!==null&&typeof t!="function")throw cn.create("invalid-log-argument");yI(t,e)}function hm(t){gI(t)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tS="firebase-heartbeat-database",nS=1,ar="firebase-heartbeat-store";let lu=null;function sl(){return lu||(lu=_I(tS,nS,t=>{switch(t.oldVersion){case 0:t.createObjectStore(ar)}}).catch(t=>{throw cn.create("storage-open",{originalErrorMessage:t.message})})),lu}async function rS(t){try{return(await sl()).transaction(ar).objectStore(ar).get(il(t))}catch(e){throw cn.create("storage-get",{originalErrorMessage:e.message})}}async function hu(t,e){try{const r=(await sl()).transaction(ar,"readwrite");return await r.objectStore(ar).put(e,il(t)),r.complete}catch(n){throw cn.create("storage-set",{originalErrorMessage:n.message})}}async function sS(t){try{const n=(await sl()).transaction(ar,"readwrite");return await n.objectStore(ar).delete(il(t)),n.complete}catch(e){throw cn.create("storage-delete",{originalErrorMessage:e.message})}}function il(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iS=1024,oS=30*24*60*60*1e3;class aS{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new lS(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=uS();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!this._heartbeatsCache.some(s=>s.date===r))return this._heartbeatsCache.push({date:r,userAgent:n}),this._heartbeatsCache=this._heartbeatsCache.filter(s=>{const i=new Date(s.date).valueOf();return Date.now()-i<=oS}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null)return"";const{heartbeatsToSend:e,unsentEntries:n}=cS(this._heartbeatsCache),r=Jc(JSON.stringify({version:2,heartbeats:e}));return n.length>0?(this._heartbeatsCache=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache=null,this._storage.deleteAll()),r}}function uS(){return new Date().toISOString().substring(0,10)}function cS(t,e=iS){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.userAgent===s.userAgent);if(i){if(i.dates.push(s.date),Ef(n)>e){i.dates.pop();break}}else if(n.push({userAgent:s.userAgent,dates:[s.date]}),Ef(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class lS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return nm()?nI().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await rS(this.app);return(n==null?void 0:n.heartbeats)||[]}else return[]}async overwrite(e){if(await this._canUseIndexedDBPromise)return hu(this.app,{heartbeats:e})}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return hu(this.app,{heartbeats:[...r,...e]})}else return}async delete(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return hu(this.app,{heartbeats:r.filter(s=>!e.includes(s))})}else return}async deleteAll(){if(await this._canUseIndexedDBPromise)return sS(this.app)}}function Ef(t){return Jc(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hS(t){ts(new ir("platform-logger",e=>new bI(e),"PRIVATE")),ts(new ir("heartbeat",e=>new aS(e),"PRIVATE")),Cn(Hu,bf,t),Cn(Hu,bf,"esm2017"),Cn("fire-js","")}hS("");var fS=Object.freeze(Object.defineProperty({__proto__:null,SDK_VERSION:rl,_DEFAULT_ENTRY_NAME:or,_addComponent:$o,_addOrOverwriteComponent:om,_apps:Nn,_clearComponents:YI,_components:ai,_getProvider:am,_registerComponent:ts,_removeServiceInstance:QI,deleteApp:cm,getApp:ZI,getApps:eS,initializeApp:um,onLog:lm,registerVersion:Cn,setLogLevel:hm,FirebaseError:Ci},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dS{constructor(e,n){this._delegate=e,this.firebase=n,$o(e,new ir("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),cm(this._delegate)))}_getService(e,n=or){var r;this._delegate.checkDestroyed();const s=this._delegate.container.getProvider(e);return!s.isInitialized()&&((r=s.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&s.initialize(),s.getImmediate({identifier:n})}_removeServiceInstance(e,n=or){this._delegate.container.getProvider(e).clearInstance(n)}_addComponent(e){$o(this._delegate,e)}_addOrOverwriteComponent(e){om(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pS={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance."},Tf=new ya("app-compat","Firebase",pS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mS(t){const e={},n={__esModule:!0,initializeApp:i,app:s,registerVersion:Cn,setLogLevel:hm,onLog:lm,apps:null,SDK_VERSION:rl,INTERNAL:{registerComponent:a,removeApp:r,useAsService:u,modularAPIs:fS}};n.default=n,Object.defineProperty(n,"apps",{get:o});function r(c){delete e[c]}function s(c){if(c=c||or,!wf(e,c))throw Tf.create("no-app",{appName:c});return e[c]}s.App=t;function i(c,l={}){const h=um(c,l);if(wf(e,h.name))return e[h.name];const f=new t(h,n);return e[h.name]=f,f}function o(){return Object.keys(e).map(c=>e[c])}function a(c){const l=c.name,h=l.replace("-compat","");if(ts(c)&&c.type==="PUBLIC"){const f=(p=s())=>{if(typeof p[h]!="function")throw Tf.create("invalid-app-argument",{appName:l});return p[h]()};c.serviceProps!==void 0&&qo(f,c.serviceProps),n[h]=f,t.prototype[h]=function(...p){return this._getService.bind(this,l).apply(this,c.multipleInstances?p:[])}}return c.type==="PUBLIC"?n[h]:null}function u(c,l){return l==="serverAuth"?null:l}return n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fm(){const t=mS(dS);t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:fm,extendNamespace:e,createSubscribe:oI,ErrorFactory:ya,deepExtend:qo});function e(n){qo(t,n)}return t}const gS=fm();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const If=new Zc("@firebase/app-compat"),yS="@firebase/app-compat",vS="0.1.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wS(t){Cn(yS,vS,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(QT()&&self.firebase!==void 0){If.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);const t=self.firebase.SDK_VERSION;t&&t.indexOf("LITE")>=0&&If.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}const dm=gS;wS();var _S="firebase",bS="9.6.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */dm.registerVersion(_S,bS,"app-compat");var ES=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},P,ol=ol||{},V=ES||self;function Uo(){}function zu(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Oi(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function TS(t){return Object.prototype.hasOwnProperty.call(t,fu)&&t[fu]||(t[fu]=++IS)}var fu="closure_uid_"+(1e9*Math.random()>>>0),IS=0;function SS(t,e,n){return t.call.apply(t.bind,arguments)}function xS(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),t.apply(e,s)}}return function(){return t.apply(e,arguments)}}function He(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?He=SS:He=xS,He.apply(null,arguments)}function ao(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function Ye(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(r,s,i){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[s].apply(r,o)}}function qn(){this.s=this.s,this.o=this.o}var AS=0,CS={};qn.prototype.s=!1;qn.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),AS!=0)){var t=TS(this);delete CS[t]}};qn.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const pm=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},mm=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){const r=t.length,s=typeof t=="string"?t.split(""):t;for(let i=0;i<r;i++)i in s&&e.call(n,s[i],i,t)};function kS(t){e:{var e=_x;const n=t.length,r=typeof t=="string"?t.split(""):t;for(let s=0;s<n;s++)if(s in r&&e.call(void 0,r[s],s,t)){e=s;break e}e=-1}return 0>e?null:typeof t=="string"?t.charAt(e):t[e]}function Sf(t){return Array.prototype.concat.apply([],arguments)}function al(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function Bo(t){return/^[\s\xa0]*$/.test(t)}var xf=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function ut(t,e){return t.indexOf(e)!=-1}function du(t,e){return t<e?-1:t>e?1:0}var ct;e:{var Af=V.navigator;if(Af){var Cf=Af.userAgent;if(Cf){ct=Cf;break e}}ct=""}function ul(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function gm(t){const e={};for(const n in t)e[n]=t[n];return e}var kf="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ym(t,e){let n,r;for(let s=1;s<arguments.length;s++){r=arguments[s];for(n in r)t[n]=r[n];for(let i=0;i<kf.length;i++)n=kf[i],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function cl(t){return cl[" "](t),t}cl[" "]=Uo;function OS(t){var e=RS;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}var DS=ut(ct,"Opera"),ns=ut(ct,"Trident")||ut(ct,"MSIE"),vm=ut(ct,"Edge"),Wu=vm||ns,wm=ut(ct,"Gecko")&&!(ut(ct.toLowerCase(),"webkit")&&!ut(ct,"Edge"))&&!(ut(ct,"Trident")||ut(ct,"MSIE"))&&!ut(ct,"Edge"),NS=ut(ct.toLowerCase(),"webkit")&&!ut(ct,"Edge");function _m(){var t=V.document;return t?t.documentMode:void 0}var jo;e:{var pu="",mu=function(){var t=ct;if(wm)return/rv:([^\);]+)(\)|;)/.exec(t);if(vm)return/Edge\/([\d\.]+)/.exec(t);if(ns)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(NS)return/WebKit\/(\S+)/.exec(t);if(DS)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(mu&&(pu=mu?mu[1]:""),ns){var gu=_m();if(gu!=null&&gu>parseFloat(pu)){jo=String(gu);break e}}jo=pu}var RS={};function PS(){return OS(function(){let t=0;const e=xf(String(jo)).split("."),n=xf("9").split("."),r=Math.max(e.length,n.length);for(let o=0;t==0&&o<r;o++){var s=e[o]||"",i=n[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],s[0].length==0&&i[0].length==0)break;t=du(s[1].length==0?0:parseInt(s[1],10),i[1].length==0?0:parseInt(i[1],10))||du(s[2].length==0,i[2].length==0)||du(s[2],i[2]),s=s[3],i=i[3]}while(t==0)}return 0<=t})}var Qu;if(V.document&&ns){var Of=_m();Qu=Of||parseInt(jo,10)||void 0}else Qu=void 0;var MS=Qu,FS=function(){if(!V.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{V.addEventListener("test",Uo,e),V.removeEventListener("test",Uo,e)}catch{}return t}();function nt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}nt.prototype.h=function(){this.defaultPrevented=!0};function ui(t,e){if(nt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(wm){e:{try{cl(e.nodeName);var s=!0;break e}catch{}s=!1}s||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:LS[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&ui.Z.h.call(this)}}Ye(ui,nt);var LS={2:"touch",3:"pen",4:"mouse"};ui.prototype.h=function(){ui.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Di="closure_listenable_"+(1e6*Math.random()|0),qS=0;function $S(t,e,n,r,s){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=s,this.key=++qS,this.ca=this.fa=!1}function ba(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function Ea(t){this.src=t,this.g={},this.h=0}Ea.prototype.add=function(t,e,n,r,s){var i=t.toString();t=this.g[i],t||(t=this.g[i]=[],this.h++);var o=Ju(t,e,r,s);return-1<o?(e=t[o],n||(e.fa=!1)):(e=new $S(e,this.src,i,!!r,s),e.fa=n,t.push(e)),e};function Yu(t,e){var n=e.type;if(n in t.g){var r=t.g[n],s=pm(r,e),i;(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(ba(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function Ju(t,e,n,r){for(var s=0;s<t.length;++s){var i=t[s];if(!i.ca&&i.listener==e&&i.capture==!!n&&i.ia==r)return s}return-1}var ll="closure_lm_"+(1e6*Math.random()|0),yu={};function bm(t,e,n,r,s){if(r&&r.once)return Tm(t,e,n,r,s);if(Array.isArray(e)){for(var i=0;i<e.length;i++)bm(t,e[i],n,r,s);return null}return n=dl(n),t&&t[Di]?t.N(e,n,Oi(r)?!!r.capture:!!r,s):Em(t,e,n,!1,r,s)}function Em(t,e,n,r,s,i){if(!e)throw Error("Invalid event type");var o=Oi(s)?!!s.capture:!!s,a=fl(t);if(a||(t[ll]=a=new Ea(t)),n=a.add(e,n,r,o,i),n.proxy)return n;if(r=US(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)FS||(s=o),s===void 0&&(s=!1),t.addEventListener(e.toString(),r,s);else if(t.attachEvent)t.attachEvent(Sm(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function US(){function t(n){return e.call(t.src,t.listener,n)}var e=BS;return t}function Tm(t,e,n,r,s){if(Array.isArray(e)){for(var i=0;i<e.length;i++)Tm(t,e[i],n,r,s);return null}return n=dl(n),t&&t[Di]?t.O(e,n,Oi(r)?!!r.capture:!!r,s):Em(t,e,n,!0,r,s)}function Im(t,e,n,r,s){if(Array.isArray(e))for(var i=0;i<e.length;i++)Im(t,e[i],n,r,s);else r=Oi(r)?!!r.capture:!!r,n=dl(n),t&&t[Di]?(t=t.i,e=String(e).toString(),e in t.g&&(i=t.g[e],n=Ju(i,n,r,s),-1<n&&(ba(i[n]),Array.prototype.splice.call(i,n,1),i.length==0&&(delete t.g[e],t.h--)))):t&&(t=fl(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Ju(e,n,r,s)),(n=-1<t?e[t]:null)&&hl(n))}function hl(t){if(typeof t!="number"&&t&&!t.ca){var e=t.src;if(e&&e[Di])Yu(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Sm(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=fl(e))?(Yu(n,t),n.h==0&&(n.src=null,e[ll]=null)):ba(t)}}}function Sm(t){return t in yu?yu[t]:yu[t]="on"+t}function BS(t,e){if(t.ca)t=!0;else{e=new ui(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&hl(t),t=n.call(r,e)}return t}function fl(t){return t=t[ll],t instanceof Ea?t:null}var vu="__closure_events_fn_"+(1e9*Math.random()>>>0);function dl(t){return typeof t=="function"?t:(t[vu]||(t[vu]=function(e){return t.handleEvent(e)}),t[vu])}function $e(){qn.call(this),this.i=new Ea(this),this.P=this,this.I=null}Ye($e,qn);$e.prototype[Di]=!0;$e.prototype.removeEventListener=function(t,e,n,r){Im(this,t,e,n,r)};function ze(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,typeof e=="string")e=new nt(e,t);else if(e instanceof nt)e.target=e.target||t;else{var s=e;e=new nt(r,t),ym(e,s)}if(s=!0,n)for(var i=n.length-1;0<=i;i--){var o=e.g=n[i];s=uo(o,r,!0,e)&&s}if(o=e.g=t,s=uo(o,r,!0,e)&&s,s=uo(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)o=e.g=n[i],s=uo(o,r,!1,e)&&s}$e.prototype.M=function(){if($e.Z.M.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)ba(n[r]);delete t.g[e],t.h--}}this.I=null};$e.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};$e.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function uo(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var s=!0,i=0;i<e.length;++i){var o=e[i];if(o&&!o.ca&&o.capture==n){var a=o.listener,u=o.ia||o.src;o.fa&&Yu(t.i,o),s=a.call(u,r)!==!1&&s}}return s&&!r.defaultPrevented}var pl=V.JSON.stringify;function jS(){var t=Am;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class VS{constructor(){this.h=this.g=null}add(e,n){const r=xm.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}}var xm=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new KS,t=>t.reset());class KS{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function GS(t){V.setTimeout(()=>{throw t},0)}function ml(t,e){Xu||HS(),Zu||(Xu(),Zu=!0),Am.add(t,e)}var Xu;function HS(){var t=V.Promise.resolve(void 0);Xu=function(){t.then(zS)}}var Zu=!1,Am=new VS;function zS(){for(var t;t=jS();){try{t.h.call(t.g)}catch(n){GS(n)}var e=xm;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Zu=!1}function Ta(t,e){$e.call(this),this.h=t||1,this.g=e||V,this.j=He(this.kb,this),this.l=Date.now()}Ye(Ta,$e);P=Ta.prototype;P.da=!1;P.S=null;P.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),ze(this,"tick"),this.da&&(gl(this),this.start()))}};P.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function gl(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}P.M=function(){Ta.Z.M.call(this),gl(this),delete this.g};function yl(t,e,n){if(typeof t=="function")n&&(t=He(t,n));else if(t&&typeof t.handleEvent=="function")t=He(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:V.setTimeout(t,e||0)}function Cm(t){t.g=yl(()=>{t.g=null,t.i&&(t.i=!1,Cm(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class WS extends qn{constructor(e,n){super();this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Cm(this)}M(){super.M(),this.g&&(V.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ci(t){qn.call(this),this.h=t,this.g={}}Ye(ci,qn);var Df=[];function km(t,e,n,r){Array.isArray(n)||(n&&(Df[0]=n.toString()),n=Df);for(var s=0;s<n.length;s++){var i=bm(e,n[s],r||t.handleEvent,!1,t.h||t);if(!i)break;t.g[i.key]=i}}function Om(t){ul(t.g,function(e,n){this.g.hasOwnProperty(n)&&hl(e)},t),t.g={}}ci.prototype.M=function(){ci.Z.M.call(this),Om(this)};ci.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Ia(){this.g=!0}Ia.prototype.Aa=function(){this.g=!1};function QS(t,e,n,r,s,i){t.info(function(){if(t.g)if(i)for(var o="",a=i.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");o=2<=h.length&&h[1]=="type"?o+(l+"="+c+"&"):o+(l+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+e+`
`+n+`
`+o})}function YS(t,e,n,r,s,i,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+e+`
`+n+`
`+i+" "+o})}function Kr(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+XS(t,n)+(r?" "+r:"")})}function JS(t,e){t.info(function(){return"TIMEOUT: "+e})}Ia.prototype.info=function(){};function XS(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if(i!="noop"&&i!="stop"&&i!="close")for(var o=1;o<s.length;o++)s[o]=""}}}}return pl(n)}catch{return e}}var br={},Nf=null;function Sa(){return Nf=Nf||new $e}br.Ma="serverreachability";function Dm(t){nt.call(this,br.Ma,t)}Ye(Dm,nt);function li(t){const e=Sa();ze(e,new Dm(e,t))}br.STAT_EVENT="statevent";function Nm(t,e){nt.call(this,br.STAT_EVENT,t),this.stat=e}Ye(Nm,nt);function lt(t){const e=Sa();ze(e,new Nm(e,t))}br.Na="timingevent";function Rm(t,e){nt.call(this,br.Na,t),this.size=e}Ye(Rm,nt);function Ni(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return V.setTimeout(function(){t()},e)}var xa={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Pm={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function vl(){}vl.prototype.h=null;function Rf(t){return t.h||(t.h=t.i())}function Mm(){}var Ri={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function wl(){nt.call(this,"d")}Ye(wl,nt);function _l(){nt.call(this,"c")}Ye(_l,nt);var ec;function Aa(){}Ye(Aa,vl);Aa.prototype.g=function(){return new XMLHttpRequest};Aa.prototype.i=function(){return{}};ec=new Aa;function Pi(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new ci(this),this.P=ZS,t=Wu?125:void 0,this.W=new Ta(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new Fm}function Fm(){this.i=null,this.g="",this.h=!1}var ZS=45e3,tc={},Vo={};P=Pi.prototype;P.setTimeout=function(t){this.P=t};function nc(t,e,n){t.K=1,t.v=ka(ln(e)),t.s=n,t.U=!0,Lm(t,null)}function Lm(t,e){t.F=Date.now(),Mi(t),t.A=ln(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),Km(n.h,"t",r),t.C=0,n=t.l.H,t.h=new Fm,t.g=lg(t.l,n?e:null,!t.s),0<t.O&&(t.L=new WS(He(t.Ia,t,t.g),t.O)),km(t.V,t.g,"readystatechange",t.gb),e=t.H?gm(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),li(1),QS(t.j,t.u,t.A,t.m,t.X,t.s)}P.gb=function(t){t=t.target;const e=this.L;e&&on(t)==3?e.l():this.Ia(t)};P.Ia=function(t){try{if(t==this.g)e:{const l=on(this.g);var e=this.g.Da();const h=this.g.ba();if(!(3>l)&&(l!=3||Wu||this.g&&(this.h.h||this.g.ga()||Lf(this.g)))){this.I||l!=4||e==7||(e==8||0>=h?li(3):li(2)),Ca(this);var n=this.g.ba();this.N=n;t:if(qm(this)){var r=Lf(this.g);t="";var s=r.length,i=on(this.g)==4;if(!this.h.i){if(typeof TextDecoder=="undefined"){Wn(this),Hs(this);var o="";break t}this.h.i=new V.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:i&&e==s-1});r.splice(0,s),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ga();if(this.i=n==200,YS(this.j,this.u,this.A,this.m,this.X,l,n),this.i){if(this.$&&!this.J){t:{if(this.g){var a,u=this.g;if((a=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Bo(a)){var c=a;break t}}c=null}if(n=c)Kr(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,rc(this,n);else{this.i=!1,this.o=3,lt(12),Wn(this),Hs(this);break e}}this.U?($m(this,l,o),Wu&&this.i&&l==3&&(km(this.V,this.W,"tick",this.fb),this.W.start())):(Kr(this.j,this.m,o,null),rc(this,o)),l==4&&Wn(this),this.i&&!this.I&&(l==4?og(this.l,this):(this.i=!1,Mi(this)))}else n==400&&0<o.indexOf("Unknown SID")?(this.o=3,lt(12)):(this.o=0,lt(13)),Wn(this),Hs(this)}}}catch{}finally{}};function qm(t){return t.g?t.u=="GET"&&t.K!=2&&t.l.Ba:!1}function $m(t,e,n){let r=!0,s;for(;!t.I&&t.C<n.length;)if(s=ex(t,n),s==Vo){e==4&&(t.o=4,lt(14),r=!1),Kr(t.j,t.m,null,"[Incomplete Response]");break}else if(s==tc){t.o=4,lt(15),Kr(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else Kr(t.j,t.m,s,null),rc(t,s);qm(t)&&s!=Vo&&s!=tc&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,lt(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.aa&&(t.aa=!0,e=t.l,e.g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),kl(e),e.L=!0,lt(11))):(Kr(t.j,t.m,n,"[Invalid Chunked Response]"),Wn(t),Hs(t))}P.fb=function(){if(this.g){var t=on(this.g),e=this.g.ga();this.C<e.length&&(Ca(this),$m(this,t,e),this.i&&t!=4&&Mi(this))}};function ex(t,e){var n=t.C,r=e.indexOf(`
`,n);return r==-1?Vo:(n=Number(e.substring(n,r)),isNaN(n)?tc:(r+=1,r+n>e.length?Vo:(e=e.substr(r,n),t.C=r+n,e)))}P.cancel=function(){this.I=!0,Wn(this)};function Mi(t){t.Y=Date.now()+t.P,Um(t,t.P)}function Um(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=Ni(He(t.eb,t),e)}function Ca(t){t.B&&(V.clearTimeout(t.B),t.B=null)}P.eb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(JS(this.j,this.A),this.K!=2&&(li(3),lt(17)),Wn(this),this.o=2,Hs(this)):Um(this,this.Y-t)};function Hs(t){t.l.G==0||t.I||og(t.l,t)}function Wn(t){Ca(t);var e=t.L;e&&typeof e.na=="function"&&e.na(),t.L=null,gl(t.W),Om(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function rc(t,e){try{var n=t.l;if(n.G!=0&&(n.g==t||sc(n.i,t))){if(n.I=t.N,!t.J&&sc(n.i,t)&&n.G==3){try{var r=n.Ca.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var s=r;if(s[0]==0)e:if(!n.u){if(n.g)if(n.g.F+3e3<t.F)zo(n),Na(n);else break e;Cl(n),lt(18)}else n.ta=s[1],0<n.ta-n.U&&37500>s[2]&&n.N&&n.A==0&&!n.v&&(n.v=Ni(He(n.ab,n),6e3));if(1>=zm(n.i)&&n.ka){try{n.ka()}catch{}n.ka=void 0}}else Qn(n,11)}else if((t.J||n.g==t)&&zo(n),!Bo(e))for(s=n.Ca.g.parse(e),e=0;e<s.length;e++){let c=s[e];if(n.U=c[0],c=c[1],n.G==2)if(c[0]=="c"){n.J=c[1],n.la=c[2];const l=c[3];l!=null&&(n.ma=l,n.h.info("VER="+n.ma));const h=c[4];h!=null&&(n.za=h,n.h.info("SVER="+n.za));const f=c[5];f!=null&&typeof f=="number"&&0<f&&(r=1.5*f,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;const p=t.g;if(p){const g=p.g?p.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(g){var i=r.i;!i.g&&(ut(g,"spdy")||ut(g,"quic")||ut(g,"h2"))&&(i.j=i.l,i.g=new Set,i.h&&(Tl(i,i.h),i.h=null))}if(r.D){const T=p.g?p.g.getResponseHeader("X-HTTP-Session-Id"):null;T&&(r.sa=T,we(r.F,r.D,T))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms")),r=n;var o=t;if(r.oa=cg(r,r.H?r.la:null,r.W),o.J){Wm(r.i,o);var a=o,u=r.K;u&&a.setTimeout(u),a.B&&(Ca(a),Mi(a)),r.g=o}else sg(r);0<n.l.length&&Ra(n)}else c[0]!="stop"&&c[0]!="close"||Qn(n,7);else n.G==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?Qn(n,7):Al(n):c[0]!="noop"&&n.j&&n.j.wa(c),n.A=0)}}li(4)}catch{}}function tx(t){if(t.R&&typeof t.R=="function")return t.R();if(typeof t=="string")return t.split("");if(zu(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function bl(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(zu(t)||typeof t=="string")mm(t,e,void 0);else{if(t.T&&typeof t.T=="function")var n=t.T();else if(t.R&&typeof t.R=="function")n=void 0;else if(zu(t)||typeof t=="string"){n=[];for(var r=t.length,s=0;s<r;s++)n.push(s)}else for(s in n=[],r=0,t)n[r++]=s;r=tx(t),s=r.length;for(var i=0;i<s;i++)e.call(void 0,r[i],n&&n[i],t)}}function Es(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Es)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}P=Es.prototype;P.R=function(){El(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t};P.T=function(){return El(this),this.g.concat()};function El(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];ur(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){var s={};for(n=e=0;e<t.g.length;)r=t.g[e],ur(s,r)||(t.g[n++]=r,s[r]=1),e++;t.g.length=n}}P.get=function(t,e){return ur(this.h,t)?this.h[t]:e};P.set=function(t,e){ur(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e};P.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var s=n[r],i=this.get(s);t.call(e,i,s,this)}};function ur(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var Bm=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function nx(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),s=null;if(0<=r){var i=t[n].substring(0,r);s=t[n].substring(r+1)}else i=t[n];e(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}function cr(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof cr){this.g=e!==void 0?e:t.g,Ko(this,t.j),this.s=t.s,Go(this,t.i),Ho(this,t.m),this.l=t.l,e=t.h;var n=new hi;n.i=e.i,e.g&&(n.g=new Es(e.g),n.h=e.h),Pf(this,n),this.o=t.o}else t&&(n=String(t).match(Bm))?(this.g=!!e,Ko(this,n[1]||"",!0),this.s=zs(n[2]||""),Go(this,n[3]||"",!0),Ho(this,n[4]),this.l=zs(n[5]||"",!0),Pf(this,n[6]||"",!0),this.o=zs(n[7]||"")):(this.g=!!e,this.h=new hi(null,this.g))}cr.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Us(e,Mf,!0),":");var n=this.i;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Us(e,Mf,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.i&&n.charAt(0)!="/"&&t.push("/"),t.push(Us(n,n.charAt(0)=="/"?ax:ox,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Us(n,cx)),t.join("")};function ln(t){return new cr(t)}function Ko(t,e,n){t.j=n?zs(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Go(t,e,n){t.i=n?zs(e,!0):e}function Ho(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Pf(t,e,n){e instanceof hi?(t.h=e,lx(t.h,t.g)):(n||(e=Us(e,ux)),t.h=new hi(e,t.g))}function we(t,e,n){t.h.set(e,n)}function ka(t){return we(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function rx(t){return t instanceof cr?ln(t):new cr(t,void 0)}function sx(t,e,n,r){var s=new cr(null,void 0);return t&&Ko(s,t),e&&Go(s,e),n&&Ho(s,n),r&&(s.l=r),s}function zs(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Us(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,ix),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function ix(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var Mf=/[#\/\?@]/g,ox=/[#\?:]/g,ax=/[#\?]/g,ux=/[#\?@]/g,cx=/#/g;function hi(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function $n(t){t.g||(t.g=new Es,t.h=0,t.i&&nx(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}P=hi.prototype;P.add=function(t,e){$n(this),this.i=null,t=Ts(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function jm(t,e){$n(t),e=Ts(t,e),ur(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,t=t.g,ur(t.h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&El(t)))}function Vm(t,e){return $n(t),e=Ts(t,e),ur(t.g.h,e)}P.forEach=function(t,e){$n(this),this.g.forEach(function(n,r){mm(n,function(s){t.call(e,s,r,this)},this)},this)};P.T=function(){$n(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var s=t[r],i=0;i<s.length;i++)n.push(e[r]);return n};P.R=function(t){$n(this);var e=[];if(typeof t=="string")Vm(this,t)&&(e=Sf(e,this.g.get(Ts(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=Sf(e,t[n])}return e};P.set=function(t,e){return $n(this),this.i=null,t=Ts(this,t),Vm(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};P.get=function(t,e){return t?(t=this.R(t),0<t.length?String(t[0]):e):e};function Km(t,e,n){jm(t,e),0<n.length&&(t.i=null,t.g.set(Ts(t,e),al(n)),t.h+=n.length)}P.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],s=encodeURIComponent(String(r));r=this.R(r);for(var i=0;i<r.length;i++){var o=s;r[i]!==""&&(o+="="+encodeURIComponent(String(r[i]))),t.push(o)}}return this.i=t.join("&")};function Ts(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function lx(t,e){e&&!t.j&&($n(t),t.i=null,t.g.forEach(function(n,r){var s=r.toLowerCase();r!=s&&(jm(this,r),Km(this,s,n))},t)),t.j=e}var hx=class{constructor(t,e){this.h=t,this.g=e}};function Gm(t){this.l=t||fx,V.PerformanceNavigationTiming?(t=V.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(V.g&&V.g.Ea&&V.g.Ea()&&V.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var fx=10;function Hm(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function zm(t){return t.h?1:t.g?t.g.size:0}function sc(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function Tl(t,e){t.g?t.g.add(e):t.h=e}function Wm(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}Gm.prototype.cancel=function(){if(this.i=Qm(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function Qm(t){if(t.h!=null)return t.i.concat(t.h.D);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return al(t.i)}function Il(){}Il.prototype.stringify=function(t){return V.JSON.stringify(t,void 0)};Il.prototype.parse=function(t){return V.JSON.parse(t,void 0)};function dx(){this.g=new Il}function px(t,e,n){const r=n||"";try{bl(t,function(s,i){let o=s;Oi(s)&&(o=pl(s)),e.push(r+i+"="+encodeURIComponent(o))})}catch(s){throw e.push(r+"type="+encodeURIComponent("_badmap")),s}}function mx(t,e){const n=new Ia;if(V.Image){const r=new Image;r.onload=ao(co,n,r,"TestLoadImage: loaded",!0,e),r.onerror=ao(co,n,r,"TestLoadImage: error",!1,e),r.onabort=ao(co,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=ao(co,n,r,"TestLoadImage: timeout",!1,e),V.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function co(t,e,n,r,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(r)}catch{}}function Fi(t){this.l=t.$b||null,this.j=t.ib||!1}Ye(Fi,vl);Fi.prototype.g=function(){return new Oa(this.l,this.j)};Fi.prototype.i=function(t){return function(){return t}}({});function Oa(t,e){$e.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=Sl,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Ye(Oa,$e);var Sl=0;P=Oa.prototype;P.open=function(t,e){if(this.readyState!=Sl)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,fi(this)};P.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||V).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))};P.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Li(this)),this.readyState=Sl};P.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,fi(this)),this.g&&(this.readyState=3,fi(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(typeof V.ReadableStream!="undefined"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Ym(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))};function Ym(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}P.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Li(this):fi(this),this.readyState==3&&Ym(this)}};P.Ua=function(t){this.g&&(this.response=this.responseText=t,Li(this))};P.Ta=function(t){this.g&&(this.response=t,Li(this))};P.ha=function(){this.g&&Li(this)};function Li(t){t.readyState=4,t.l=null,t.j=null,t.A=null,fi(t)}P.setRequestHeader=function(t,e){this.v.append(t,e)};P.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};P.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function fi(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(Oa.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var gx=V.JSON.parse;function Oe(t){$e.call(this),this.headers=new Es,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Jm,this.K=this.L=!1}Ye(Oe,$e);var Jm="",yx=/^https?$/i,vx=["POST","PUT"];P=Oe.prototype;P.ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():ec.g(),this.C=this.u?Rf(this.u):Rf(ec),this.g.onreadystatechange=He(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(i){Ff(this,i);return}t=n||"";const s=new Es(this.headers);r&&bl(r,function(i,o){s.set(o,i)}),r=kS(s.T()),n=V.FormData&&t instanceof V.FormData,!(0<=pm(vx,e))||r||n||s.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),s.forEach(function(i,o){this.g.setRequestHeader(o,i)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{eg(this),0<this.B&&((this.K=wx(this.g))?(this.g.timeout=this.B,this.g.ontimeout=He(this.pa,this)):this.A=yl(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(i){Ff(this,i)}};function wx(t){return ns&&PS()&&typeof t.timeout=="number"&&t.ontimeout!==void 0}function _x(t){return t.toLowerCase()=="content-type"}P.pa=function(){typeof ol!="undefined"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,ze(this,"timeout"),this.abort(8))};function Ff(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Xm(t),Da(t)}function Xm(t){t.D||(t.D=!0,ze(t,"complete"),ze(t,"error"))}P.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,ze(this,"complete"),ze(this,"abort"),Da(this))};P.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Da(this,!0)),Oe.Z.M.call(this)};P.Fa=function(){this.s||(this.F||this.v||this.l?Zm(this):this.cb())};P.cb=function(){Zm(this)};function Zm(t){if(t.h&&typeof ol!="undefined"&&(!t.C[1]||on(t)!=4||t.ba()!=2)){if(t.v&&on(t)==4)yl(t.Fa,0,t);else if(ze(t,"readystatechange"),on(t)==4){t.h=!1;try{const a=t.ba();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=a===0){var s=String(t.H).match(Bm)[1]||null;if(!s&&V.self&&V.self.location){var i=V.self.location.protocol;s=i.substr(0,i.length-1)}r=!yx.test(s?s.toLowerCase():"")}n=r}if(n)ze(t,"complete"),ze(t,"success");else{t.m=6;try{var o=2<on(t)?t.g.statusText:""}catch{o=""}t.j=o+" ["+t.ba()+"]",Xm(t)}}finally{Da(t)}}}}function Da(t,e){if(t.g){eg(t);const n=t.g,r=t.C[0]?Uo:null;t.g=null,t.C=null,e||ze(t,"ready");try{n.onreadystatechange=r}catch{}}}function eg(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(V.clearTimeout(t.A),t.A=null)}function on(t){return t.g?t.g.readyState:0}P.ba=function(){try{return 2<on(this)?this.g.status:-1}catch{return-1}};P.ga=function(){try{return this.g?this.g.responseText:""}catch{return""}};P.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),gx(e)}};function Lf(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case Jm:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}P.Da=function(){return this.m};P.La=function(){return typeof this.j=="string"?this.j:String(this.j)};function bx(t){let e="";return ul(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function xl(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=bx(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):we(t,e,n))}function Ms(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function tg(t){this.za=0,this.l=[],this.h=new Ia,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Ms("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Ms("baseRetryDelayMs",5e3,t),this.$a=Ms("retryDelaySeedMs",1e4,t),this.Ya=Ms("forwardChannelMaxRetries",2,t),this.ra=Ms("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new Gm(t&&t.concurrentRequestLimit),this.Ca=new dx,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||t.Xb!==!1}P=tg.prototype;P.ma=8;P.G=1;function Al(t){if(ng(t),t.G==3){var e=t.V++,n=ln(t.F);we(n,"SID",t.J),we(n,"RID",e),we(n,"TYPE","terminate"),qi(t,n),e=new Pi(t,t.h,e,void 0),e.K=2,e.v=ka(ln(n)),n=!1,V.navigator&&V.navigator.sendBeacon&&(n=V.navigator.sendBeacon(e.v.toString(),"")),!n&&V.Image&&(new Image().src=e.v,n=!0),n||(e.g=lg(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Mi(e)}ug(t)}P.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch{}};function Na(t){t.g&&(kl(t),t.g.cancel(),t.g=null)}function ng(t){Na(t),t.u&&(V.clearTimeout(t.u),t.u=null),zo(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&V.clearTimeout(t.m),t.m=null)}function wu(t,e){t.l.push(new hx(t.Za++,e)),t.G==3&&Ra(t)}function Ra(t){Hm(t.i)||t.m||(t.m=!0,ml(t.Ha,t),t.C=0)}function Ex(t,e){return zm(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.l=e.D.concat(t.l),!0):t.G==1||t.G==2||t.C>=(t.Xa?0:t.Ya)?!1:(t.m=Ni(He(t.Ha,t,e),ag(t,t.C)),t.C++,!0)}P.Ha=function(t){if(this.m)if(this.m=null,this.G==1){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;const s=new Pi(this,this.h,t,void 0);let i=this.s;if(this.P&&(i?(i=gm(i),ym(i,this.P)):i=this.P),this.o===null&&(s.H=i),this.ja)e:{for(var e=0,n=0;n<this.l.length;n++){t:{var r=this.l[n];if("__data__"in r.g&&(r=r.g.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.l.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=rg(this,s,e),n=ln(this.F),we(n,"RID",t),we(n,"CVER",22),this.D&&we(n,"X-HTTP-Session-Id",this.D),qi(this,n),this.o&&i&&xl(n,this.o,i),Tl(this.i,s),this.Ra&&we(n,"TYPE","init"),this.ja?(we(n,"$req",e),we(n,"SID","null"),s.$=!0,nc(s,n,null)):nc(s,n,e),this.G=2}}else this.G==3&&(t?qf(this,t):this.l.length==0||Hm(this.i)||qf(this))};function qf(t,e){var n;e?n=e.m:n=t.V++;const r=ln(t.F);we(r,"SID",t.J),we(r,"RID",n),we(r,"AID",t.U),qi(t,r),t.o&&t.s&&xl(r,t.o,t.s),n=new Pi(t,t.h,n,t.C+1),t.o===null&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=rg(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),Tl(t.i,n),nc(n,r,e)}function qi(t,e){t.j&&bl({},function(n,r){we(e,r,n)})}function rg(t,e,n){n=Math.min(t.l.length,n);var r=t.j?He(t.j.Oa,t.j,t):null;e:{var s=t.l;let i=-1;for(;;){const o=["count="+n];i==-1?0<n?(i=s[0].h,o.push("ofs="+i)):i=0:o.push("ofs="+i);let a=!0;for(let u=0;u<n;u++){let c=s[u].h;const l=s[u].g;if(c-=i,0>c)i=Math.max(0,s[u].h-100),a=!1;else try{px(l,o,"req"+c+"_")}catch{r&&r(l)}}if(a){r=o.join("&");break e}}}return t=t.l.splice(0,n),e.D=t,r}function sg(t){t.g||t.u||(t.Y=1,ml(t.Ga,t),t.A=0)}function Cl(t){return t.g||t.u||3<=t.A?!1:(t.Y++,t.u=Ni(He(t.Ga,t),ag(t,t.A)),t.A++,!0)}P.Ga=function(){if(this.u=null,ig(this),this.$&&!(this.L||this.g==null||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=Ni(He(this.bb,this),t)}};P.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,lt(10),Na(this),ig(this))};function kl(t){t.B!=null&&(V.clearTimeout(t.B),t.B=null)}function ig(t){t.g=new Pi(t,t.h,"rpc",t.Y),t.o===null&&(t.g.H=t.s),t.g.O=0;var e=ln(t.oa);we(e,"RID","rpc"),we(e,"SID",t.J),we(e,"CI",t.N?"0":"1"),we(e,"AID",t.U),qi(t,e),we(e,"TYPE","xmlhttp"),t.o&&t.s&&xl(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=ka(ln(e)),n.s=null,n.U=!0,Lm(n,t)}P.ab=function(){this.v!=null&&(this.v=null,Na(this),Cl(this),lt(19))};function zo(t){t.v!=null&&(V.clearTimeout(t.v),t.v=null)}function og(t,e){var n=null;if(t.g==e){zo(t),kl(t),t.g=null;var r=2}else if(sc(t.i,e))n=e.D,Wm(t.i,e),r=1;else return;if(t.I=e.N,t.G!=0){if(e.i)if(r==1){n=e.s?e.s.length:0,e=Date.now()-e.F;var s=t.C;r=Sa(),ze(r,new Rm(r,n,e,s)),Ra(t)}else sg(t);else if(s=e.o,s==3||s==0&&0<t.I||!(r==1&&Ex(t,e)||r==2&&Cl(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),s){case 1:Qn(t,5);break;case 4:Qn(t,10);break;case 3:Qn(t,6);break;default:Qn(t,2)}}}function ag(t,e){let n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function Qn(t,e){if(t.h.info("Error code "+e),e==2){var n=null;t.j&&(n=null);var r=He(t.jb,t);n||(n=new cr("//www.google.com/images/cleardot.gif"),V.location&&V.location.protocol=="http"||Ko(n,"https"),ka(n)),mx(n.toString(),r)}else lt(2);t.G=0,t.j&&t.j.va(e),ug(t),ng(t)}P.jb=function(t){t?(this.h.info("Successfully pinged google.com"),lt(2)):(this.h.info("Failed to ping google.com"),lt(1))};function ug(t){t.G=0,t.I=-1,t.j&&((Qm(t.i).length!=0||t.l.length!=0)&&(t.i.i.length=0,al(t.l),t.l.length=0),t.j.ua())}function cg(t,e,n){let r=rx(n);if(r.i!="")e&&Go(r,e+"."+r.i),Ho(r,r.m);else{const s=V.location;r=sx(s.protocol,e?e+"."+s.hostname:s.hostname,+s.port,n)}return t.aa&&ul(t.aa,function(s,i){we(r,i,s)}),e=t.D,n=t.sa,e&&n&&we(r,e,n),we(r,"VER",t.ma),qi(t,r),r}function lg(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Ba&&!t.qa?new Oe(new Fi({ib:!0})):new Oe(t.qa),e.L=t.H,e}function hg(){}P=hg.prototype;P.xa=function(){};P.wa=function(){};P.va=function(){};P.ua=function(){};P.Oa=function(){};function Wo(){if(ns&&!(10<=Number(MS)))throw Error("Environmental error: no available transport.")}Wo.prototype.g=function(t,e){return new It(t,e)};function It(t,e){$e.call(this),this.g=new tg(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!Bo(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Bo(e)&&(this.g.D=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Is(this)}Ye(It,$e);It.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),ml(He(t.hb,t,e))),lt(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=cg(t,null,t.W),Ra(t)};It.prototype.close=function(){Al(this.g)};It.prototype.u=function(t){if(typeof t=="string"){var e={};e.__data__=t,wu(this.g,e)}else this.v?(e={},e.__data__=pl(t),wu(this.g,e)):wu(this.g,t)};It.prototype.M=function(){this.g.j=null,delete this.j,Al(this.g),delete this.g,It.Z.M.call(this)};function fg(t){wl.call(this);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}Ye(fg,wl);function dg(){_l.call(this),this.status=1}Ye(dg,_l);function Is(t){this.g=t}Ye(Is,hg);Is.prototype.xa=function(){ze(this.g,"a")};Is.prototype.wa=function(t){ze(this.g,new fg(t))};Is.prototype.va=function(t){ze(this.g,new dg(t))};Is.prototype.ua=function(){ze(this.g,"b")};Wo.prototype.createWebChannel=Wo.prototype.g;It.prototype.send=It.prototype.u;It.prototype.open=It.prototype.m;It.prototype.close=It.prototype.close;xa.NO_ERROR=0;xa.TIMEOUT=8;xa.HTTP_ERROR=6;Pm.COMPLETE="complete";Mm.EventType=Ri;Ri.OPEN="a";Ri.CLOSE="b";Ri.ERROR="c";Ri.MESSAGE="d";$e.prototype.listen=$e.prototype.N;Oe.prototype.listenOnce=Oe.prototype.O;Oe.prototype.getLastError=Oe.prototype.La;Oe.prototype.getLastErrorCode=Oe.prototype.Da;Oe.prototype.getStatus=Oe.prototype.ba;Oe.prototype.getResponseJson=Oe.prototype.Qa;Oe.prototype.getResponseText=Oe.prototype.ga;Oe.prototype.send=Oe.prototype.ea;var Tx=function(){return new Wo},Ix=function(){return Sa()},_u=xa,Sx=Pm,xx=br,$f={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},Ax=Fi,lo=Mm,Cx=Oe;const Uf="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ve.UNAUTHENTICATED=new Ve(null),Ve.GOOGLE_CREDENTIALS=new Ve("google-credentials-uid"),Ve.FIRST_PARTY=new Ve("first-party-uid"),Ve.MOCK_USER=new Ve("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ss="9.6.7";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rn=new Zc("@firebase/firestore");function ic(){return Rn.logLevel}function kx(t){Rn.setLogLevel(t)}function S(t,...e){if(Rn.logLevel<=re.DEBUG){const n=e.map(Ol);Rn.debug(`Firestore (${Ss}): ${t}`,...n)}}function Ae(t,...e){if(Rn.logLevel<=re.ERROR){const n=e.map(Ol);Rn.error(`Firestore (${Ss}): ${t}`,...n)}}function di(t,...e){if(Rn.logLevel<=re.WARN){const n=e.map(Ol);Rn.warn(`Firestore (${Ss}): ${t}`,...n)}}function Ol(t){if(typeof t=="string")return t;try{return e=t,JSON.stringify(e)}catch{return t}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L(t="Unexpected state"){const e=`FIRESTORE (${Ss}) INTERNAL ASSERTION FAILED: `+t;throw Ae(e),new Error(e)}function j(t,e){t||L()}function Ox(t,e){t||L()}function D(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class E extends Ci{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pg{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Dx{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ve.UNAUTHENTICATED))}shutdown(){}}class Nx{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class Rx{constructor(e){this.t=e,this.currentUser=Ve.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new Fe;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Fe,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},a=u=>{S("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(u=>a(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?a(u):(S("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Fe)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(S("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(j(typeof r.accessToken=="string"),new pg(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return j(e===null||typeof e=="string"),new Ve(e)}}class Px{constructor(e,n,r){this.type="FirstParty",this.user=Ve.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",n);const s=e.auth.getAuthHeaderValueForFirstParty([]);s&&this.headers.set("Authorization",s),r&&this.headers.set("X-Goog-Iam-Authorization-Token",r)}}class Mx{constructor(e,n,r){this.h=e,this.l=n,this.m=r}getToken(){return Promise.resolve(new Px(this.h,this.l,this.m))}start(e,n){e.enqueueRetryable(()=>n(Ve.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Fx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Lx{constructor(e){this.g=e,this.forceRefresh=!1,this.appCheck=null,this.p=null}start(e,n){const r=i=>{i.error!=null&&S("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.p;return this.p=i.token,S("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{S("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.g.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.g.getImmediate({optional:!0});i?s(i):S("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(j(typeof n.token=="string"),this.p=n.token,new Fx(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bt{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.I(r),this.T=r=>n.writeSequenceNumber(r))}I(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.T&&this.T(e),e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qx(t){const e=typeof self!="undefined"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */bt.A=-1;class mg{static R(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=qx(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function Y(t,e){return t<e?-1:t>e?1:0}function rs(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function gg(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Le{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new E(y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new E(y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new E(y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new E(y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Le.fromMillis(Date.now())}static fromDate(e){return Le.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Le(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Y(this.nanoseconds,e.nanoseconds):Y(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B{constructor(e){this.timestamp=e}static fromTimestamp(e){return new B(e)}static min(){return new B(new Le(0,0))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bf(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Er(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function yg(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(e,n,r){n===void 0?n=0:n>e.length&&L(),r===void 0?r=e.length-n:r>e.length-n&&L(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return pi.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof pi?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class se extends pi{construct(e,n,r){return new se(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new E(y.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new se(n)}static emptyPath(){return new se([])}}const $x=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Pe extends pi{construct(e,n,r){return new Pe(e,n,r)}static isValidIdentifier(e){return $x.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Pe.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Pe(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new E(y.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new E(y.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new E(y.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new E(y.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Pe(n)}static emptyPath(){return new Pe([])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(e){this.fields=e,e.sort(Pe.comparator)}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return rs(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ux(){return typeof atob!="undefined"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{constructor(e){this.binaryString=e}static fromBase64String(e){const n=atob(e);return new De(n)}static fromUint8Array(e){const n=function(r){let s="";for(let i=0;i<r.length;++i)s+=String.fromCharCode(r[i]);return s}(e);return new De(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Y(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}De.EMPTY_BYTE_STRING=new De("");const Bx=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Pn(t){if(j(!!t),typeof t=="string"){let e=0;const n=Bx.exec(t);if(j(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Te(t.seconds),nanos:Te(t.nanos)}}function Te(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function lr(t){return typeof t=="string"?De.fromBase64String(t):De.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dl(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function vg(t){const e=t.mapValue.fields.__previous_value__;return Dl(e)?vg(e):e}function mi(t){const e=Pn(t.mapValue.fields.__local_write_time__.timestampValue);return new Le(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jx{constructor(e,n,r,s,i,o,a,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=u}}class hr{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new hr("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof hr&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tr(t){return t==null}function gi(t){return t===0&&1/t==-1/0}function wg(t){return typeof t=="number"&&Number.isInteger(t)&&!gi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R{constructor(e){this.path=e}static fromPath(e){return new R(se.fromString(e))}static fromName(e){return new R(se.fromString(e).popFirst(5))}static empty(){return new R(se.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&se.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return se.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new R(new se(e.slice()))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vx={mapValue:{fields:{__type__:{stringValue:"__max___"}}}};function fr(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Dl(t)?4:10:L()}function $t(t,e){if(t===e)return!0;const n=fr(t);if(n!==fr(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return mi(t).isEqual(mi(e));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const i=Pn(r.timestampValue),o=Pn(s.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(r,s){return lr(r.bytesValue).isEqual(lr(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(r,s){return Te(r.geoPointValue.latitude)===Te(s.geoPointValue.latitude)&&Te(r.geoPointValue.longitude)===Te(s.geoPointValue.longitude)}(t,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return Te(r.integerValue)===Te(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const i=Te(r.doubleValue),o=Te(s.doubleValue);return i===o?gi(i)===gi(o):isNaN(i)&&isNaN(o)}return!1}(t,e);case 9:return rs(t.arrayValue.values||[],e.arrayValue.values||[],$t);case 10:return function(r,s){const i=r.mapValue.fields||{},o=s.mapValue.fields||{};if(Bf(i)!==Bf(o))return!1;for(const a in i)if(i.hasOwnProperty(a)&&(o[a]===void 0||!$t(i[a],o[a])))return!1;return!0}(t,e);default:return L()}}function yi(t,e){return(t.values||[]).find(n=>$t(n,e))!==void 0}function is(t,e){if(t===e)return 0;const n=fr(t),r=fr(e);if(n!==r)return Y(n,r);switch(n){case 0:return 0;case 1:return Y(t.booleanValue,e.booleanValue);case 2:return function(s,i){const o=Te(s.integerValue||s.doubleValue),a=Te(i.integerValue||i.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(t,e);case 3:return jf(t.timestampValue,e.timestampValue);case 4:return jf(mi(t),mi(e));case 5:return Y(t.stringValue,e.stringValue);case 6:return function(s,i){const o=lr(s),a=lr(i);return o.compareTo(a)}(t.bytesValue,e.bytesValue);case 7:return function(s,i){const o=s.split("/"),a=i.split("/");for(let u=0;u<o.length&&u<a.length;u++){const c=Y(o[u],a[u]);if(c!==0)return c}return Y(o.length,a.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,i){const o=Y(Te(s.latitude),Te(i.latitude));return o!==0?o:Y(Te(s.longitude),Te(i.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,i){const o=s.values||[],a=i.values||[];for(let u=0;u<o.length&&u<a.length;++u){const c=is(o[u],a[u]);if(c)return c}return Y(o.length,a.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,i){const o=s.fields||{},a=Object.keys(o),u=i.fields||{},c=Object.keys(u);a.sort(),c.sort();for(let l=0;l<a.length&&l<c.length;++l){const h=Y(a[l],c[l]);if(h!==0)return h;const f=is(o[a[l]],u[c[l]]);if(f!==0)return f}return Y(a.length,c.length)}(t.mapValue,e.mapValue);default:throw L()}}function jf(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Y(t,e);const n=Pn(t),r=Pn(e),s=Y(n.seconds,r.seconds);return s!==0?s:Y(n.nanos,r.nanos)}function Yr(t){return oc(t)}function oc(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const s=Pn(r);return`time(${s.seconds},${s.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?lr(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,R.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(r){let s="[",i=!0;for(const o of r.values||[])i?i=!1:s+=",",s+=oc(o);return s+"]"}(t.arrayValue):"mapValue"in t?function(r){const s=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const a of s)o?o=!1:i+=",",i+=`${a}:${oc(r.fields[a])}`;return i+"}"}(t.mapValue):L();var e,n}function Qo(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function ac(t){return!!t&&"integerValue"in t}function Pa(t){return!!t&&"arrayValue"in t}function Vf(t){return!!t&&"nullValue"in t}function Kf(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Io(t){return!!t&&"mapValue"in t}function Ws(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Er(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Ws(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ws(t.arrayValue.values[n]);return e}return Object.assign({},t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class et{constructor(e){this.value=e}static empty(){return new et({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Io(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ws(n)}setAll(e){let n=Pe.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=Ws(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Io(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return $t(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Io(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Er(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new et(Ws(this.value))}}function _g(t){const e=[];return Er(t.fields,(n,r)=>{const s=new Pe([n]);if(Io(r)){const i=_g(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new ss(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class be{constructor(e,n,r,s,i,o){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.data=i,this.documentState=o}static newInvalidDocument(e){return new be(e,0,B.min(),B.min(),et.empty(),0)}static newFoundDocument(e,n,r){return new be(e,1,n,B.min(),r,0)}static newNoDocument(e,n){return new be(e,2,n,B.min(),et.empty(),0)}static newUnknownDocument(e,n){return new be(e,3,n,B.min(),et.empty(),2)}convertToFoundDocument(e,n){return this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=et.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=et.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof be&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new be(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class bg{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}bg.UNKNOWN_ID=-1;class Kx{constructor(e,n){this.fieldPath=e,this.kind=n}}class Yo{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Yo(0,Ma.min())}}class Ma{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Ma(B.min(),R.empty(),-1)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gx{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.P=null}}function Gf(t,e=null,n=[],r=[],s=null,i=null,o=null){return new Gx(t,e,n,r,s,i,o)}function $i(t){const e=D(t);if(e.P===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>{return(s=r).field.canonicalString()+s.op.toString()+Yr(s.value);var s}).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Tr(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Yr(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Yr(r)).join(",")),e.P=n}return e.P}function Hx(t){let e=t.path.canonicalString();return t.collectionGroup!==null&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map(n=>{return`${(r=n).field.canonicalString()} ${r.op} ${Yr(r.value)}`;var r}).join(", ")}]`),Tr(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map(n=>function(r){return`${r.field.canonicalString()} (${r.dir})`}(n)).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(n=>Yr(n)).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(n=>Yr(n)).join(",")),`Target(${e})`}function Fa(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let s=0;s<t.orderBy.length;s++)if(!eA(t.orderBy[s],e.orderBy[s]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let s=0;s<t.filters.length;s++)if(n=t.filters[s],r=e.filters[s],n.op!==r.op||!n.field.isEqual(r.field)||!$t(n.value,r.value))return!1;var n,r;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!zf(t.startAt,e.startAt)&&zf(t.endAt,e.endAt)}function Jo(t){return R.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class ht extends class{}{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.v(e,n,r):new zx(e,n,r):n==="array-contains"?new Yx(e,r):n==="in"?new Jx(e,r):n==="not-in"?new Xx(e,r):n==="array-contains-any"?new Zx(e,r):new ht(e,n,r)}static v(e,n,r){return n==="in"?new Wx(e,r):new Qx(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.V(is(n,this.value)):n!==null&&fr(this.value)===fr(n)&&this.V(is(n,this.value))}V(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return L()}}S(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class zx extends ht{constructor(e,n,r){super(e,n,r),this.key=R.fromName(r.referenceValue)}matches(e){const n=R.comparator(e.key,this.key);return this.V(n)}}class Wx extends ht{constructor(e,n){super(e,"in",n),this.keys=Eg("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class Qx extends ht{constructor(e,n){super(e,"not-in",n),this.keys=Eg("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Eg(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>R.fromName(r.referenceValue))}class Yx extends ht{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Pa(n)&&yi(n.arrayValue,this.value)}}class Jx extends ht{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&yi(this.value.arrayValue,n)}}class Xx extends ht{constructor(e,n){super(e,"not-in",n)}matches(e){if(yi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!yi(this.value.arrayValue,n)}}class Zx extends ht{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Pa(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>yi(this.value.arrayValue,r))}}class os{constructor(e,n){this.position=e,this.inclusive=n}}class Jr{constructor(e,n="asc"){this.field=e,this.dir=n}}function eA(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function Hf(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=R.comparator(R.fromName(o.referenceValue),n.key):r=is(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function zf(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!$t(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=u,this.D=null,this.C=null,this.startAt,this.endAt}}function Tg(t,e,n,r,s,i,o,a){return new dn(t,e,n,r,s,i,o,a)}function xs(t){return new dn(t)}function So(t){return!Tr(t.limit)&&t.limitType==="F"}function Xo(t){return!Tr(t.limit)&&t.limitType==="L"}function Nl(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function Rl(t){for(const e of t.filters)if(e.S())return e.field;return null}function Pl(t){return t.collectionGroup!==null}function as(t){const e=D(t);if(e.D===null){e.D=[];const n=Rl(e),r=Nl(e);if(n!==null&&r===null)n.isKeyField()||e.D.push(new Jr(n)),e.D.push(new Jr(Pe.keyField(),"asc"));else{let s=!1;for(const i of e.explicitOrderBy)e.D.push(i),i.field.isKeyField()&&(s=!0);if(!s){const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.D.push(new Jr(Pe.keyField(),i))}}}return e.D}function Dt(t){const e=D(t);if(!e.C)if(e.limitType==="F")e.C=Gf(e.path,e.collectionGroup,as(e),e.filters,e.limit,e.startAt,e.endAt);else{const n=[];for(const i of as(e)){const o=i.dir==="desc"?"asc":"desc";n.push(new Jr(i.field,o))}const r=e.endAt?new os(e.endAt.position,!e.endAt.inclusive):null,s=e.startAt?new os(e.startAt.position,!e.startAt.inclusive):null;e.C=Gf(e.path,e.collectionGroup,n,e.filters,e.limit,r,s)}return e.C}function Ig(t,e,n){return new dn(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ui(t,e){return Fa(Dt(t),Dt(e))&&t.limitType===e.limitType}function Sg(t){return`${$i(Dt(t))}|lt:${t.limitType}`}function uc(t){return`Query(target=${Hx(Dt(t))}; limitType=${t.limitType})`}function Ml(t,e){return e.isFoundDocument()&&function(n,r){const s=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):R.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,r){for(const s of n.explicitOrderBy)if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,r){for(const s of n.filters)if(!s.matches(r))return!1;return!0}(t,e)&&function(n,r){return!(n.startAt&&!function(s,i,o){const a=Hf(s,i,o);return s.inclusive?a<=0:a<0}(n.startAt,as(n),r)||n.endAt&&!function(s,i,o){const a=Hf(s,i,o);return s.inclusive?a>=0:a>0}(n.endAt,as(n),r))}(t,e)}function xg(t){return(e,n)=>{let r=!1;for(const s of as(t)){const i=tA(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function tA(t,e,n){const r=t.field.isKeyField()?R.comparator(e.key,n.key):function(s,i,o){const a=i.data.field(s),u=o.data.field(s);return a!==null&&u!==null?is(a,u):L()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return L()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ag(t,e){if(t.N){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:gi(e)?"-0":e}}function Cg(t){return{integerValue:""+t}}function kg(t,e){return wg(e)?Cg(e):Ag(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class La{constructor(){this._=void 0}}function nA(t,e,n){return t instanceof us?function(r,s){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&(i.fields.__previous_value__=s),{mapValue:i}}(n,e):t instanceof dr?Dg(t,e):t instanceof pr?Ng(t,e):function(r,s){const i=Og(r,s),o=Wf(i)+Wf(r.k);return ac(i)&&ac(r.k)?Cg(o):Ag(r.O,o)}(t,e)}function rA(t,e,n){return t instanceof dr?Dg(t,e):t instanceof pr?Ng(t,e):n}function Og(t,e){return t instanceof cs?ac(n=e)||function(r){return!!r&&"doubleValue"in r}(n)?e:{integerValue:0}:null;var n}class us extends La{}class dr extends La{constructor(e){super(),this.elements=e}}function Dg(t,e){const n=Rg(e);for(const r of t.elements)n.some(s=>$t(s,r))||n.push(r);return{arrayValue:{values:n}}}class pr extends La{constructor(e){super(),this.elements=e}}function Ng(t,e){let n=Rg(e);for(const r of t.elements)n=n.filter(s=>!$t(s,r));return{arrayValue:{values:n}}}class cs extends La{constructor(e,n){super(),this.O=e,this.k=n}}function Wf(t){return Te(t.integerValue||t.doubleValue)}function Rg(t){return Pa(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi{constructor(e,n){this.field=e,this.transform=n}}function sA(t,e){return t.field.isEqual(e.field)&&function(n,r){return n instanceof dr&&r instanceof dr||n instanceof pr&&r instanceof pr?rs(n.elements,r.elements,$t):n instanceof cs&&r instanceof cs?$t(n.k,r.k):n instanceof us&&r instanceof us}(t.transform,e.transform)}class iA{constructor(e,n){this.version=e,this.transformResults=n}}class Ce{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Ce}static exists(e){return new Ce(void 0,e)}static updateTime(e){return new Ce(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function xo(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class qa{}function oA(t,e,n){t instanceof ji?function(r,s,i){const o=r.value.clone(),a=Jf(r.fieldTransforms,s,i.transformResults);o.setAll(a),s.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(t,e,n):t instanceof Ir?function(r,s,i){if(!xo(r.precondition,s))return void s.convertToUnknownDocument(i.version);const o=Jf(r.fieldTransforms,s,i.transformResults),a=s.data;a.setAll(Pg(r)),a.setAll(o),s.convertToFoundDocument(i.version,a).setHasCommittedMutations()}(t,e,n):function(r,s,i){s.convertToNoDocument(i.version).setHasCommittedMutations()}(0,e,n)}function cc(t,e,n){t instanceof ji?function(r,s,i){if(!xo(r.precondition,s))return;const o=r.value.clone(),a=Xf(r.fieldTransforms,i,s);o.setAll(a),s.convertToFoundDocument(Yf(s),o).setHasLocalMutations()}(t,e,n):t instanceof Ir?function(r,s,i){if(!xo(r.precondition,s))return;const o=Xf(r.fieldTransforms,i,s),a=s.data;a.setAll(Pg(r)),a.setAll(o),s.convertToFoundDocument(Yf(s),a).setHasLocalMutations()}(t,e,n):function(r,s){xo(r.precondition,s)&&s.convertToNoDocument(B.min())}(t,e)}function aA(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=Og(r.transform,s||null);i!=null&&(n==null&&(n=et.empty()),n.set(r.field,i))}return n||null}function Qf(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&rs(n,r,(s,i)=>sA(s,i))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function Yf(t){return t.isFoundDocument()?t.version:B.min()}class ji extends qa{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}}class Ir extends qa{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}}function Pg(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Jf(t,e,n){const r=new Map;j(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,rA(o,a,n[s]))}return r}function Xf(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,nA(i,o,e))}return r}class Vi extends qa{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}}class Fl extends qa{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uA{constructor(e){this.count=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xe,X;function Mg(t){switch(t){default:return L();case y.CANCELLED:case y.UNKNOWN:case y.DEADLINE_EXCEEDED:case y.RESOURCE_EXHAUSTED:case y.INTERNAL:case y.UNAVAILABLE:case y.UNAUTHENTICATED:return!1;case y.INVALID_ARGUMENT:case y.NOT_FOUND:case y.ALREADY_EXISTS:case y.PERMISSION_DENIED:case y.FAILED_PRECONDITION:case y.ABORTED:case y.OUT_OF_RANGE:case y.UNIMPLEMENTED:case y.DATA_LOSS:return!0}}function Fg(t){if(t===void 0)return Ae("GRPC error has no .code"),y.UNKNOWN;switch(t){case xe.OK:return y.OK;case xe.CANCELLED:return y.CANCELLED;case xe.UNKNOWN:return y.UNKNOWN;case xe.DEADLINE_EXCEEDED:return y.DEADLINE_EXCEEDED;case xe.RESOURCE_EXHAUSTED:return y.RESOURCE_EXHAUSTED;case xe.INTERNAL:return y.INTERNAL;case xe.UNAVAILABLE:return y.UNAVAILABLE;case xe.UNAUTHENTICATED:return y.UNAUTHENTICATED;case xe.INVALID_ARGUMENT:return y.INVALID_ARGUMENT;case xe.NOT_FOUND:return y.NOT_FOUND;case xe.ALREADY_EXISTS:return y.ALREADY_EXISTS;case xe.PERMISSION_DENIED:return y.PERMISSION_DENIED;case xe.FAILED_PRECONDITION:return y.FAILED_PRECONDITION;case xe.ABORTED:return y.ABORTED;case xe.OUT_OF_RANGE:return y.OUT_OF_RANGE;case xe.UNIMPLEMENTED:return y.UNIMPLEMENTED;case xe.DATA_LOSS:return y.DATA_LOSS;default:return L()}}(X=xe||(xe={}))[X.OK=0]="OK",X[X.CANCELLED=1]="CANCELLED",X[X.UNKNOWN=2]="UNKNOWN",X[X.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",X[X.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",X[X.NOT_FOUND=5]="NOT_FOUND",X[X.ALREADY_EXISTS=6]="ALREADY_EXISTS",X[X.PERMISSION_DENIED=7]="PERMISSION_DENIED",X[X.UNAUTHENTICATED=16]="UNAUTHENTICATED",X[X.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",X[X.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",X[X.ABORTED=10]="ABORTED",X[X.OUT_OF_RANGE=11]="OUT_OF_RANGE",X[X.UNIMPLEMENTED=12]="UNIMPLEMENTED",X[X.INTERNAL=13]="INTERNAL",X[X.UNAVAILABLE=14]="UNAVAILABLE",X[X.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Se{constructor(e,n){this.comparator=e,this.root=n||Ke.EMPTY}insert(e,n){return new Se(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ke.BLACK,null,null))}remove(e){return new Se(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ke.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ho(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ho(this.root,e,this.comparator,!1)}getReverseIterator(){return new ho(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ho(this.root,e,this.comparator,!0)}}class ho{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ke{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r!=null?r:Ke.RED,this.left=s!=null?s:Ke.EMPTY,this.right=i!=null?i:Ke.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Ke(e!=null?e:this.key,n!=null?n:this.value,r!=null?r:this.color,s!=null?s:this.left,i!=null?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Ke.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Ke.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ke.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ke.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw L();const e=this.left.check();if(e!==this.right.check())throw L();return e+(this.isRed()?0:1)}}Ke.EMPTY=null,Ke.RED=!0,Ke.BLACK=!1;Ke.EMPTY=new class{constructor(){this.size=0}get key(){throw L()}get value(){throw L()}get color(){throw L()}get left(){throw L()}get right(){throw L()}copy(t,e,n,r,s){return this}insert(t,e,n){return new Ke(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _e{constructor(e){this.comparator=e,this.data=new Se(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Zf(this.data.getIterator())}getIteratorFrom(e){return new Zf(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof _e)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new _e(this.comparator);return n.data=e,n}}class Zf{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Fr(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cA=new Se(R.comparator);function Ot(){return cA}const lA=new Se(R.comparator);function lc(){return lA}const hA=new Se(R.comparator),fA=new _e(R.comparator);function ae(...t){let e=fA;for(const n of t)e=e.add(n);return e}const dA=new _e(Y);function $a(){return dA}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n){const r=new Map;return r.set(e,Gi.createSynthesizedTargetChangeForCurrentChange(e,n)),new Ki(B.min(),r,$a(),Ot(),ae())}}class Gi{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n){return new Gi(De.EMPTY_BYTE_STRING,n,ae(),ae(),ae())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao{constructor(e,n,r,s){this.M=e,this.removedTargetIds=n,this.key=r,this.$=s}}class Lg{constructor(e,n){this.targetId=e,this.F=n}}class qg{constructor(e,n,r=De.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class ed{constructor(){this.B=0,this.L=nd(),this.U=De.EMPTY_BYTE_STRING,this.q=!1,this.K=!0}get current(){return this.q}get resumeToken(){return this.U}get G(){return this.B!==0}get j(){return this.K}W(e){e.approximateByteSize()>0&&(this.K=!0,this.U=e)}H(){let e=ae(),n=ae(),r=ae();return this.L.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:L()}}),new Gi(this.U,this.q,e,n,r)}J(){this.K=!1,this.L=nd()}Y(e,n){this.K=!0,this.L=this.L.insert(e,n)}X(e){this.K=!0,this.L=this.L.remove(e)}Z(){this.B+=1}tt(){this.B-=1}et(){this.K=!0,this.q=!0}}class pA{constructor(e){this.nt=e,this.st=new Map,this.it=Ot(),this.rt=td(),this.ot=new _e(Y)}ct(e){for(const n of e.M)e.$&&e.$.isFoundDocument()?this.ut(n,e.$):this.at(n,e.key,e.$);for(const n of e.removedTargetIds)this.at(n,e.key,e.$)}ht(e){this.forEachTarget(e,n=>{const r=this.lt(n);switch(e.state){case 0:this.ft(n)&&r.W(e.resumeToken);break;case 1:r.tt(),r.G||r.J(),r.W(e.resumeToken);break;case 2:r.tt(),r.G||this.removeTarget(n);break;case 3:this.ft(n)&&(r.et(),r.W(e.resumeToken));break;case 4:this.ft(n)&&(this.dt(n),r.W(e.resumeToken));break;default:L()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.st.forEach((r,s)=>{this.ft(s)&&n(s)})}_t(e){const n=e.targetId,r=e.F.count,s=this.wt(n);if(s){const i=s.target;if(Jo(i))if(r===0){const o=new R(i.path);this.at(n,o,be.newNoDocument(o,B.min()))}else j(r===1);else this.gt(n)!==r&&(this.dt(n),this.ot=this.ot.add(n))}}yt(e){const n=new Map;this.st.forEach((i,o)=>{const a=this.wt(o);if(a){if(i.current&&Jo(a.target)){const u=new R(a.target.path);this.it.get(u)!==null||this.It(o,u)||this.at(o,u,be.newNoDocument(u,e))}i.j&&(n.set(o,i.H()),i.J())}});let r=ae();this.rt.forEach((i,o)=>{let a=!0;o.forEachWhile(u=>{const c=this.wt(u);return!c||c.purpose===2||(a=!1,!1)}),a&&(r=r.add(i))}),this.it.forEach((i,o)=>o.setReadTime(e));const s=new Ki(e,n,this.ot,this.it,r);return this.it=Ot(),this.rt=td(),this.ot=new _e(Y),s}ut(e,n){if(!this.ft(e))return;const r=this.It(e,n.key)?2:0;this.lt(e).Y(n.key,r),this.it=this.it.insert(n.key,n),this.rt=this.rt.insert(n.key,this.Et(n.key).add(e))}at(e,n,r){if(!this.ft(e))return;const s=this.lt(e);this.It(e,n)?s.Y(n,1):s.X(n),this.rt=this.rt.insert(n,this.Et(n).delete(e)),r&&(this.it=this.it.insert(n,r))}removeTarget(e){this.st.delete(e)}gt(e){const n=this.lt(e).H();return this.nt.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Z(e){this.lt(e).Z()}lt(e){let n=this.st.get(e);return n||(n=new ed,this.st.set(e,n)),n}Et(e){let n=this.rt.get(e);return n||(n=new _e(Y),this.rt=this.rt.insert(e,n)),n}ft(e){const n=this.wt(e)!==null;return n||S("WatchChangeAggregator","Detected inactive target",e),n}wt(e){const n=this.st.get(e);return n&&n.G?null:this.nt.Tt(e)}dt(e){this.st.set(e,new ed),this.nt.getRemoteKeysForTarget(e).forEach(n=>{this.at(e,n,null)})}It(e,n){return this.nt.getRemoteKeysForTarget(e).has(n)}}function td(){return new Se(R.comparator)}function nd(){return new Se(R.comparator)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mA=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),gA=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))();class yA{constructor(e,n){this.databaseId=e,this.N=n}}function vi(t,e){return t.N?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function $g(t,e){return t.N?e.toBase64():e.toUint8Array()}function vA(t,e){return vi(t,e.toTimestamp())}function qe(t){return j(!!t),B.fromTimestamp(function(e){const n=Pn(e);return new Le(n.seconds,n.nanos)}(t))}function Ll(t,e){return function(n){return new se(["projects",n.projectId,"databases",n.database])}(t).child("documents").child(e).canonicalString()}function Ug(t){const e=se.fromString(t);return j(Wg(e)),e}function wi(t,e){return Ll(t.databaseId,e.path)}function Wt(t,e){const n=Ug(e);if(n.get(1)!==t.databaseId.projectId)throw new E(y.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new E(y.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new R(jg(n))}function hc(t,e){return Ll(t.databaseId,e)}function Bg(t){const e=Ug(t);return e.length===4?se.emptyPath():jg(e)}function _i(t){return new se(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function jg(t){return j(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function rd(t,e,n){return{name:wi(t,e),fields:n.value.mapValue.fields}}function Vg(t,e,n){const r=Wt(t,e.name),s=qe(e.updateTime),i=new et({mapValue:{fields:e.fields}}),o=be.newFoundDocument(r,s,i);return n&&o.setHasCommittedMutations(),n?o.setHasCommittedMutations():o}function wA(t,e){return"found"in e?function(n,r){j(!!r.found),r.found.name,r.found.updateTime;const s=Wt(n,r.found.name),i=qe(r.found.updateTime),o=new et({mapValue:{fields:r.found.fields}});return be.newFoundDocument(s,i,o)}(t,e):"missing"in e?function(n,r){j(!!r.missing),j(!!r.readTime);const s=Wt(n,r.missing),i=qe(r.readTime);return be.newNoDocument(s,i)}(t,e):L()}function _A(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:L()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,c){return u.N?(j(c===void 0||typeof c=="string"),De.fromBase64String(c||"")):(j(c===void 0||c instanceof Uint8Array),De.fromUint8Array(c||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const c=u.code===void 0?y.UNKNOWN:Fg(u.code);return new E(c,u.message||"")}(o);n=new qg(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Wt(t,r.document.name),i=qe(r.document.updateTime),o=new et({mapValue:{fields:r.document.fields}}),a=be.newFoundDocument(s,i,o),u=r.targetIds||[],c=r.removedTargetIds||[];n=new Ao(u,c,a.key,a)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Wt(t,r.document),i=r.readTime?qe(r.readTime):B.min(),o=be.newNoDocument(s,i),a=r.removedTargetIds||[];n=new Ao([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Wt(t,r.document),i=r.removedTargetIds||[];n=new Ao([],i,s,null)}else{if(!("filter"in e))return L();{e.filter;const r=e.filter;r.targetId;const s=r.count||0,i=new uA(s),o=r.targetId;n=new Lg(o,i)}}return n}function bi(t,e){let n;if(e instanceof ji)n={update:rd(t,e.key,e.value)};else if(e instanceof Vi)n={delete:wi(t,e.key)};else if(e instanceof Ir)n={update:rd(t,e.key,e.data),updateMask:AA(e.fieldMask)};else{if(!(e instanceof Fl))return L();n={verify:wi(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,i){const o=i.transform;if(o instanceof us)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof dr)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof pr)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof cs)return{fieldPath:i.field.canonicalString(),increment:o.k};throw L()}(0,r))),e.precondition.isNone||(n.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:vA(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:L()}(t,e.precondition)),n}function fc(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?Ce.updateTime(qe(s.updateTime)):s.exists!==void 0?Ce.exists(s.exists):Ce.none()}(e.currentDocument):Ce.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(i,o){let a=null;if("setToServerValue"in o)j(o.setToServerValue==="REQUEST_TIME"),a=new us;else if("appendMissingElements"in o){const c=o.appendMissingElements.values||[];a=new dr(c)}else if("removeAllFromArray"in o){const c=o.removeAllFromArray.values||[];a=new pr(c)}else"increment"in o?a=new cs(i,o.increment):L();const u=Pe.fromServerFormat(o.fieldPath);return new Bi(u,a)}(t,s)):[];if(e.update){e.update.name;const s=Wt(t,e.update.name),i=new et({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(a){const u=a.fieldPaths||[];return new ss(u.map(c=>Pe.fromServerFormat(c)))}(e.updateMask);return new Ir(s,i,o,n,r)}return new ji(s,i,n,r)}if(e.delete){const s=Wt(t,e.delete);return new Vi(s,n)}if(e.verify){const s=Wt(t,e.verify);return new Fl(s,n)}return L()}function bA(t,e){return t&&t.length>0?(j(e!==void 0),t.map(n=>function(r,s){let i=r.updateTime?qe(r.updateTime):qe(s);return i.isEqual(B.min())&&(i=qe(s)),new iA(i,r.transformResults||[])}(n,e))):[]}function Kg(t,e){return{documents:[hc(t,e.path)]}}function Gg(t,e){const n={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(n.parent=hc(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=hc(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const s=function(u){if(u.length===0)return;const c=u.map(l=>function(h){if(h.op==="=="){if(Kf(h.value))return{unaryFilter:{field:Lr(h.field),op:"IS_NAN"}};if(Vf(h.value))return{unaryFilter:{field:Lr(h.field),op:"IS_NULL"}}}else if(h.op==="!="){if(Kf(h.value))return{unaryFilter:{field:Lr(h.field),op:"IS_NOT_NAN"}};if(Vf(h.value))return{unaryFilter:{field:Lr(h.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Lr(h.field),op:IA(h.op),value:h.value}}}(l));return c.length===1?c[0]:{compositeFilter:{op:"AND",filters:c}}}(e.filters);s&&(n.structuredQuery.where=s);const i=function(u){if(u.length!==0)return u.map(c=>function(l){return{field:Lr(l.field),direction:TA(l.dir)}}(c))}(e.orderBy);i&&(n.structuredQuery.orderBy=i);const o=function(u,c){return u.N||Tr(c)?c:{value:c}}(t,e.limit);var a;return o!==null&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),n}function Hg(t){let e=Bg(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){j(r===1);const l=n.from[0];l.allDescendants?s=l.collectionId:e=e.child(l.collectionId)}let i=[];n.where&&(i=zg(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(l=>function(h){return new Jr(Gr(h.field),function(f){switch(f){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(h.direction))}(l)));let a=null;n.limit&&(a=function(l){let h;return h=typeof l=="object"?l.value:l,Tr(h)?null:h}(n.limit));let u=null;n.startAt&&(u=function(l){const h=!!l.before,f=l.values||[];return new os(f,h)}(n.startAt));let c=null;return n.endAt&&(c=function(l){const h=!l.before,f=l.values||[];return new os(f,h)}(n.endAt)),Tg(e,s,o,i,a,"F",u,c)}function EA(t,e){const n=function(r,s){switch(s){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return L()}}(0,e.purpose);return n==null?null:{"goog-listen-tags":n}}function zg(t){return t?t.unaryFilter!==void 0?[xA(t)]:t.fieldFilter!==void 0?[SA(t)]:t.compositeFilter!==void 0?t.compositeFilter.filters.map(e=>zg(e)).reduce((e,n)=>e.concat(n)):L():[]}function TA(t){return mA[t]}function IA(t){return gA[t]}function Lr(t){return{fieldPath:t.canonicalString()}}function Gr(t){return Pe.fromServerFormat(t.fieldPath)}function SA(t){return ht.create(Gr(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return L()}}(t.fieldFilter.op),t.fieldFilter.value)}function xA(t){switch(t.unaryFilter.op){case"IS_NAN":const e=Gr(t.unaryFilter.field);return ht.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=Gr(t.unaryFilter.field);return ht.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Gr(t.unaryFilter.field);return ht.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=Gr(t.unaryFilter.field);return ht.create(s,"!=",{nullValue:"NULL_VALUE"});default:return L()}}function AA(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Wg(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Me(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=sd(e)),e=CA(t.get(n),e);return sd(e)}function CA(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case"":n+="";break;default:n+=i}}return n}function sd(t){return t+""}function Gt(t){const e=t.length;if(j(e>=2),e===2)return j(t.charAt(0)===""&&t.charAt(1)===""),se.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const o=t.indexOf("",i);switch((o<0||o>n)&&L(),t.charAt(o+1)){case"":const a=t.substring(i,o);let u;s.length===0?u=a:(s+=a,u=s,s=""),r.push(u);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:L()}i=o+2}return new se(r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kA{constructor(e,n){this.seconds=e,this.nanoseconds=n}}class vt{constructor(e,n,r){this.ownerId=e,this.allowTabSynchronization=n,this.leaseTimestampMs=r}}vt.store="owner",vt.key="owner";class kn{constructor(e,n,r){this.userId=e,this.lastAcknowledgedBatchId=n,this.lastStreamToken=r}}kn.store="mutationQueues",kn.keyPath="userId";class ge{constructor(e,n,r,s,i){this.userId=e,this.batchId=n,this.localWriteTimeMs=r,this.baseMutations=s,this.mutations=i}}ge.store="mutations",ge.keyPath="batchId",ge.userMutationsIndex="userMutationsIndex",ge.userMutationsKeyPath=["userId","batchId"];class Xe{constructor(){}static prefixForUser(e){return[e]}static prefixForPath(e,n){return[e,Me(n)]}static key(e,n,r){return[e,Me(n),r]}}Xe.store="documentMutations",Xe.PLACEHOLDER=new Xe;class OA{constructor(e,n){this.path=e,this.readTime=n}}class DA{constructor(e,n){this.path=e,this.version=n}}class Ee{constructor(e,n,r,s,i,o){this.unknownDocument=e,this.noDocument=n,this.document=r,this.hasCommittedMutations=s,this.readTime=i,this.parentPath=o}}Ee.store="remoteDocuments",Ee.readTimeIndex="readTimeIndex",Ee.readTimeIndexPath="readTime",Ee.collectionReadTimeIndex="collectionReadTimeIndex",Ee.collectionReadTimeIndexPath=["parentPath","readTime"];class Ht{constructor(e){this.byteSize=e}}Ht.store="remoteDocumentGlobal",Ht.key="remoteDocumentGlobalKey";class gt{constructor(e,n,r,s,i,o,a){this.targetId=e,this.canonicalId=n,this.readTime=r,this.resumeToken=s,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=a}}gt.store="targets",gt.keyPath="targetId",gt.queryTargetsIndexName="queryTargetsIndex",gt.queryTargetsKeyPath=["canonicalId","targetId"];class Ge{constructor(e,n,r){this.targetId=e,this.path=n,this.sequenceNumber=r}}Ge.store="targetDocuments",Ge.keyPath=["targetId","path"],Ge.documentTargetsIndex="documentTargetsIndex",Ge.documentTargetsKeyPath=["path","targetId"];class wt{constructor(e,n,r,s){this.highestTargetId=e,this.highestListenSequenceNumber=n,this.lastRemoteSnapshotVersion=r,this.targetCount=s}}wt.key="targetGlobalKey",wt.store="targetGlobal";class tr{constructor(e,n){this.collectionId=e,this.parent=n}}tr.store="collectionParents",tr.keyPath=["collectionId","parent"];class an{constructor(e,n,r,s){this.clientId=e,this.updateTimeMs=n,this.networkEnabled=r,this.inForeground=s}}an.store="clientMetadata",an.keyPath="clientId";class ls{constructor(e,n,r){this.bundleId=e,this.createTime=n,this.version=r}}ls.store="bundles",ls.keyPath="bundleId";class hs{constructor(e,n,r){this.name=e,this.readTime=n,this.bundledQuery=r}}hs.store="namedQueries",hs.keyPath="name";class Et{constructor(e,n,r){this.indexId=e,this.collectionGroup=n,this.fields=r}}Et.store="indexConfiguration",Et.keyPath="indexId",Et.collectionGroupIndex="collectionGroupIndex",Et.collectionGroupIndexPath="collectionGroup";class At{constructor(e,n,r,s,i,o){this.indexId=e,this.uid=n,this.sequenceNumber=r,this.readTime=s,this.documentKey=i,this.largestBatchId=o}}At.store="indexState",At.keyPath=["indexId","uid"],At.sequenceNumberIndex="sequenceNumberIndex",At.sequenceNumberIndexPath=["uid","sequenceNumber"];class Ct{constructor(e,n,r,s,i){this.indexId=e,this.uid=n,this.arrayValue=r,this.directionalValue=s,this.documentKey=i}}Ct.store="indexEntries",Ct.keyPath=["indexId","uid","arrayValue","directionalValue","documentKey"],Ct.documentKeyIndex="documentKeyIndex",Ct.documentKeyIndexPath=["indexId","uid","documentKey"];class Re{constructor(e,n,r,s,i,o){this.userId=e,this.collectionPath=n,this.documentId=r,this.collectionGroup=s,this.largestBatchId=i,this.overlayMutation=o}}Re.store="documentOverlays",Re.keyPath=["userId","collectionPath","documentId"],Re.collectionPathOverlayIndex="collectionPathOverlayIndex",Re.collectionPathOverlayIndexPath=["userId","collectionPath","largestBatchId"],Re.collectionGroupOverlayIndex="collectionGroupOverlayIndex",Re.collectionGroupOverlayIndexPath=["userId","collectionGroup","largestBatchId"];const Qg=[kn.store,ge.store,Xe.store,Ee.store,gt.store,vt.store,wt.store,Ge.store,an.store,Ht.store,tr.store,ls.store,hs.store],Yg=[...Qg,Re.store],NA=[...Yg,Et.store,At.store,Ct.store];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jg="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Xg{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&L(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new v((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof v?n:v.resolve(n)}catch(n){return v.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):v.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):v.reject(n)}static resolve(e){return new v((n,r)=>{n(e)})}static reject(e){return new v((n,r)=>{r(e)})}static waitFor(e){return new v((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},u=>r(u))}),o=!0,i===s&&n()})}static or(e){let n=v.resolve(!1);for(const r of e)n=n.next(s=>s?v.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.At=new Fe,this.transaction.oncomplete=()=>{this.At.resolve()},this.transaction.onabort=()=>{n.error?this.At.reject(new Qs(e,n.error)):this.At.resolve()},this.transaction.onerror=r=>{const s=ql(r.target.error);this.At.reject(new Qs(e,s))}}static open(e,n,r,s){try{return new Ua(n,e.transaction(s,r))}catch(i){throw new Qs(n,i)}}get Rt(){return this.At.promise}abort(e){e&&this.At.reject(e),this.aborted||(S("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}Pt(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new PA(n)}}class Mt{constructor(e,n,r){this.name=e,this.version=n,this.bt=r,Mt.vt(sr())===12.2&&Ae("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return S("SimpleDb","Removing database:",e),Hn(window.indexedDB.deleteDatabase(e)).toPromise()}static Vt(){if(!nm())return!1;if(Mt.St())return!0;const e=sr(),n=Mt.vt(e),r=0<n&&n<10,s=Mt.Dt(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static St(){var e;return typeof process!="undefined"&&((e=process.env)===null||e===void 0?void 0:e.Ct)==="YES"}static Nt(e,n){return e.store(n)}static vt(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static Dt(e){const n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}async xt(e){return this.db||(S("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new Qs(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new E(y.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new E(y.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Qs(e,o))},s.onupgradeneeded=i=>{S("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.bt.kt(o,s.transaction,i.oldVersion,this.version).next(()=>{S("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.Ot&&(this.db.onversionchange=n=>this.Ot(n)),this.db}Mt(e){this.Ot=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.xt(e);const a=Ua.open(this.db,e,i?"readonly":"readwrite",r),u=s(a).next(c=>(a.Pt(),c)).catch(c=>(a.abort(c),v.reject(c))).toPromise();return u.catch(()=>{}),await a.Rt,u}catch(a){const u=a.name!=="FirebaseError"&&o<3;if(S("SimpleDb","Transaction failed with error:",a.message,"Retrying:",u),this.close(),!u)return Promise.reject(a)}}}close(){this.db&&this.db.close(),this.db=void 0}}class RA{constructor(e){this.$t=e,this.Ft=!1,this.Bt=null}get isDone(){return this.Ft}get Lt(){return this.Bt}set cursor(e){this.$t=e}done(){this.Ft=!0}Ut(e){this.Bt=e}delete(){return Hn(this.$t.delete())}}class Qs extends E{constructor(e,n){super(y.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Sr(t){return t.name==="IndexedDbTransactionError"}class PA{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(S("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(S("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Hn(r)}add(e){return S("SimpleDb","ADD",this.store.name,e,e),Hn(this.store.add(e))}get(e){return Hn(this.store.get(e)).next(n=>(n===void 0&&(n=null),S("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return S("SimpleDb","DELETE",this.store.name,e),Hn(this.store.delete(e))}count(){return S("SimpleDb","COUNT",this.store.name),Hn(this.store.count())}qt(e,n){const r=this.options(e,n);if(r.index||typeof this.store.getAll!="function"){const s=this.cursor(r),i=[];return this.Kt(s,(o,a)=>{i.push(a)}).next(()=>i)}{const s=this.store.getAll(r.range);return new v((i,o)=>{s.onerror=a=>{o(a.target.error)},s.onsuccess=a=>{i(a.target.result)}})}}Gt(e,n){S("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.jt=!1;const s=this.cursor(r);return this.Kt(s,(i,o,a)=>a.delete())}Qt(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.Kt(s,n)}Wt(e){const n=this.cursor({});return new v((r,s)=>{n.onerror=i=>{const o=ql(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}Kt(e,n){const r=[];return new v((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const u=new RA(a),c=n(a.primaryKey,a.value,u);if(c instanceof v){const l=c.catch(h=>(u.done(),v.reject(h)));r.push(l)}u.isDone?s():u.Lt===null?a.continue():a.continue(u.Lt)}}).next(()=>v.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.jt?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Hn(t){return new v((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=ql(r.target.error);n(s)}})}let id=!1;function ql(t){const e=Mt.vt(sr());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new E("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return id||(id=!0,setTimeout(()=>{throw r},0)),r}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od extends Xg{constructor(e,n){super(),this.zt=e,this.currentSequenceNumber=n}}function Ue(t,e){const n=D(t);return Mt.Nt(n.zt,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $l{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&oA(i,e,r[s])}}applyToLocalView(e){for(const n of this.baseMutations)n.key.isEqual(e.key)&&cc(n,e,this.localWriteTime);for(const n of this.mutations)n.key.isEqual(e.key)&&cc(n,e,this.localWriteTime)}applyToLocalDocumentSet(e){this.mutations.forEach(n=>{const r=e.get(n.key),s=r;this.applyToLocalView(s),r.isValidDocument()||s.convertToNoDocument(B.min())})}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ae())}isEqual(e){return this.batchId===e.batchId&&rs(this.mutations,e.mutations,(n,r)=>Qf(n,r))&&rs(this.baseMutations,e.baseMutations,(n,r)=>Qf(n,r))}}class Ul{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){j(e.mutations.length===r.length);let s=hA;const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Ul(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bl{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(e,n,r,s,i=B.min(),o=B.min(),a=De.EMPTY_BYTE_STRING){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}withSequenceNumber(e){return new On(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,n){return new On(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new On(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zg{constructor(e){this.Ht=e}}function ey(t,e){let n;if(e.document)n=Vg(t.Ht,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=R.fromSegments(e.noDocument.path),s=gr(e.noDocument.readTime);n=be.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return L();{const r=R.fromSegments(e.unknownDocument.path),s=gr(e.unknownDocument.version);n=be.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(Vl(e.readTime)),n}function ad(t,e){const n=jl(e.readTime),r=e.key.path.popLast().toArray();if(e.isFoundDocument()){const s=function(o,a){return{name:wi(o,a.key),fields:a.data.value.mapValue.fields,updateTime:vi(o,a.version.toTimestamp())}}(t.Ht,e),i=e.hasCommittedMutations;return new Ee(null,null,s,i,n,r)}if(e.isNoDocument()){const s=e.key.path.toArray(),i=mr(e.version),o=e.hasCommittedMutations;return new Ee(null,new OA(s,i),null,o,n,r)}if(e.isUnknownDocument()){const s=e.key.path.toArray(),i=mr(e.version);return new Ee(new DA(s,i),null,null,!0,n,r)}return L()}function jl(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Vl(t){const e=new Le(t[0],t[1]);return B.fromTimestamp(e)}function mr(t){const e=t.toTimestamp();return new kA(e.seconds,e.nanoseconds)}function gr(t){const e=new Le(t.seconds,t.nanoseconds);return B.fromTimestamp(e)}function Br(t,e){const n=(e.baseMutations||[]).map(i=>fc(t.Ht,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>fc(t.Ht,i)),s=Le.fromMillis(e.localWriteTimeMs);return new $l(e.batchId,s,n,r)}function Bs(t){const e=gr(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?gr(t.lastLimboFreeSnapshotVersion):B.min();let r;var s;return t.query.documents!==void 0?(j((s=t.query).documents.length===1),r=Dt(xs(Bg(s.documents[0])))):r=function(i){return Dt(Hg(i))}(t.query),new On(r,t.targetId,0,t.lastListenSequenceNumber,e,n,De.fromBase64String(t.resumeToken))}function ty(t,e){const n=mr(e.snapshotVersion),r=mr(e.lastLimboFreeSnapshotVersion);let s;s=Jo(e.target)?Kg(t.Ht,e.target):Gg(t.Ht,e.target);const i=e.resumeToken.toBase64();return new gt(e.targetId,$i(e.target),n,i,e.sequenceNumber,r,s)}function Kl(t){const e=Hg({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Ig(e,e.limit,"L"):e}function bu(t,e){return new Bl(e.largestBatchId,fc(t.Ht,e.overlayMutation))}function ud(t,e){const n=e.path.lastSegment();return[t,Me(e.path.popLast()),n]}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MA{getBundleMetadata(e,n){return cd(e).get(n).next(r=>{if(r)return{id:(s=r).bundleId,createTime:gr(s.createTime),version:s.version};var s})}saveBundleMetadata(e,n){return cd(e).put({bundleId:(r=n).id,createTime:mr(qe(r.createTime)),version:r.version});var r}getNamedQuery(e,n){return ld(e).get(n).next(r=>{if(r)return{name:(s=r).name,query:Kl(s.bundledQuery),readTime:gr(s.readTime)};var s})}saveNamedQuery(e,n){return ld(e).put(function(r){return{name:r.name,readTime:mr(qe(r.readTime)),bundledQuery:r.bundledQuery}}(n))}}function cd(t){return Ue(t,ls.store)}function ld(t){return Ue(t,hs.store)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gl{constructor(e,n){this.O=e,this.userId=n}static Jt(e,n){const r=n.uid||"";return new Gl(e,r)}getOverlay(e,n){return Fs(e).get(ud(this.userId,n)).next(r=>r?bu(this.O,r):null)}saveOverlays(e,n,r){const s=[];return r.forEach(i=>{const o=new Bl(n,i);s.push(this.Yt(e,o))}),v.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(o=>s.add(Me(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(Fs(e).Gt(Re.collectionPathOverlayIndex,a))}),v.waitFor(i)}getOverlaysForCollection(e,n,r){const s=new Map,i=Me(n),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Fs(e).qt(Re.collectionPathOverlayIndex,o).next(a=>{for(const u of a){const c=bu(this.O,u);s.set(c.getKey(),c)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=new Map;let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Fs(e).Qt({index:Re.collectionGroupOverlayIndex,range:a},(u,c,l)=>{const h=bu(this.O,c);i.size<s||h.largestBatchId===o?(i.set(h.getKey(),h),o=h.largestBatchId):l.done()}).next(()=>i)}Yt(e,n){return Fs(e).put(function(r,s,i){const[o,a,u]=ud(s,i.mutation.key);return new Re(s,a,u,i.mutation.key.getCollectionGroup(),i.largestBatchId,bi(r.Ht,i.mutation))}(this.O,this.userId,n))}}function Fs(t){return Ue(t,Re.store)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zo{constructor(){}Xt(e,n){this.Zt(e,n),n.te()}Zt(e,n){if("nullValue"in e)this.ee(n,5);else if("booleanValue"in e)this.ee(n,10),n.ne(e.booleanValue?1:0);else if("integerValue"in e)this.ee(n,15),n.ne(Te(e.integerValue));else if("doubleValue"in e){const r=Te(e.doubleValue);isNaN(r)?this.ee(n,13):(this.ee(n,15),gi(r)?n.ne(0):n.ne(r))}else if("timestampValue"in e){const r=e.timestampValue;this.ee(n,20),typeof r=="string"?n.se(r):(n.se(`${r.seconds||""}`),n.ne(r.nanos||0))}else if("stringValue"in e)this.ie(e.stringValue,n),this.re(n);else if("bytesValue"in e)this.ee(n,30),n.oe(lr(e.bytesValue)),this.re(n);else if("referenceValue"in e)this.ce(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.ee(n,45),n.ne(r.latitude||0),n.ne(r.longitude||0)}else"mapValue"in e?$t(e,Vx)?this.ee(n,Number.MAX_SAFE_INTEGER):(this.ue(e.mapValue,n),this.re(n)):"arrayValue"in e?(this.ae(e.arrayValue,n),this.re(n)):L()}ie(e,n){this.ee(n,25),this.he(e,n)}he(e,n){n.se(e)}ue(e,n){const r=e.fields||{};this.ee(n,55);for(const s of Object.keys(r))this.ie(s,n),this.Zt(r[s],n)}ae(e,n){const r=e.values||[];this.ee(n,50);for(const s of r)this.Zt(s,n)}ce(e,n){this.ee(n,37),R.fromName(e).path.forEach(r=>{this.ee(n,60),this.he(r,n)})}ee(e,n){e.ne(n)}re(e){e.ne(2)}}Zo.le=new Zo;function FA(t){if(t===0)return 8;let e=0;return t>>4==0&&(e+=4,t<<=4),t>>6==0&&(e+=2,t<<=2),t>>7==0&&(e+=1),e}function hd(t){const e=64-function(n){let r=0;for(let s=0;s<8;++s){const i=FA(255&n[s]);if(r+=i,i!==8)break}return r}(t);return Math.ceil(e/8)}class LA{constructor(){this.buffer=new Uint8Array(1024),this.position=0}fe(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.de(r.value),r=n.next();this._e()}we(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.me(r.value),r=n.next();this.ge()}ye(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.de(r);else if(r<2048)this.de(960|r>>>6),this.de(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.de(480|r>>>12),this.de(128|63&r>>>6),this.de(128|63&r);else{const s=n.codePointAt(0);this.de(240|s>>>18),this.de(128|63&s>>>12),this.de(128|63&s>>>6),this.de(128|63&s)}}this._e()}pe(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.me(r);else if(r<2048)this.me(960|r>>>6),this.me(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.me(480|r>>>12),this.me(128|63&r>>>6),this.me(128|63&r);else{const s=n.codePointAt(0);this.me(240|s>>>18),this.me(128|63&s>>>12),this.me(128|63&s>>>6),this.me(128|63&s)}}this.ge()}Ie(e){const n=this.Ee(e),r=hd(n);this.Te(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}Ae(e){const n=this.Ee(e),r=hd(n);this.Te(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}Re(){this.Pe(255),this.Pe(255)}be(){this.ve(255),this.ve(255)}reset(){this.position=0}seed(e){this.Te(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ve(){return this.buffer.slice(0,this.position)}Ee(e){const n=function(s){const i=new DataView(new ArrayBuffer(8));return i.setFloat64(0,s,!1),new Uint8Array(i.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}de(e){const n=255&e;n===0?(this.Pe(0),this.Pe(255)):n===255?(this.Pe(255),this.Pe(0)):this.Pe(n)}me(e){const n=255&e;n===0?(this.ve(0),this.ve(255)):n===255?(this.ve(255),this.ve(0)):this.ve(e)}_e(){this.Pe(0),this.Pe(1)}ge(){this.ve(0),this.ve(1)}Pe(e){this.Te(1),this.buffer[this.position++]=e}ve(e){this.Te(1),this.buffer[this.position++]=~e}Te(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class qA{constructor(e){this.Se=e}oe(e){this.Se.fe(e)}se(e){this.Se.ye(e)}ne(e){this.Se.Ie(e)}te(){this.Se.Re()}}class $A{constructor(e){this.Se=e}oe(e){this.Se.we(e)}se(e){this.Se.pe(e)}ne(e){this.Se.Ae(e)}te(){this.Se.be()}}class fd{constructor(){this.Se=new LA,this.De=new qA(this.Se),this.Ce=new $A(this.Se)}seed(e){this.Se.seed(e)}Ne(e){return e===0?this.De:this.Ce}Ve(){return this.Se.Ve()}reset(){this.Se.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eu{constructor(e,n,r,s){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=s}}function Tu(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=R.comparator(t.documentKey,e.documentKey),n!==0?n:(n=dd(t.arrayValue,e.arrayValue),n!==0?n:dd(t.directionalValue,e.directionalValue)))}function dd(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UA{constructor(){this.xe=new Hl}addToCollectionParentIndex(e,n){return this.xe.add(n),v.resolve()}getCollectionParents(e,n){return v.resolve(this.xe.getEntries(n))}addFieldIndex(e,n){return v.resolve()}deleteFieldIndex(e,n){return v.resolve()}getDocumentsMatchingTarget(e,n,r){return v.resolve(ae())}getFieldIndex(e,n){return v.resolve(null)}getFieldIndexes(e,n){return v.resolve([])}getNextCollectionGroupToUpdate(e){return v.resolve(null)}updateCollectionGroup(e,n,r){return v.resolve()}updateIndexEntries(e,n){return v.resolve()}}class Hl{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new _e(se.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new _e(se.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BA{constructor(e){this.user=e,this.ke=new Hl,this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.ke.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.ke.add(n)});const i={collectionId:r,parent:Me(s)};return pd(e).put(i)}return v.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[gg(n),""],!1,!0);return pd(e).qt(s).next(i=>{for(const o of i){if(o.collectionId!==n)break;r.push(Gt(o.parent))}return r})}addFieldIndex(e,n){const r=po(e),s=function(i){return new Et(i.indexId,i.collectionGroup,i.fields.map(o=>[o.fieldPath.canonicalString(),o.kind]))}(n);return delete s.indexId,r.add(s).next()}deleteFieldIndex(e,n){const r=po(e),s=mo(e),i=fo(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,n,r){return v.resolve(ae())}getFieldIndex(e,n){return v.resolve(null)}Oe(e,n){const r=new fd;for(const s of function(i){return i.fields.filter(o=>o.kind!==2)}(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const o=r.Ne(s.kind);Zo.le.Xt(i,o)}return r.Ve()}Me(e){const n=new fd;return Zo.le.Xt(e,n.Ne(0)),n.Ve()}getFieldIndexes(e,n){const r=po(e),s=mo(e);return(n?r.qt(Et.collectionGroupIndex,IDBKeyRange.bound(n,n)):r.qt()).next(i=>{const o=[];return v.forEach(i,a=>s.get([a.indexId,this.uid]).next(u=>{o.push(function(c,l){const h=l?new Yo(l.sequenceNumber,new Ma(gr(l.readTime),new R(Gt(l.documentKey)),l.largestBatchId)):Yo.empty(),f=c.fields.map(([p,g])=>new Kx(Pe.fromServerFormat(p),g));return new bg(c.indexId,c.collectionGroup,f,h)}(a,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>r.indexState.sequenceNumber-s.indexState.sequenceNumber),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=po(e),i=mo(e);return this.$e(e).next(o=>s.qt(Et.collectionGroupIndex,IDBKeyRange.bound(n,n)).next(a=>v.forEach(a,u=>i.put(function(c,l,h,f){return new At(c,l.uid||"",h,mr(f.readTime),Me(f.documentKey.path),f.largestBatchId)}(u.indexId,this.user,o,r)))))}updateIndexEntries(e,n){const r=new Map;return v.forEach(n,(s,i)=>{const o=r.get(s.collectionGroup);return(o?v.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),v.forEach(a,u=>this.Fe(e,s,u).next(c=>{const l=this.Be(i,u);return c.isEqual(l)?v.resolve():this.Le(e,i,c,l)}))))})}Ue(e,n,r){return fo(e).put(new Ct(r.indexId,this.uid,r.arrayValue,r.directionalValue,Me(n.key.path)))}qe(e,n,r){return fo(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,Me(n.key.path)])}Fe(e,n,r){const s=fo(e);let i=new _e(Tu);return s.Qt({index:Ct.documentKeyIndex,range:IDBKeyRange.only([r.indexId,this.uid,Me(n.path)])},(o,a)=>{i=i.add(new Eu(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>i)}Be(e,n){let r=new _e(Tu);const s=this.Oe(n,e);if(s==null)return r;const i=function(o){return o.fields.find(a=>a.kind===2)}(n);if(i!=null){const o=e.data.field(i.fieldPath);if(Pa(o))for(const a of o.arrayValue.values||[])r=r.add(new Eu(n.indexId,e.key,this.Me(a),s))}else r=r.add(new Eu(n.indexId,e.key,new Uint8Array,s));return r}Le(e,n,r,s){S("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const i=[];return function(o,a,u,c,l){const h=o.getIterator(),f=a.getIterator();let p=Fr(h),g=Fr(f);for(;p||g;){let T=!1,x=!1;if(p&&g){const M=u(p,g);M<0?x=!0:M>0&&(T=!0)}else p!=null?x=!0:T=!0;T?(c(g),g=Fr(f)):x?(l(p),p=Fr(h)):(p=Fr(h),g=Fr(f))}}(r,s,Tu,o=>{i.push(this.Ue(e,n,o))},o=>{i.push(this.qe(e,n,o))}),v.waitFor(i)}$e(e){let n=1;return mo(e).Qt({index:At.sequenceNumberIndex,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}}function pd(t){return Ue(t,tr.store)}function fo(t){return Ue(t,Ct.store)}function po(t){return Ue(t,Et.store)}function mo(t){return Ue(t,At.store)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const md={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class mt{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new mt(e,mt.DEFAULT_COLLECTION_PERCENTILE,mt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ny(t,e,n){const r=t.store(ge.store),s=t.store(Xe.store),i=[],o=IDBKeyRange.only(n.batchId);let a=0;const u=r.Qt({range:o},(l,h,f)=>(a++,f.delete()));i.push(u.next(()=>{j(a===1)}));const c=[];for(const l of n.mutations){const h=Xe.key(e,l.key.path,n.batchId);i.push(s.delete(h)),c.push(l.key)}return v.waitFor(i).next(()=>c)}function ea(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw L();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */mt.DEFAULT_COLLECTION_PERCENTILE=10,mt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,mt.DEFAULT=new mt(41943040,mt.DEFAULT_COLLECTION_PERCENTILE,mt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),mt.DISABLED=new mt(-1,0,0);class zl{constructor(e,n,r,s){this.userId=e,this.O=n,this.indexManager=r,this.referenceDelegate=s,this.Ke={}}static Jt(e,n,r,s){j(e.uid!=="");const i=e.isAuthenticated()?e.uid:"";return new zl(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return wn(e).Qt({index:ge.userMutationsIndex,range:r},(s,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=jr(e),o=wn(e);return o.add({}).next(a=>{j(typeof a=="number");const u=new $l(a,n,r,s),c=function(f,p,g){const T=g.baseMutations.map(M=>bi(f.Ht,M)),x=g.mutations.map(M=>bi(f.Ht,M));return new ge(p,g.batchId,g.localWriteTime.toMillis(),T,x)}(this.O,this.userId,u),l=[];let h=new _e((f,p)=>Y(f.canonicalString(),p.canonicalString()));for(const f of s){const p=Xe.key(this.userId,f.key.path,a);h=h.add(f.key.path.popLast()),l.push(o.put(c)),l.push(i.put(p,Xe.PLACEHOLDER))}return h.forEach(f=>{l.push(this.indexManager.addToCollectionParentIndex(e,f))}),e.addOnCommittedListener(()=>{this.Ke[a]=u.keys()}),v.waitFor(l).next(()=>u)})}lookupMutationBatch(e,n){return wn(e).get(n).next(r=>r?(j(r.userId===this.userId),Br(this.O,r)):null)}Ge(e,n){return this.Ke[n]?v.resolve(this.Ke[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.Ke[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return wn(e).Qt({index:ge.userMutationsIndex,range:s},(o,a,u)=>{a.userId===this.userId&&(j(a.batchId>=r),i=Br(this.O,a)),u.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return wn(e).Qt({index:ge.userMutationsIndex,range:n,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return wn(e).qt(ge.userMutationsIndex,n).next(r=>r.map(s=>Br(this.O,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Xe.prefixForPath(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return jr(e).Qt({range:s},(o,a,u)=>{const[c,l,h]=o,f=Gt(l);if(c===this.userId&&n.path.isEqual(f))return wn(e).get(h).next(p=>{if(!p)throw L();j(p.userId===this.userId),i.push(Br(this.O,p))});u.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new _e(Y);const s=[];return n.forEach(i=>{const o=Xe.prefixForPath(this.userId,i.path),a=IDBKeyRange.lowerBound(o),u=jr(e).Qt({range:a},(c,l,h)=>{const[f,p,g]=c,T=Gt(p);f===this.userId&&i.path.isEqual(T)?r=r.add(g):h.done()});s.push(u)}),v.waitFor(s).next(()=>this.je(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=Xe.prefixForPath(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new _e(Y);return jr(e).Qt({range:o},(u,c,l)=>{const[h,f,p]=u,g=Gt(f);h===this.userId&&r.isPrefixOf(g)?g.length===s&&(a=a.add(p)):l.done()}).next(()=>this.je(e,a))}je(e,n){const r=[],s=[];return n.forEach(i=>{s.push(wn(e).get(i).next(o=>{if(o===null)throw L();j(o.userId===this.userId),r.push(Br(this.O,o))}))}),v.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return ny(e.zt,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Qe(n.batchId)}),v.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}Qe(e){delete this.Ke[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return v.resolve();const r=IDBKeyRange.lowerBound(Xe.prefixForUser(this.userId)),s=[];return jr(e).Qt({range:r},(i,o,a)=>{if(i[0]===this.userId){const u=Gt(i[1]);s.push(u)}else a.done()}).next(()=>{j(s.length===0)})})}containsKey(e,n){return ry(e,this.userId,n)}We(e){return sy(e).get(this.userId).next(n=>n||new kn(this.userId,-1,""))}}function ry(t,e,n){const r=Xe.prefixForPath(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return jr(t).Qt({range:i,jt:!0},(a,u,c)=>{const[l,h,f]=a;l===e&&h===s&&(o=!0),c.done()}).next(()=>o)}function wn(t){return Ue(t,ge.store)}function jr(t){return Ue(t,Xe.store)}function sy(t){return Ue(t,kn.store)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr{constructor(e){this.ze=e}next(){return this.ze+=2,this.ze}static He(){return new yr(0)}static Je(){return new yr(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jA{constructor(e,n){this.referenceDelegate=e,this.O=n}allocateTargetId(e){return this.Ye(e).next(n=>{const r=new yr(n.highestTargetId);return n.highestTargetId=r.next(),this.Xe(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Ye(e).next(n=>B.fromTimestamp(new Le(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Ye(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Ye(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.Xe(e,s)))}addTargetData(e,n){return this.Ze(e,n).next(()=>this.Ye(e).next(r=>(r.targetCount+=1,this.tn(n,r),this.Xe(e,r))))}updateTargetData(e,n){return this.Ze(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>qr(e).delete(n.targetId)).next(()=>this.Ye(e)).next(r=>(j(r.targetCount>0),r.targetCount-=1,this.Xe(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return qr(e).Qt((o,a)=>{const u=Bs(a);u.sequenceNumber<=n&&r.get(u.targetId)===null&&(s++,i.push(this.removeTargetData(e,u)))}).next(()=>v.waitFor(i)).next(()=>s)}forEachTarget(e,n){return qr(e).Qt((r,s)=>{const i=Bs(s);n(i)})}Ye(e){return gd(e).get(wt.key).next(n=>(j(n!==null),n))}Xe(e,n){return gd(e).put(wt.key,n)}Ze(e,n){return qr(e).put(ty(this.O,n))}tn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Ye(e).next(n=>n.targetCount)}getTargetData(e,n){const r=$i(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return qr(e).Qt({range:s,index:gt.queryTargetsIndexName},(o,a,u)=>{const c=Bs(a);Fa(n,c.target)&&(i=c,u.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=In(e);return n.forEach(o=>{const a=Me(o.path);s.push(i.put(new Ge(r,a))),s.push(this.referenceDelegate.addReference(e,r,o))}),v.waitFor(s)}removeMatchingKeys(e,n,r){const s=In(e);return v.forEach(n,i=>{const o=Me(i.path);return v.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=In(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=In(e);let i=ae();return s.Qt({range:r,jt:!0},(o,a,u)=>{const c=Gt(o[1]),l=new R(c);i=i.add(l)}).next(()=>i)}containsKey(e,n){const r=Me(n.path),s=IDBKeyRange.bound([r],[gg(r)],!1,!0);let i=0;return In(e).Qt({index:Ge.documentTargetsIndex,jt:!0,range:s},([o,a],u,c)=>{o!==0&&(i++,c.done())}).next(()=>i>0)}Tt(e,n){return qr(e).get(n).next(r=>r?Bs(r):null)}}function qr(t){return Ue(t,gt.store)}function gd(t){return Ue(t,wt.store)}function In(t){return Ue(t,Ge.store)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xr(t){if(t.code!==y.FAILED_PRECONDITION||t.message!==Jg)throw t;S("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yd([t,e],[n,r]){const s=Y(t,n);return s===0?Y(e,r):s}class VA{constructor(e){this.en=e,this.buffer=new _e(yd),this.nn=0}sn(){return++this.nn}rn(e){const n=[e,this.sn()];if(this.buffer.size<this.en)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();yd(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class KA{constructor(e,n){this.garbageCollector=e,this.asyncQueue=n,this.on=!1,this.cn=null}start(e){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.un(e)}stop(){this.cn&&(this.cn.cancel(),this.cn=null)}get started(){return this.cn!==null}un(e){const n=this.on?3e5:6e4;S("LruGarbageCollector",`Garbage collection scheduled in ${n}ms`),this.cn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,async()=>{this.cn=null,this.on=!0;try{await e.collectGarbage(this.garbageCollector)}catch(r){Sr(r)?S("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):await xr(r)}await this.un(e)})}}class GA{constructor(e,n){this.an=e,this.params=n}calculateTargetCount(e,n){return this.an.hn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return v.resolve(bt.A);const r=new VA(n);return this.an.forEachTarget(e,s=>r.rn(s.sequenceNumber)).next(()=>this.an.ln(e,s=>r.rn(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.an.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.an.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(S("LruGarbageCollector","Garbage collection skipped; disabled"),v.resolve(md)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(S("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),md):this.fn(e,n))}getCacheSize(e){return this.an.getCacheSize(e)}fn(e,n){let r,s,i,o,a,u,c;const l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(S("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),s=this.params.maximumSequenceNumbersToCollect):s=h,o=Date.now(),this.nthSequenceNumber(e,s))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,n))).next(h=>(i=h,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(c=Date.now(),ic()<=re.DEBUG&&S("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-l}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(u-a)+`ms
	Removed ${h} documents in `+(c-u)+`ms
Total Duration: ${c-l}ms`),v.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:h})))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HA{constructor(e,n){this.db=e,this.garbageCollector=function(r,s){return new GA(r,s)}(this,n)}hn(e){const n=this.dn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}dn(e){let n=0;return this.ln(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}ln(e,n){return this._n(e,(r,s)=>n(s))}addReference(e,n,r){return go(e,r)}removeReference(e,n,r){return go(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return go(e,n)}wn(e,n){return function(r,s){let i=!1;return sy(r).Wt(o=>ry(r,o,s).next(a=>(a&&(i=!0),v.resolve(!a)))).next(()=>i)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this._n(e,(o,a)=>{if(a<=n){const u=this.wn(e,o).next(c=>{if(!c)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,B.min()),In(e).delete([0,Me(o.path)])))});s.push(u)}}).next(()=>v.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return go(e,n)}_n(e,n){const r=In(e);let s,i=bt.A;return r.Qt({index:Ge.documentTargetsIndex},([o,a],{path:u,sequenceNumber:c})=>{o===0?(i!==bt.A&&n(new R(Gt(s)),i),i=c,s=u):i=bt.A}).next(()=>{i!==bt.A&&n(new R(Gt(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function go(t,e){return In(t).put(function(n,r){return new Ge(0,Me(n.path),r)}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={}}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s!==void 0){for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n])}else this.inner[r]=[[e,n]]}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),!0;return!1}forEach(e){Er(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return yg(this.inner)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iy{constructor(){this.changes=new As(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,be.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?v.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zA{constructor(e){this.O=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Tn(e).put(yo(n),r)}removeEntry(e,n){const r=Tn(e),s=yo(n);return r.delete(s)}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.mn(e,r)))}getEntry(e,n){return Tn(e).get(yo(n)).next(r=>this.gn(n,r))}yn(e,n){return Tn(e).get(yo(n)).next(r=>({document:this.gn(n,r),size:ea(r)}))}getEntries(e,n){let r=Ot();return this.pn(e,n,(s,i)=>{const o=this.gn(s,i);r=r.insert(s,o)}).next(()=>r)}In(e,n){let r=Ot(),s=new Se(R.comparator);return this.pn(e,n,(i,o)=>{const a=this.gn(i,o);r=r.insert(i,a),s=s.insert(i,ea(o))}).next(()=>({documents:r,En:s}))}pn(e,n,r){if(n.isEmpty())return v.resolve();const s=IDBKeyRange.bound(n.first().path.toArray(),n.last().path.toArray()),i=n.getIterator();let o=i.getNext();return Tn(e).Qt({range:s},(a,u,c)=>{const l=R.fromSegments(a);for(;o&&R.comparator(o,l)<0;)r(o,null),o=i.getNext();o&&o.isEqual(l)&&(r(o,u),o=i.hasNext()?i.getNext():null),o?c.Ut(o.path.toArray()):c.done()}).next(()=>{for(;o;)r(o,null),o=i.hasNext()?i.getNext():null})}getAll(e,n,r){let s=Ot();const i=n.length+1,o={};if(r.isEqual(B.min())){const a=n.toArray();o.range=IDBKeyRange.lowerBound(a)}else{const a=n.toArray(),u=jl(r);o.range=IDBKeyRange.lowerBound([a,u],!0),o.index=Ee.collectionReadTimeIndex}return Tn(e).Qt(o,(a,u,c)=>{if(a.length!==i)return;const l=this.gn(R.fromSegments(a),u);n.isPrefixOf(l.key.path)?s=s.insert(l.key,l):c.done()}).next(()=>s)}newChangeBuffer(e){return new WA(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return vd(e).get(Ht.key).next(n=>(j(!!n),n))}mn(e,n){return vd(e).put(Ht.key,n)}gn(e,n){if(n){const r=ey(this.O,n);if(!(r.isNoDocument()&&r.version.isEqual(B.min())))return r}return be.newInvalidDocument(e)}}class WA extends iy{constructor(e,n){super(),this.Tn=e,this.trackRemovals=n,this.An=new As(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new _e((i,o)=>Y(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.An.get(i);if(o.isValidDocument()){const u=ad(this.Tn.O,o);s=s.add(i.path.popLast()),r+=ea(u)-a,n.push(this.Tn.addEntry(e,i,u))}else if(r-=a,this.trackRemovals){const u=ad(this.Tn.O,o.convertToNoDocument(B.min()));n.push(this.Tn.addEntry(e,i,u))}else n.push(this.Tn.removeEntry(e,i))}),s.forEach(i=>{n.push(this.Tn.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.Tn.updateMetadata(e,r)),v.waitFor(n)}getFromCache(e,n){return this.Tn.yn(e,n).next(r=>(this.An.set(n,r.size),r.document))}getAllFromCache(e,n){return this.Tn.In(e,n).next(({documents:r,En:s})=>(s.forEach((i,o)=>{this.An.set(i,o)}),r))}}function vd(t){return Ue(t,Ht.store)}function Tn(t){return Ue(t,Ee.store)}function yo(t){return t.path.toArray()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QA{constructor(e){this.O=e}kt(e,n,r,s){const i=new Ua("createOrUpgrade",n);r<1&&s>=1&&(function(a){a.createObjectStore(vt.store)}(e),function(a){a.createObjectStore(kn.store,{keyPath:kn.keyPath}),a.createObjectStore(ge.store,{keyPath:ge.keyPath,autoIncrement:!0}).createIndex(ge.userMutationsIndex,ge.userMutationsKeyPath,{unique:!0}),a.createObjectStore(Xe.store)}(e),wd(e),function(a){a.createObjectStore(Ee.store)}(e));let o=v.resolve();return r<3&&s>=3&&(r!==0&&(function(a){a.deleteObjectStore(Ge.store),a.deleteObjectStore(gt.store),a.deleteObjectStore(wt.store)}(e),wd(e)),o=o.next(()=>function(a){const u=a.store(wt.store),c=new wt(0,0,B.min().toTimestamp(),0);return u.put(wt.key,c)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(a,u){return u.store(ge.store).qt().next(c=>{a.deleteObjectStore(ge.store),a.createObjectStore(ge.store,{keyPath:ge.keyPath,autoIncrement:!0}).createIndex(ge.userMutationsIndex,ge.userMutationsKeyPath,{unique:!0});const l=u.store(ge.store),h=c.map(f=>l.put(f));return v.waitFor(h)})}(e,i))),o=o.next(()=>{(function(a){a.createObjectStore(an.store,{keyPath:an.keyPath})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.Rn(i))),r<6&&s>=6&&(o=o.next(()=>(function(a){a.createObjectStore(Ht.store)}(e),this.Pn(i)))),r<7&&s>=7&&(o=o.next(()=>this.bn(i))),r<8&&s>=8&&(o=o.next(()=>this.vn(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(a){a.objectStoreNames.contains("remoteDocumentChanges")&&a.deleteObjectStore("remoteDocumentChanges")})(e),function(a){const u=a.objectStore(Ee.store);u.createIndex(Ee.readTimeIndex,Ee.readTimeIndexPath,{unique:!1}),u.createIndex(Ee.collectionReadTimeIndex,Ee.collectionReadTimeIndexPath,{unique:!1})}(n)})),r<10&&s>=10&&(o=o.next(()=>this.Vn(i))),r<11&&s>=11&&(o=o.next(()=>{(function(a){a.createObjectStore(ls.store,{keyPath:ls.keyPath})})(e),function(a){a.createObjectStore(hs.store,{keyPath:hs.keyPath})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(a){const u=a.createObjectStore(Re.store,{keyPath:Re.keyPath});u.createIndex(Re.collectionPathOverlayIndex,Re.collectionPathOverlayIndexPath,{unique:!1}),u.createIndex(Re.collectionGroupOverlayIndex,Re.collectionGroupOverlayIndexPath,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>{(function(a){a.createObjectStore(Et.store,{keyPath:Et.keyPath,autoIncrement:!0}).createIndex(Et.collectionGroupIndex,Et.collectionGroupIndexPath,{unique:!1}),a.createObjectStore(At.store,{keyPath:At.keyPath}).createIndex(At.sequenceNumberIndex,At.sequenceNumberIndexPath,{unique:!1}),a.createObjectStore(Ct.store,{keyPath:Ct.keyPath}).createIndex(Ct.documentKeyIndex,Ct.documentKeyIndexPath,{unique:!1})})(e)})),o}Pn(e){let n=0;return e.store(Ee.store).Qt((r,s)=>{n+=ea(s)}).next(()=>{const r=new Ht(n);return e.store(Ht.store).put(Ht.key,r)})}Rn(e){const n=e.store(kn.store),r=e.store(ge.store);return n.qt().next(s=>v.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return r.qt(ge.userMutationsIndex,o).next(a=>v.forEach(a,u=>{j(u.userId===i.userId);const c=Br(this.O,u);return ny(e,i.userId,c).next(()=>{})}))}))}bn(e){const n=e.store(Ge.store),r=e.store(Ee.store);return e.store(wt.store).get(wt.key).next(s=>{const i=[];return r.Qt((o,a)=>{const u=new se(o),c=function(l){return[0,Me(l)]}(u);i.push(n.get(c).next(l=>l?v.resolve():(h=>n.put(new Ge(0,Me(h),s.highestListenSequenceNumber)))(u)))}).next(()=>v.waitFor(i))})}vn(e,n){e.createObjectStore(tr.store,{keyPath:tr.keyPath});const r=n.store(tr.store),s=new Hl,i=o=>{if(s.add(o)){const a=o.lastSegment(),u=o.popLast();return r.put({collectionId:a,parent:Me(u)})}};return n.store(Ee.store).Qt({jt:!0},(o,a)=>{const u=new se(o);return i(u.popLast())}).next(()=>n.store(Xe.store).Qt({jt:!0},([o,a,u],c)=>{const l=Gt(a);return i(l.popLast())}))}Vn(e){const n=e.store(gt.store);return n.Qt((r,s)=>{const i=Bs(s),o=ty(this.O,i);return n.put(o)})}}function wd(t){t.createObjectStore(Ge.store,{keyPath:Ge.keyPath}).createIndex(Ge.documentTargetsIndex,Ge.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(gt.store,{keyPath:gt.keyPath}).createIndex(gt.queryTargetsIndexName,gt.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(wt.store)}const Iu="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Wl{constructor(e,n,r,s,i,o,a,u,c,l,h=12){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Sn=i,this.window=o,this.document=a,this.Dn=c,this.Cn=l,this.schemaVersion=h,this.Nn=null,this.xn=!1,this.isPrimary=!1,this.networkEnabled=!0,this.kn=null,this.inForeground=!1,this.On=null,this.Mn=null,this.$n=Number.NEGATIVE_INFINITY,this.Fn=f=>Promise.resolve(),!Wl.Vt())throw new E(y.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new HA(this,s),this.Bn=n+"main",this.O=new Zg(u),this.Ln=new Mt(this.Bn,this.schemaVersion,new QA(this.O)),this.Un=new jA(this.referenceDelegate,this.O),this.qn=function(f){return new zA(f)}(this.O),this.Kn=new MA,this.window&&this.window.localStorage?this.Gn=this.window.localStorage:(this.Gn=null,l===!1&&Ae("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.jn().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new E(y.FAILED_PRECONDITION,Iu);return this.Qn(),this.Wn(),this.zn(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Un.getHighestSequenceNumber(e))}).then(e=>{this.Nn=new bt(e,this.Dn)}).then(()=>{this.xn=!0}).catch(e=>(this.Ln&&this.Ln.close(),Promise.reject(e)))}Hn(e){return this.Fn=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ln.Mt(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Sn.enqueueAndForget(async()=>{this.started&&await this.jn()}))}jn(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>vo(e).put(new an(this.clientId,Date.now(),this.networkEnabled,this.inForeground)).next(()=>{if(this.isPrimary)return this.Jn(e).next(n=>{n||(this.isPrimary=!1,this.Sn.enqueueRetryable(()=>this.Fn(!1)))})}).next(()=>this.Yn(e)).next(n=>this.isPrimary&&!n?this.Xn(e).next(()=>!1):!!n&&this.Zn(e).next(()=>!0))).catch(e=>{if(Sr(e))return S("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return S("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Sn.enqueueRetryable(()=>this.Fn(e)),this.isPrimary=e})}Jn(e){return Ls(e).get(vt.key).next(n=>v.resolve(this.ts(n)))}es(e){return vo(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.ss(this.$n,18e5)){this.$n=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Ue(n,an.store);return r.qt().next(s=>{const i=this.rs(s,18e5),o=s.filter(a=>i.indexOf(a)===-1);return v.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Gn)for(const n of e)this.Gn.removeItem(this.os(n.clientId))}}zn(){this.Mn=this.Sn.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.jn().then(()=>this.ns()).then(()=>this.zn()))}ts(e){return!!e&&e.ownerId===this.clientId}Yn(e){return this.Cn?v.resolve(!0):Ls(e).get(vt.key).next(n=>{if(n!==null&&this.ss(n.leaseTimestampMs,5e3)&&!this.cs(n.ownerId)){if(this.ts(n)&&this.networkEnabled)return!0;if(!this.ts(n)){if(!n.allowTabSynchronization)throw new E(y.FAILED_PRECONDITION,Iu);return!1}}return!(!this.networkEnabled||!this.inForeground)||vo(e).qt().next(r=>this.rs(r,5e3).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&S("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.xn=!1,this.us(),this.Mn&&(this.Mn.cancel(),this.Mn=null),this.hs(),this.ls(),await this.Ln.runTransaction("shutdown","readwrite",[vt.store,an.store],e=>{const n=new od(e,bt.A);return this.Xn(n).next(()=>this.es(n))}),this.Ln.close(),this.fs()}rs(e,n){return e.filter(r=>this.ss(r.updateTimeMs,n)&&!this.cs(r.clientId))}ds(){return this.runTransaction("getActiveClients","readonly",e=>vo(e).qt().next(n=>this.rs(n,18e5).map(r=>r.clientId)))}get started(){return this.xn}getMutationQueue(e,n){return zl.Jt(e,this.O,n,this.referenceDelegate)}getTargetCache(){return this.Un}getRemoteDocumentCache(){return this.qn}getIndexManager(e){return new BA(e)}getDocumentOverlayCache(e){return Gl.Jt(this.O,e)}getBundleCache(){return this.Kn}runTransaction(e,n,r){S("IndexedDbPersistence","Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=(o=this.schemaVersion)===13?NA:o===12?Yg:o===11?Qg:void L();var o;let a;return this.Ln.runTransaction(e,s,i,u=>(a=new od(u,this.Nn?this.Nn.next():bt.A),n==="readwrite-primary"?this.Jn(a).next(c=>!!c||this.Yn(a)).next(c=>{if(!c)throw Ae(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Sn.enqueueRetryable(()=>this.Fn(!1)),new E(y.FAILED_PRECONDITION,Jg);return r(a)}).next(c=>this.Zn(a).next(()=>c)):this._s(a).next(()=>r(a)))).then(u=>(a.raiseOnCommittedEvent(),u))}_s(e){return Ls(e).get(vt.key).next(n=>{if(n!==null&&this.ss(n.leaseTimestampMs,5e3)&&!this.cs(n.ownerId)&&!this.ts(n)&&!(this.Cn||this.allowTabSynchronization&&n.allowTabSynchronization))throw new E(y.FAILED_PRECONDITION,Iu)})}Zn(e){const n=new vt(this.clientId,this.allowTabSynchronization,Date.now());return Ls(e).put(vt.key,n)}static Vt(){return Mt.Vt()}Xn(e){const n=Ls(e);return n.get(vt.key).next(r=>this.ts(r)?(S("IndexedDbPersistence","Releasing primary lease."),n.delete(vt.key)):v.resolve())}ss(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(Ae(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Qn(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.On=()=>{this.Sn.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.jn()))},this.document.addEventListener("visibilitychange",this.On),this.inForeground=this.document.visibilityState==="visible")}hs(){this.On&&(this.document.removeEventListener("visibilitychange",this.On),this.On=null)}Wn(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.kn=()=>{this.us(),tI()&&navigator.appVersion.match(/Version\/1[45]/)&&this.Sn.enterRestrictedMode(!0),this.Sn.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.kn))}ls(){this.kn&&(this.window.removeEventListener("pagehide",this.kn),this.kn=null)}cs(e){var n;try{const r=((n=this.Gn)===null||n===void 0?void 0:n.getItem(this.os(e)))!==null;return S("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Ae("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}us(){if(this.Gn)try{this.Gn.setItem(this.os(this.clientId),String(Date.now()))}catch(e){Ae("Failed to set zombie client id.",e)}}fs(){if(this.Gn)try{this.Gn.removeItem(this.os(this.clientId))}catch{}}os(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Ls(t){return Ue(t,vt.store)}function vo(t){return Ue(t,an.store)}function Ql(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YA{constructor(e,n){this.progress=e,this.ws=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JA{constructor(e,n,r){this.qn=e,this.gs=n,this.indexManager=r}ys(e,n){return this.gs.getAllMutationBatchesAffectingDocumentKey(e,n).next(r=>this.ps(e,n,r))}ps(e,n,r){return this.qn.getEntry(e,n).next(s=>{for(const i of r)i.applyToLocalView(s);return s})}Is(e,n){e.forEach((r,s)=>{for(const i of n)i.applyToLocalView(s)})}Es(e,n){return this.qn.getEntries(e,n).next(r=>this.Ts(e,r).next(()=>r))}Ts(e,n){return this.gs.getAllMutationBatchesAffectingDocumentKeys(e,n).next(r=>this.Is(n,r))}As(e,n,r){return function(s){return R.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(n)?this.Rs(e,n.path):Pl(n)?this.Ps(e,n,r):this.bs(e,n,r)}Rs(e,n){return this.ys(e,new R(n)).next(r=>{let s=lc();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}Ps(e,n,r){const s=n.collectionGroup;let i=lc();return this.indexManager.getCollectionParents(e,s).next(o=>v.forEach(o,a=>{const u=function(c,l){return new dn(l,null,c.explicitOrderBy.slice(),c.filters.slice(),c.limit,c.limitType,c.startAt,c.endAt)}(n,a.child(s));return this.bs(e,u,r).next(c=>{c.forEach((l,h)=>{i=i.insert(l,h)})})}).next(()=>i))}bs(e,n,r){let s;return this.qn.getAll(e,n.path,r).next(i=>(s=i,this.gs.getAllMutationBatchesAffectingQuery(e,n))).next(i=>{for(const o of i)for(const a of o.mutations){const u=a.key;let c=s.get(u);c==null&&(c=be.newInvalidDocument(u),s=s.insert(u,c)),cc(a,c,o.localWriteTime),c.isFoundDocument()||(s=s.remove(u))}}).next(()=>(s.forEach((i,o)=>{Ml(n,o)||(s=s.remove(i))}),s))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yl{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.vs=r,this.Vs=s}static Ss(e,n){let r=ae(),s=ae();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Yl(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oy{Ds(e){this.Cs=e}As(e,n,r,s){return function(i){return i.filters.length===0&&i.limit===null&&i.startAt==null&&i.endAt==null&&(i.explicitOrderBy.length===0||i.explicitOrderBy.length===1&&i.explicitOrderBy[0].field.isKeyField())}(n)||r.isEqual(B.min())?this.Ns(e,n):this.Cs.Es(e,s).next(i=>{const o=this.xs(n,i);return(So(n)||Xo(n))&&this.ks(n.limitType,o,s,r)?this.Ns(e,n):(ic()<=re.DEBUG&&S("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),uc(n)),this.Cs.As(e,n,r).next(a=>(o.forEach(u=>{a=a.insert(u.key,u)}),a)))})}xs(e,n){let r=new _e(xg(e));return n.forEach((s,i)=>{Ml(e,i)&&(r=r.add(i))}),r}ks(e,n,r,s){if(r.size!==n.size)return!0;const i=e==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ns(e,n){return ic()<=re.DEBUG&&S("QueryEngine","Using full collection scan to execute query:",uc(n)),this.Cs.As(e,n,B.min())}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XA{constructor(e,n,r,s){this.persistence=e,this.Os=n,this.O=s,this.Ms=new Se(Y),this.$s=new As(i=>$i(i),Fa),this.Fs=B.min(),this.Bs=e.getRemoteDocumentCache(),this.Un=e.getTargetCache(),this.Kn=e.getBundleCache(),this.Ls(r)}Ls(e){this.indexManager=this.persistence.getIndexManager(e),this.gs=this.persistence.getMutationQueue(e,this.indexManager),this.Us=new JA(this.Bs,this.gs,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Os.Ds(this.Us)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function ay(t,e,n,r){return new XA(t,e,n,r)}async function uy(t,e){const n=D(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.gs.getAllMutationBatches(r).next(i=>(s=i,n.Ls(e),n.gs.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let u=ae();for(const c of s){o.push(c.batchId);for(const l of c.mutations)u=u.add(l.key)}for(const c of i){a.push(c.batchId);for(const l of c.mutations)u=u.add(l.key)}return n.Us.Es(r,u).next(c=>({qs:c,removedBatchIds:o,addedBatchIds:a}))})})}function ZA(t,e){const n=D(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Bs.newChangeBuffer({trackRemovals:!0});return function(o,a,u,c){const l=u.batch,h=l.keys();let f=v.resolve();return h.forEach(p=>{f=f.next(()=>c.getEntry(a,p)).next(g=>{const T=u.docVersions.get(p);j(T!==null),g.version.compareTo(T)<0&&(l.applyToRemoteDocument(g,u),g.isValidDocument()&&(g.setReadTime(u.commitVersion),c.addEntry(g)))})}),f.next(()=>o.gs.removeMutationBatch(a,l))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.gs.performConsistencyCheck(r)).next(()=>n.Us.Es(r,s))})}function cy(t){const e=D(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Un.getLastRemoteSnapshotVersion(n))}function eC(t,e){const n=D(t),r=e.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Bs.newChangeBuffer({trackRemovals:!0});s=n.Ms;const a=[];e.targetChanges.forEach((c,l)=>{const h=s.get(l);if(!h)return;a.push(n.Un.removeMatchingKeys(i,c.removedDocuments,l).next(()=>n.Un.addMatchingKeys(i,c.addedDocuments,l)));let f=h.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.has(l)?f=f.withResumeToken(De.EMPTY_BYTE_STRING,B.min()).withLastLimboFreeSnapshotVersion(B.min()):c.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(c.resumeToken,r)),s=s.insert(l,f),function(p,g,T){return p.resumeToken.approximateByteSize()===0||g.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=3e8?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(h,f,c)&&a.push(n.Un.updateTargetData(i,f))});let u=Ot();if(e.documentUpdates.forEach(c=>{e.resolvedLimboDocuments.has(c)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,c))}),a.push(ly(i,o,e.documentUpdates).next(c=>{u=c})),!r.isEqual(B.min())){const c=n.Un.getLastRemoteSnapshotVersion(i).next(l=>n.Un.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(c)}return v.waitFor(a).next(()=>o.apply(i)).next(()=>n.Us.Ts(i,u)).next(()=>u)}).then(i=>(n.Ms=s,i))}function ly(t,e,n){let r=ae();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let i=Ot();return n.forEach((o,a)=>{const u=s.get(o);a.isNoDocument()&&a.version.isEqual(B.min())?(e.removeEntry(o,a.readTime),i=i.insert(o,a)):!u.isValidDocument()||a.version.compareTo(u.version)>0||a.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(a),i=i.insert(o,a)):S("LocalStore","Ignoring outdated watch update for ",o,". Current version:",u.version," Watch version:",a.version)}),i})}function tC(t,e){const n=D(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.gs.getNextMutationBatchAfterBatchId(r,e)))}function fs(t,e){const n=D(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Un.getTargetData(r,e).next(i=>i?(s=i,v.resolve(s)):n.Un.allocateTargetId(r).next(o=>(s=new On(e,o,0,r.currentSequenceNumber),n.Un.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.$s.set(e,r.targetId)),r})}async function ds(t,e,n){const r=D(t),s=r.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Sr(o))throw o;S("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.$s.delete(s.target)}function ta(t,e,n){const r=D(t);let s=B.min(),i=ae();return r.persistence.runTransaction("Execute query","readonly",o=>function(a,u,c){const l=D(a),h=l.$s.get(c);return h!==void 0?v.resolve(l.Ms.get(h)):l.Un.getTargetData(u,c)}(r,o,Dt(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Un.getMatchingKeysForTargetId(o,a.targetId).next(u=>{i=u})}).next(()=>r.Os.As(o,e,n?s:B.min(),n?i:ae())).next(a=>({documents:a,Ks:i})))}function hy(t,e){const n=D(t),r=D(n.Un),s=n.Ms.get(e);return s?Promise.resolve(s.target):n.persistence.runTransaction("Get target data","readonly",i=>r.Tt(i,e).next(o=>o?o.target:null))}function fy(t){const e=D(t);return e.persistence.runTransaction("Get new document changes","readonly",n=>function(r,s,i){const o=D(r);let a=Ot(),u=jl(i);const c=Tn(s),l=IDBKeyRange.lowerBound(u,!0);return c.Qt({index:Ee.readTimeIndex,range:l},(h,f)=>{const p=ey(o.O,f);a=a.insert(p.key,p),u=f.readTime}).next(()=>({ws:a,readTime:Vl(u)}))}(e.Bs,n,e.Fs)).then(({ws:n,readTime:r})=>(e.Fs=r,n))}async function nC(t){const e=D(t);return e.persistence.runTransaction("Synchronize last document change read time","readonly",n=>function(r){const s=Tn(r);let i=B.min();return s.Qt({index:Ee.readTimeIndex,reverse:!0},(o,a,u)=>{a.readTime&&(i=Vl(a.readTime)),u.done()}).next(()=>i)}(n)).then(n=>{e.Fs=n})}async function rC(t,e,n,r){const s=D(t);let i=ae(),o=Ot();for(const c of n){const l=e.Gs(c.metadata.name);c.document&&(i=i.add(l));const h=e.js(c);h.setReadTime(e.Qs(c.metadata.readTime)),o=o.insert(l,h)}const a=s.Bs.newChangeBuffer({trackRemovals:!0}),u=await fs(s,function(c){return Dt(xs(se.fromString(`__bundle__/docs/${c}`)))}(r));return s.persistence.runTransaction("Apply bundle documents","readwrite",c=>ly(c,a,o).next(l=>(a.apply(c),l)).next(l=>s.Un.removeMatchingKeysForTargetId(c,u.targetId).next(()=>s.Un.addMatchingKeys(c,i,u.targetId)).next(()=>s.Us.Ts(c,l)).next(()=>l)))}async function sC(t,e,n=ae()){const r=await fs(t,Dt(Kl(e.bundledQuery))),s=D(t);return s.persistence.runTransaction("Save named query","readwrite",i=>{const o=qe(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return s.Kn.saveNamedQuery(i,e);const a=r.withResumeToken(De.EMPTY_BYTE_STRING,o);return s.Ms=s.Ms.insert(a.targetId,a),s.Un.updateTargetData(i,a).next(()=>s.Un.removeMatchingKeysForTargetId(i,r.targetId)).next(()=>s.Un.addMatchingKeys(i,n,r.targetId)).next(()=>s.Kn.saveNamedQuery(i,e))})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iC{constructor(e){this.O=e,this.Ws=new Map,this.zs=new Map}getBundleMetadata(e,n){return v.resolve(this.Ws.get(n))}saveBundleMetadata(e,n){var r;return this.Ws.set(n.id,{id:(r=n).id,version:r.version,createTime:qe(r.createTime)}),v.resolve()}getNamedQuery(e,n){return v.resolve(this.zs.get(n))}saveNamedQuery(e,n){return this.zs.set(n.name,function(r){return{name:r.name,query:Kl(r.bundledQuery),readTime:qe(r.readTime)}}(n)),v.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{constructor(){this.overlays=new Se(R.comparator),this.Hs=new Map}getOverlay(e,n){return v.resolve(this.overlays.get(n))}saveOverlays(e,n,r){return r.forEach(s=>{this.Yt(e,n,s)}),v.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Hs.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Hs.delete(r)),v.resolve()}getOverlaysForCollection(e,n,r){const s=new Map,i=n.length+1,o=new R(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const u=a.getNext().value,c=u.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return v.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Se((c,l)=>c-l);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let l=i.get(c.largestBatchId);l===null&&(l=new Map,i=i.insert(c.largestBatchId,l)),l.set(c.getKey(),c)}}const a=new Map,u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((c,l)=>a.set(l,c)),!(a.size>=s)););return v.resolve(a)}Yt(e,n,r){if(r===null)return;const s=this.overlays.get(r.key);s!==null&&this.Hs.get(s.largestBatchId).delete(r.key),this.overlays=this.overlays.insert(r.key,new Bl(n,r));let i=this.Hs.get(n);i===void 0&&(i=new Set,this.Hs.set(n,i)),i.add(r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jl{constructor(){this.Js=new _e(Ne.Ys),this.Xs=new _e(Ne.Zs)}isEmpty(){return this.Js.isEmpty()}addReference(e,n){const r=new Ne(e,n);this.Js=this.Js.add(r),this.Xs=this.Xs.add(r)}ti(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.ei(new Ne(e,n))}ni(e,n){e.forEach(r=>this.removeReference(r,n))}si(e){const n=new R(new se([])),r=new Ne(n,e),s=new Ne(n,e+1),i=[];return this.Xs.forEachInRange([r,s],o=>{this.ei(o),i.push(o.key)}),i}ii(){this.Js.forEach(e=>this.ei(e))}ei(e){this.Js=this.Js.delete(e),this.Xs=this.Xs.delete(e)}ri(e){const n=new R(new se([])),r=new Ne(n,e),s=new Ne(n,e+1);let i=ae();return this.Xs.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Ne(e,0),r=this.Js.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Ne{constructor(e,n){this.key=e,this.oi=n}static Ys(e,n){return R.comparator(e.key,n.key)||Y(e.oi,n.oi)}static Zs(e,n){return Y(e.oi,n.oi)||R.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aC{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.gs=[],this.ci=1,this.ui=new _e(Ne.Ys)}checkEmpty(e){return v.resolve(this.gs.length===0)}addMutationBatch(e,n,r,s){const i=this.ci;this.ci++,this.gs.length>0&&this.gs[this.gs.length-1];const o=new $l(i,n,r,s);this.gs.push(o);for(const a of s)this.ui=this.ui.add(new Ne(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return v.resolve(o)}lookupMutationBatch(e,n){return v.resolve(this.ai(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.hi(r),i=s<0?0:s;return v.resolve(this.gs.length>i?this.gs[i]:null)}getHighestUnacknowledgedBatchId(){return v.resolve(this.gs.length===0?-1:this.ci-1)}getAllMutationBatches(e){return v.resolve(this.gs.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Ne(n,0),s=new Ne(n,Number.POSITIVE_INFINITY),i=[];return this.ui.forEachInRange([r,s],o=>{const a=this.ai(o.oi);i.push(a)}),v.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new _e(Y);return n.forEach(s=>{const i=new Ne(s,0),o=new Ne(s,Number.POSITIVE_INFINITY);this.ui.forEachInRange([i,o],a=>{r=r.add(a.oi)})}),v.resolve(this.li(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;R.isDocumentKey(i)||(i=i.child(""));const o=new Ne(new R(i),0);let a=new _e(Y);return this.ui.forEachWhile(u=>{const c=u.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(a=a.add(u.oi)),!0)},o),v.resolve(this.li(a))}li(e){const n=[];return e.forEach(r=>{const s=this.ai(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){j(this.fi(n.batchId,"removed")===0),this.gs.shift();let r=this.ui;return v.forEach(n.mutations,s=>{const i=new Ne(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.ui=r})}Qe(e){}containsKey(e,n){const r=new Ne(n,0),s=this.ui.firstAfterOrEqual(r);return v.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.gs.length,v.resolve()}fi(e,n){return this.hi(e)}hi(e){return this.gs.length===0?0:e-this.gs[0].batchId}ai(e){const n=this.hi(e);return n<0||n>=this.gs.length?null:this.gs[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uC{constructor(e){this.di=e,this.docs=new Se(R.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.di(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return v.resolve(r?r.document.mutableCopy():be.newInvalidDocument(n))}getEntries(e,n){let r=Ot();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():be.newInvalidDocument(s))}),v.resolve(r)}getAll(e,n,r){let s=Ot();const i=new R(n.child("")),o=this.docs.getIteratorFrom(i);for(;o.hasNext();){const{key:a,value:{document:u}}=o.getNext();if(!n.isPrefixOf(a.path))break;a.path.length>n.length+1||u.readTime.compareTo(r)<=0||(s=s.insert(u.key,u.mutableCopy()))}return v.resolve(s)}_i(e,n){return v.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new cC(this)}getSize(e){return v.resolve(this.size)}}class cC extends iy{constructor(e){super(),this.Tn=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Tn.addEntry(e,s)):this.Tn.removeEntry(r)}),v.waitFor(n)}getFromCache(e,n){return this.Tn.getEntry(e,n)}getAllFromCache(e,n){return this.Tn.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lC{constructor(e){this.persistence=e,this.wi=new As(n=>$i(n),Fa),this.lastRemoteSnapshotVersion=B.min(),this.highestTargetId=0,this.mi=0,this.gi=new Jl,this.targetCount=0,this.yi=yr.He()}forEachTarget(e,n){return this.wi.forEach((r,s)=>n(s)),v.resolve()}getLastRemoteSnapshotVersion(e){return v.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return v.resolve(this.mi)}allocateTargetId(e){return this.highestTargetId=this.yi.next(),v.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.mi&&(this.mi=n),v.resolve()}Ze(e){this.wi.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.yi=new yr(n),this.highestTargetId=n),e.sequenceNumber>this.mi&&(this.mi=e.sequenceNumber)}addTargetData(e,n){return this.Ze(n),this.targetCount+=1,v.resolve()}updateTargetData(e,n){return this.Ze(n),v.resolve()}removeTargetData(e,n){return this.wi.delete(n.target),this.gi.si(n.targetId),this.targetCount-=1,v.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.wi.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.wi.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),v.waitFor(i).next(()=>s)}getTargetCount(e){return v.resolve(this.targetCount)}getTargetData(e,n){const r=this.wi.get(n)||null;return v.resolve(r)}addMatchingKeys(e,n,r){return this.gi.ti(n,r),v.resolve()}removeMatchingKeys(e,n,r){this.gi.ni(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),v.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.gi.si(n),v.resolve()}getMatchingKeysForTargetId(e,n){const r=this.gi.ri(n);return v.resolve(r)}containsKey(e,n){return v.resolve(this.gi.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hC{constructor(e,n){this.pi={},this.overlays={},this.Nn=new bt(0),this.xn=!1,this.xn=!0,this.referenceDelegate=e(this),this.Un=new lC(this),this.indexManager=new UA,this.qn=function(r){return new uC(r)}(r=>this.referenceDelegate.Ii(r)),this.O=new Zg(n),this.Kn=new iC(this.O)}start(){return Promise.resolve()}shutdown(){return this.xn=!1,Promise.resolve()}get started(){return this.xn}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new oC,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.pi[e.toKey()];return r||(r=new aC(n,this.referenceDelegate),this.pi[e.toKey()]=r),r}getTargetCache(){return this.Un}getRemoteDocumentCache(){return this.qn}getBundleCache(){return this.Kn}runTransaction(e,n,r){S("MemoryPersistence","Starting transaction:",e);const s=new fC(this.Nn.next());return this.referenceDelegate.Ei(),r(s).next(i=>this.referenceDelegate.Ti(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,n){return v.or(Object.values(this.pi).map(r=>()=>r.containsKey(e,n)))}}class fC extends Xg{constructor(e){super(),this.currentSequenceNumber=e}}class Xl{constructor(e){this.persistence=e,this.Ri=new Jl,this.Pi=null}static bi(e){return new Xl(e)}get vi(){if(this.Pi)return this.Pi;throw L()}addReference(e,n,r){return this.Ri.addReference(r,n),this.vi.delete(r.toString()),v.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.vi.add(r.toString()),v.resolve()}markPotentiallyOrphaned(e,n){return this.vi.add(n.toString()),v.resolve()}removeTarget(e,n){this.Ri.si(n.targetId).forEach(s=>this.vi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.vi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Pi=new Set}Ti(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return v.forEach(this.vi,r=>{const s=R.fromPath(r);return this.Vi(e,s).next(i=>{i||n.removeEntry(s,B.min())})}).next(()=>(this.Pi=null,n.apply(e)))}updateLimboDocument(e,n){return this.Vi(e,n).next(r=>{r?this.vi.delete(n.toString()):this.vi.add(n.toString())})}Ii(e){return 0}Vi(e,n){return v.or([()=>v.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _d(t,e){return`firestore_clients_${t}_${e}`}function bd(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Su(t,e){return`firestore_targets_${t}_${e}`}class na{constructor(e,n,r,s){this.user=e,this.batchId=n,this.state=r,this.error=s}static Si(e,n,r){const s=JSON.parse(r);let i,o=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return o&&s.error&&(o=typeof s.error.message=="string"&&typeof s.error.code=="string",o&&(i=new E(s.error.code,s.error.message))),o?new na(e,n,s.state,i):(Ae("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Di(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ys{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Si(e,n){const r=JSON.parse(n);let s,i=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return i&&r.error&&(i=typeof r.error.message=="string"&&typeof r.error.code=="string",i&&(s=new E(r.error.code,r.error.message))),i?new Ys(e,r.state,s):(Ae("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Di(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class ra{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Si(e,n){const r=JSON.parse(n);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,i=$a();for(let o=0;s&&o<r.activeTargetIds.length;++o)s=wg(r.activeTargetIds[o]),i=i.add(r.activeTargetIds[o]);return s?new ra(e,i):(Ae("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class Zl{constructor(e,n){this.clientId=e,this.onlineState=n}static Si(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new Zl(n.clientId,n.onlineState):(Ae("SharedClientState",`Failed to parse online state: ${e}`),null)}}class dc{constructor(){this.activeTargetIds=$a()}Ci(e){this.activeTargetIds=this.activeTargetIds.add(e)}Ni(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Di(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class xu{constructor(e,n,r,s,i){this.window=e,this.Sn=n,this.persistenceKey=r,this.xi=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ki=this.Oi.bind(this),this.Mi=new Se(Y),this.started=!1,this.$i=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Fi=_d(this.persistenceKey,this.xi),this.Bi=function(a){return`firestore_sequence_number_${a}`}(this.persistenceKey),this.Mi=this.Mi.insert(this.xi,new dc),this.Li=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Ui=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.qi=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.Ki=function(a){return`firestore_online_state_${a}`}(this.persistenceKey),this.Gi=function(a){return`firestore_bundle_loaded_${a}`}(this.persistenceKey),this.window.addEventListener("storage",this.ki)}static Vt(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.ds();for(const r of e){if(r===this.xi)continue;const s=this.getItem(_d(this.persistenceKey,r));if(s){const i=ra.Si(r,s);i&&(this.Mi=this.Mi.insert(i.clientId,i))}}this.ji();const n=this.storage.getItem(this.Ki);if(n){const r=this.Qi(n);r&&this.Wi(r)}for(const r of this.$i)this.Oi(r);this.$i=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.Bi,JSON.stringify(e))}getAllActiveQueryTargets(){return this.zi(this.Mi)}isActiveQueryTarget(e){let n=!1;return this.Mi.forEach((r,s)=>{s.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Hi(e,"pending")}updateMutationState(e,n,r){this.Hi(e,n,r),this.Ji(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(Su(this.persistenceKey,e));if(r){const s=Ys.Si(e,r);s&&(n=s.state)}}return this.Yi.Ci(e),this.ji(),n}removeLocalQueryTarget(e){this.Yi.Ni(e),this.ji()}isLocalQueryTarget(e){return this.Yi.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Su(this.persistenceKey,e))}updateQueryState(e,n,r){this.Xi(e,n,r)}handleUserChange(e,n,r){n.forEach(s=>{this.Ji(s)}),this.currentUser=e,r.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.Zi(e)}notifyBundleLoaded(){this.tr()}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ki),this.removeItem(this.Fi),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return S("SharedClientState","READ",e,n),n}setItem(e,n){S("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){S("SharedClientState","REMOVE",e),this.storage.removeItem(e)}Oi(e){const n=e;if(n.storageArea===this.storage){if(S("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Fi)return void Ae("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Sn.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.Li.test(n.key)){if(n.newValue==null){const r=this.er(n.key);return this.nr(r,null)}{const r=this.sr(n.key,n.newValue);if(r)return this.nr(r.clientId,r)}}else if(this.Ui.test(n.key)){if(n.newValue!==null){const r=this.ir(n.key,n.newValue);if(r)return this.rr(r)}}else if(this.qi.test(n.key)){if(n.newValue!==null){const r=this.cr(n.key,n.newValue);if(r)return this.ur(r)}}else if(n.key===this.Ki){if(n.newValue!==null){const r=this.Qi(n.newValue);if(r)return this.Wi(r)}}else if(n.key===this.Bi){const r=function(s){let i=bt.A;if(s!=null)try{const o=JSON.parse(s);j(typeof o=="number"),i=o}catch(o){Ae("SharedClientState","Failed to read sequence number from WebStorage",o)}return i}(n.newValue);r!==bt.A&&this.sequenceNumberHandler(r)}else if(n.key===this.Gi)return this.syncEngine.ar()}}else this.$i.push(n)})}}get Yi(){return this.Mi.get(this.xi)}ji(){this.setItem(this.Fi,this.Yi.Di())}Hi(e,n,r){const s=new na(this.currentUser,e,n,r),i=bd(this.persistenceKey,this.currentUser,e);this.setItem(i,s.Di())}Ji(e){const n=bd(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Zi(e){const n={clientId:this.xi,onlineState:e};this.storage.setItem(this.Ki,JSON.stringify(n))}Xi(e,n,r){const s=Su(this.persistenceKey,e),i=new Ys(e,n,r);this.setItem(s,i.Di())}tr(){this.setItem(this.Gi,"value-not-used")}er(e){const n=this.Li.exec(e);return n?n[1]:null}sr(e,n){const r=this.er(e);return ra.Si(r,n)}ir(e,n){const r=this.Ui.exec(e),s=Number(r[1]),i=r[2]!==void 0?r[2]:null;return na.Si(new Ve(i),s,n)}cr(e,n){const r=this.qi.exec(e),s=Number(r[1]);return Ys.Si(s,n)}Qi(e){return Zl.Si(e)}async rr(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.hr(e.batchId,e.state,e.error);S("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}ur(e){return this.syncEngine.lr(e.targetId,e.state,e.error)}nr(e,n){const r=n?this.Mi.insert(e,n):this.Mi.remove(e),s=this.zi(this.Mi),i=this.zi(r),o=[],a=[];return i.forEach(u=>{s.has(u)||o.push(u)}),s.forEach(u=>{i.has(u)||a.push(u)}),this.syncEngine.dr(o,a).then(()=>{this.Mi=r})}Wi(e){this.Mi.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}zi(e){let n=$a();return e.forEach((r,s)=>{n=n.unionWith(s.activeTargetIds)}),n}}class dy{constructor(){this._r=new dc,this.wr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this._r.Ci(e),this.wr[e]||"not-current"}updateQueryState(e,n,r){this.wr[e]=n}removeLocalQueryTarget(e){this._r.Ni(e)}isLocalQueryTarget(e){return this._r.activeTargetIds.has(e)}clearQueryState(e){delete this.wr[e]}getAllActiveQueryTargets(){return this._r.activeTargetIds}isActiveQueryTarget(e){return this._r.activeTargetIds.has(e)}start(){return this._r=new dc,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC{mr(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ed{constructor(){this.gr=()=>this.yr(),this.pr=()=>this.Ir(),this.Er=[],this.Tr()}mr(e){this.Er.push(e)}shutdown(){window.removeEventListener("online",this.gr),window.removeEventListener("offline",this.pr)}Tr(){window.addEventListener("online",this.gr),window.addEventListener("offline",this.pr)}yr(){S("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Er)e(0)}Ir(){S("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Er)e(1)}static Vt(){return typeof window!="undefined"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pC={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mC{constructor(e){this.Ar=e.Ar,this.Rr=e.Rr}Pr(e){this.br=e}vr(e){this.Vr=e}onMessage(e){this.Sr=e}close(){this.Rr()}send(e){this.Ar(e)}Dr(){this.br()}Cr(e){this.Vr(e)}Nr(e){this.Sr(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gC extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http";this.kr=n+"://"+e.host,this.Or="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}Mr(e,n,r,s,i){const o=this.$r(e,n);S("RestConnection","Sending: ",o,r);const a={};return this.Fr(a,s,i),this.Br(e,o,a,r).then(u=>(S("RestConnection","Received: ",u),u),u=>{throw di("RestConnection",`${e} failed with error: `,u,"url: ",o,"request:",r),u})}Lr(e,n,r,s,i){return this.Mr(e,n,r,s,i)}Fr(e,n,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+Ss,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}$r(e,n){const r=pC[e];return`${this.kr}/v1/${n}:${r}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}Br(e,n,r,s){return new Promise((i,o)=>{const a=new Cx;a.listenOnce(Sx.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case _u.NO_ERROR:const c=a.getResponseJson();S("Connection","XHR received:",JSON.stringify(c)),i(c);break;case _u.TIMEOUT:S("Connection",'RPC "'+e+'" timed out'),o(new E(y.DEADLINE_EXCEEDED,"Request time out"));break;case _u.HTTP_ERROR:const l=a.getStatus();if(S("Connection",'RPC "'+e+'" failed with status:',l,"response text:",a.getResponseText()),l>0){const h=a.getResponseJson().error;if(h&&h.status&&h.message){const f=function(p){const g=p.toLowerCase().replace(/_/g,"-");return Object.values(y).indexOf(g)>=0?g:y.UNKNOWN}(h.status);o(new E(f,h.message))}else o(new E(y.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new E(y.UNAVAILABLE,"Connection failed."));break;default:L()}}finally{S("Connection",'RPC "'+e+'" completed.')}});const u=JSON.stringify(s);a.send(n,"POST",u,r,15)})}Ur(e,n,r){const s=[this.kr,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=Tx(),o=Ix(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(a.xmlHttpFactory=new Ax({})),this.Fr(a.initMessageHeaders,n,r),zT()||JT()||XT()||ZT()||eI()||YT()||(a.httpHeadersOverwriteParam="$httpHeaders");const u=s.join("");S("Connection","Creating WebChannel: "+u,a);const c=i.createWebChannel(u,a);let l=!1,h=!1;const f=new mC({Ar:g=>{h?S("Connection","Not sending because WebChannel is closed:",g):(l||(S("Connection","Opening WebChannel transport."),c.open(),l=!0),S("Connection","WebChannel sending:",g),c.send(g))},Rr:()=>c.close()}),p=(g,T,x)=>{g.listen(T,M=>{try{x(M)}catch(ie){setTimeout(()=>{throw ie},0)}})};return p(c,lo.EventType.OPEN,()=>{h||S("Connection","WebChannel transport opened.")}),p(c,lo.EventType.CLOSE,()=>{h||(h=!0,S("Connection","WebChannel transport closed"),f.Cr())}),p(c,lo.EventType.ERROR,g=>{h||(h=!0,di("Connection","WebChannel transport errored:",g),f.Cr(new E(y.UNAVAILABLE,"The operation could not be completed")))}),p(c,lo.EventType.MESSAGE,g=>{var T;if(!h){const x=g.data[0];j(!!x);const M=x,ie=M.error||((T=M[0])===null||T===void 0?void 0:T.error);if(ie){S("Connection","WebChannel received error:",ie);const ue=ie.status;let ce=function(xt){const q=xe[xt];if(q!==void 0)return Fg(q)}(ue),st=ie.message;ce===void 0&&(ce=y.INTERNAL,st="Unknown error status: "+ue+" with message "+ie.message),h=!0,f.Cr(new E(ce,st)),c.close()}else S("Connection","WebChannel received:",x),f.Nr(x)}}),p(o,xx.STAT_EVENT,g=>{g.stat===$f.PROXY?S("Connection","Detected buffering proxy"):g.stat===$f.NOPROXY&&S("Connection","Detected no buffering proxy")}),setTimeout(()=>{f.Dr()},0),f}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function py(){return typeof window!="undefined"?window:null}function Co(){return typeof document!="undefined"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hi(t){return new yA(t,!0)}class eh{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Sn=e,this.timerId=n,this.qr=r,this.Kr=s,this.Gr=i,this.jr=0,this.Qr=null,this.Wr=Date.now(),this.reset()}reset(){this.jr=0}zr(){this.jr=this.Gr}Hr(e){this.cancel();const n=Math.floor(this.jr+this.Jr()),r=Math.max(0,Date.now()-this.Wr),s=Math.max(0,n-r);s>0&&S("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.jr} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Qr=this.Sn.enqueueAfterDelay(this.timerId,s,()=>(this.Wr=Date.now(),e())),this.jr*=this.Kr,this.jr<this.qr&&(this.jr=this.qr),this.jr>this.Gr&&(this.jr=this.Gr)}Yr(){this.Qr!==null&&(this.Qr.skipDelay(),this.Qr=null)}cancel(){this.Qr!==null&&(this.Qr.cancel(),this.Qr=null)}Jr(){return(Math.random()-.5)*this.jr}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class my{constructor(e,n,r,s,i,o,a,u){this.Sn=e,this.Xr=r,this.Zr=s,this.eo=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.no=0,this.so=null,this.io=null,this.stream=null,this.ro=new eh(e,n)}oo(){return this.state===1||this.state===5||this.co()}co(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.uo()}async stop(){this.oo()&&await this.close(0)}ao(){this.state=0,this.ro.reset()}ho(){this.co()&&this.so===null&&(this.so=this.Sn.enqueueAfterDelay(this.Xr,6e4,()=>this.lo()))}fo(e){this._o(),this.stream.send(e)}async lo(){if(this.co())return this.close(0)}_o(){this.so&&(this.so.cancel(),this.so=null)}wo(){this.io&&(this.io.cancel(),this.io=null)}async close(e,n){this._o(),this.wo(),this.ro.cancel(),this.no++,e!==4?this.ro.reset():n&&n.code===y.RESOURCE_EXHAUSTED?(Ae(n.toString()),Ae("Using maximum backoff delay to prevent overloading the backend."),this.ro.zr()):n&&n.code===y.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.mo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.vr(n)}mo(){}auth(){this.state=1;const e=this.yo(this.no),n=this.no;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.no===n&&this.po(r,s)},r=>{e(()=>{const s=new E(y.UNKNOWN,"Fetching auth token failed: "+r.message);return this.Io(s)})})}po(e,n){const r=this.yo(this.no);this.stream=this.Eo(e,n),this.stream.Pr(()=>{r(()=>(this.state=2,this.io=this.Sn.enqueueAfterDelay(this.Zr,1e4,()=>(this.co()&&(this.state=3),Promise.resolve())),this.listener.Pr()))}),this.stream.vr(s=>{r(()=>this.Io(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}uo(){this.state=5,this.ro.Hr(async()=>{this.state=0,this.start()})}Io(e){return S("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}yo(e){return n=>{this.Sn.enqueueAndForget(()=>this.no===e?n():(S("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class yC extends my{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.O=i}Eo(e,n){return this.eo.Ur("Listen",e,n)}onMessage(e){this.ro.reset();const n=_A(this.O,e),r=function(s){if(!("targetChange"in s))return B.min();const i=s.targetChange;return i.targetIds&&i.targetIds.length?B.min():i.readTime?qe(i.readTime):B.min()}(e);return this.listener.To(n,r)}Ao(e){const n={};n.database=_i(this.O),n.addTarget=function(s,i){let o;const a=i.target;return o=Jo(a)?{documents:Kg(s,a)}:{query:Gg(s,a)},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0?o.resumeToken=$g(s,i.resumeToken):i.snapshotVersion.compareTo(B.min())>0&&(o.readTime=vi(s,i.snapshotVersion.toTimestamp())),o}(this.O,e);const r=EA(this.O,e);r&&(n.labels=r),this.fo(n)}Ro(e){const n={};n.database=_i(this.O),n.removeTarget=e,this.fo(n)}}class vC extends my{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.O=i,this.Po=!1}get bo(){return this.Po}start(){this.Po=!1,this.lastStreamToken=void 0,super.start()}mo(){this.Po&&this.vo([])}Eo(e,n){return this.eo.Ur("Write",e,n)}onMessage(e){if(j(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Po){this.ro.reset();const n=bA(e.writeResults,e.commitTime),r=qe(e.commitTime);return this.listener.Vo(r,n)}return j(!e.writeResults||e.writeResults.length===0),this.Po=!0,this.listener.So()}Do(){const e={};e.database=_i(this.O),this.fo(e)}vo(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>bi(this.O,r))};this.fo(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wC extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.eo=r,this.O=s,this.Co=!1}No(){if(this.Co)throw new E(y.FAILED_PRECONDITION,"The client has already been terminated.")}Mr(e,n,r){return this.No(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.eo.Mr(e,n,r,s,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new E(y.UNKNOWN,s.toString())})}Lr(e,n,r){return this.No(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.eo.Lr(e,n,r,s,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new E(y.UNKNOWN,s.toString())})}terminate(){this.Co=!0}}class _C{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.xo=0,this.ko=null,this.Oo=!0}Mo(){this.xo===0&&(this.$o("Unknown"),this.ko=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.ko=null,this.Fo("Backend didn't respond within 10 seconds."),this.$o("Offline"),Promise.resolve())))}Bo(e){this.state==="Online"?this.$o("Unknown"):(this.xo++,this.xo>=1&&(this.Lo(),this.Fo(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.$o("Offline")))}set(e){this.Lo(),this.xo=0,e==="Online"&&(this.Oo=!1),this.$o(e)}$o(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}Fo(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.Oo?(Ae(n),this.Oo=!1):S("OnlineStateTracker",n)}Lo(){this.ko!==null&&(this.ko.cancel(),this.ko=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bC{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Uo=[],this.qo=new Map,this.Ko=new Set,this.Go=[],this.jo=i,this.jo.mr(o=>{r.enqueueAndForget(async()=>{Un(this)&&(S("RemoteStore","Restarting streams for network reachability change."),await async function(a){const u=D(a);u.Ko.add(4),await Cs(u),u.Qo.set("Unknown"),u.Ko.delete(4),await zi(u)}(this))})}),this.Qo=new _C(r,s)}}async function zi(t){if(Un(t))for(const e of t.Go)await e(!0)}async function Cs(t){for(const e of t.Go)await e(!1)}function Ba(t,e){const n=D(t);n.qo.has(e.targetId)||(n.qo.set(e.targetId,e),rh(n)?nh(n):Os(n).co()&&th(n,e))}function Ei(t,e){const n=D(t),r=Os(n);n.qo.delete(e),r.co()&&gy(n,e),n.qo.size===0&&(r.co()?r.ho():Un(n)&&n.Qo.set("Unknown"))}function th(t,e){t.Wo.Z(e.targetId),Os(t).Ao(e)}function gy(t,e){t.Wo.Z(e),Os(t).Ro(e)}function nh(t){t.Wo=new pA({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Tt:e=>t.qo.get(e)||null}),Os(t).start(),t.Qo.Mo()}function rh(t){return Un(t)&&!Os(t).oo()&&t.qo.size>0}function Un(t){return D(t).Ko.size===0}function yy(t){t.Wo=void 0}async function EC(t){t.qo.forEach((e,n)=>{th(t,e)})}async function TC(t,e){yy(t),rh(t)?(t.Qo.Bo(e),nh(t)):t.Qo.set("Unknown")}async function IC(t,e,n){if(t.Qo.set("Online"),e instanceof qg&&e.state===2&&e.cause)try{await async function(r,s){const i=s.cause;for(const o of s.targetIds)r.qo.has(o)&&(await r.remoteSyncer.rejectListen(o,i),r.qo.delete(o),r.Wo.removeTarget(o))}(t,e)}catch(r){S("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await sa(t,r)}else if(e instanceof Ao?t.Wo.ct(e):e instanceof Lg?t.Wo._t(e):t.Wo.ht(e),!n.isEqual(B.min()))try{const r=await cy(t.localStore);n.compareTo(r)>=0&&await function(s,i){const o=s.Wo.yt(i);return o.targetChanges.forEach((a,u)=>{if(a.resumeToken.approximateByteSize()>0){const c=s.qo.get(u);c&&s.qo.set(u,c.withResumeToken(a.resumeToken,i))}}),o.targetMismatches.forEach(a=>{const u=s.qo.get(a);if(!u)return;s.qo.set(a,u.withResumeToken(De.EMPTY_BYTE_STRING,u.snapshotVersion)),gy(s,a);const c=new On(u.target,a,1,u.sequenceNumber);th(s,c)}),s.remoteSyncer.applyRemoteEvent(o)}(t,n)}catch(r){S("RemoteStore","Failed to raise snapshot:",r),await sa(t,r)}}async function sa(t,e,n){if(!Sr(e))throw e;t.Ko.add(1),await Cs(t),t.Qo.set("Offline"),n||(n=()=>cy(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{S("RemoteStore","Retrying IndexedDB access"),await n(),t.Ko.delete(1),await zi(t)})}function vy(t,e){return e().catch(n=>sa(t,n,e))}async function ks(t){const e=D(t),n=Mn(e);let r=e.Uo.length>0?e.Uo[e.Uo.length-1].batchId:-1;for(;SC(e);)try{const s=await tC(e.localStore,r);if(s===null){e.Uo.length===0&&n.ho();break}r=s.batchId,xC(e,s)}catch(s){await sa(e,s)}wy(e)&&_y(e)}function SC(t){return Un(t)&&t.Uo.length<10}function xC(t,e){t.Uo.push(e);const n=Mn(t);n.co()&&n.bo&&n.vo(e.mutations)}function wy(t){return Un(t)&&!Mn(t).oo()&&t.Uo.length>0}function _y(t){Mn(t).start()}async function AC(t){Mn(t).Do()}async function CC(t){const e=Mn(t);for(const n of t.Uo)e.vo(n.mutations)}async function kC(t,e,n){const r=t.Uo.shift(),s=Ul.from(r,e,n);await vy(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await ks(t)}async function OC(t,e){e&&Mn(t).bo&&await async function(n,r){if(s=r.code,Mg(s)&&s!==y.ABORTED){const i=n.Uo.shift();Mn(n).ao(),await vy(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,r)),await ks(n)}var s}(t,e),wy(t)&&_y(t)}async function Td(t,e){const n=D(t);n.asyncQueue.verifyOperationInProgress(),S("RemoteStore","RemoteStore received new credentials");const r=Un(n);n.Ko.add(3),await Cs(n),r&&n.Qo.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ko.delete(3),await zi(n)}async function pc(t,e){const n=D(t);e?(n.Ko.delete(2),await zi(n)):e||(n.Ko.add(2),await Cs(n),n.Qo.set("Unknown"))}function Os(t){return t.zo||(t.zo=function(e,n,r){const s=D(e);return s.No(),new yC(n,s.eo,s.authCredentials,s.appCheckCredentials,s.O,r)}(t.datastore,t.asyncQueue,{Pr:EC.bind(null,t),vr:TC.bind(null,t),To:IC.bind(null,t)}),t.Go.push(async e=>{e?(t.zo.ao(),rh(t)?nh(t):t.Qo.set("Unknown")):(await t.zo.stop(),yy(t))})),t.zo}function Mn(t){return t.Ho||(t.Ho=function(e,n,r){const s=D(e);return s.No(),new vC(n,s.eo,s.authCredentials,s.appCheckCredentials,s.O,r)}(t.datastore,t.asyncQueue,{Pr:AC.bind(null,t),vr:OC.bind(null,t),So:CC.bind(null,t),Vo:kC.bind(null,t)}),t.Go.push(async e=>{e?(t.Ho.ao(),await ks(t)):(await t.Ho.stop(),t.Uo.length>0&&(S("RemoteStore",`Stopping write stream with ${t.Uo.length} pending writes`),t.Uo=[]))})),t.Ho}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sh{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Fe,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new sh(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new E(y.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ds(t,e){if(Ae("AsyncQueue",`${e}: ${t}`),Sr(t))return new E(y.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr{constructor(e){this.comparator=e?(n,r)=>e(n,r)||R.comparator(n.key,r.key):(n,r)=>R.comparator(n.key,r.key),this.keyedMap=lc(),this.sortedSet=new Se(this.comparator)}static emptySet(e){return new Xr(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Xr)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Xr;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Id{constructor(){this.Jo=new Se(R.comparator)}track(e){const n=e.doc.key,r=this.Jo.get(n);r?e.type!==0&&r.type===3?this.Jo=this.Jo.insert(n,e):e.type===3&&r.type!==1?this.Jo=this.Jo.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.Jo=this.Jo.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.Jo=this.Jo.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.Jo=this.Jo.remove(n):e.type===1&&r.type===2?this.Jo=this.Jo.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.Jo=this.Jo.insert(n,{type:2,doc:e.doc}):L():this.Jo=this.Jo.insert(n,e)}Yo(){const e=[];return this.Jo.inorderTraversal((n,r)=>{e.push(r)}),e}}class ps{constructor(e,n,r,s,i,o,a,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u}static fromInitialDocuments(e,n,r,s){const i=[];return n.forEach(o=>{i.push({type:0,doc:o})}),new ps(e,n,Xr.emptySet(n),i,r,s,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ui(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(){this.Xo=void 0,this.listeners=[]}}class NC{constructor(){this.queries=new As(e=>Sg(e),Ui),this.onlineState="Unknown",this.Zo=new Set}}async function ih(t,e){const n=D(t),r=e.query;let s=!1,i=n.queries.get(r);if(i||(s=!0,i=new DC),s)try{i.Xo=await n.onListen(r)}catch(o){const a=Ds(o,`Initialization of query '${uc(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,i),i.listeners.push(e),e.tc(n.onlineState),i.Xo&&e.ec(i.Xo)&&ah(n)}async function oh(t,e){const n=D(t),r=e.query;let s=!1;const i=n.queries.get(r);if(i){const o=i.listeners.indexOf(e);o>=0&&(i.listeners.splice(o,1),s=i.listeners.length===0)}if(s)return n.queries.delete(r),n.onUnlisten(r)}function RC(t,e){const n=D(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.listeners)a.ec(s)&&(r=!0);o.Xo=s}}r&&ah(n)}function PC(t,e,n){const r=D(t),s=r.queries.get(e);if(s)for(const i of s.listeners)i.onError(n);r.queries.delete(e)}function ah(t){t.Zo.forEach(e=>{e.next()})}class uh{constructor(e,n,r){this.query=e,this.nc=n,this.sc=!1,this.ic=null,this.onlineState="Unknown",this.options=r||{}}ec(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new ps(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let n=!1;return this.sc?this.rc(e)&&(this.nc.next(e),n=!0):this.oc(e,this.onlineState)&&(this.cc(e),n=!0),this.ic=e,n}onError(e){this.nc.error(e)}tc(e){this.onlineState=e;let n=!1;return this.ic&&!this.sc&&this.oc(this.ic,e)&&(this.cc(this.ic),n=!0),n}oc(e,n){if(!e.fromCache)return!0;const r=n!=="Offline";return(!this.options.uc||!r)&&(!e.docs.isEmpty()||n==="Offline")}rc(e){if(e.docChanges.length>0)return!0;const n=this.ic&&this.ic.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}cc(e){e=ps.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.sc=!0,this.nc.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MC{constructor(e,n){this.payload=e,this.byteLength=n}ac(){return"metadata"in this.payload}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sd{constructor(e){this.O=e}Gs(e){return Wt(this.O,e)}js(e){return e.metadata.exists?Vg(this.O,e.document,!1):be.newNoDocument(this.Gs(e.metadata.name),this.Qs(e.metadata.readTime))}Qs(e){return qe(e)}}class FC{constructor(e,n,r){this.hc=e,this.localStore=n,this.O=r,this.queries=[],this.documents=[],this.progress=by(e)}lc(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;return e.payload.namedQuery?this.queries.push(e.payload.namedQuery):e.payload.documentMetadata?(this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++n):e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++n),n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}fc(e){const n=new Map,r=new Sd(this.O);for(const s of e)if(s.metadata.queries){const i=r.Gs(s.metadata.name);for(const o of s.metadata.queries){const a=(n.get(o)||ae()).add(i);n.set(o,a)}}return n}async complete(){const e=await rC(this.localStore,new Sd(this.O),this.documents,this.hc.id),n=this.fc(this.documents);for(const r of this.queries)await sC(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",new YA(Object.assign({},this.progress),e)}}function by(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ey{constructor(e){this.key=e}}class Ty{constructor(e){this.key=e}}class Iy{constructor(e,n){this.query=e,this.dc=n,this._c=null,this.current=!1,this.wc=ae(),this.mutatedKeys=ae(),this.mc=xg(e),this.gc=new Xr(this.mc)}get yc(){return this.dc}Ic(e,n){const r=n?n.Ec:new Id,s=n?n.gc:this.gc;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const u=So(this.query)&&s.size===this.query.limit?s.last():null,c=Xo(this.query)&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((l,h)=>{const f=s.get(l),p=Ml(this.query,h)?h:null,g=!!f&&this.mutatedKeys.has(f.key),T=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let x=!1;f&&p?f.data.isEqual(p.data)?g!==T&&(r.track({type:3,doc:p}),x=!0):this.Tc(f,p)||(r.track({type:2,doc:p}),x=!0,(u&&this.mc(p,u)>0||c&&this.mc(p,c)<0)&&(a=!0)):!f&&p?(r.track({type:0,doc:p}),x=!0):f&&!p&&(r.track({type:1,doc:f}),x=!0,(u||c)&&(a=!0)),x&&(p?(o=o.add(p),i=T?i.add(l):i.delete(l)):(o=o.delete(l),i=i.delete(l)))}),So(this.query)||Xo(this.query))for(;o.size>this.query.limit;){const l=So(this.query)?o.last():o.first();o=o.delete(l.key),i=i.delete(l.key),r.track({type:1,doc:l})}return{gc:o,Ec:r,ks:a,mutatedKeys:i}}Tc(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r){const s=this.gc;this.gc=e.gc,this.mutatedKeys=e.mutatedKeys;const i=e.Ec.Yo();i.sort((c,l)=>function(h,f){const p=g=>{switch(g){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return L()}};return p(h)-p(f)}(c.type,l.type)||this.mc(c.doc,l.doc)),this.Ac(r);const o=n?this.Rc():[],a=this.wc.size===0&&this.current?1:0,u=a!==this._c;return this._c=a,i.length!==0||u?{snapshot:new ps(this.query,e.gc,s,i,e.mutatedKeys,a===0,u,!1),Pc:o}:{Pc:o}}tc(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({gc:this.gc,Ec:new Id,mutatedKeys:this.mutatedKeys,ks:!1},!1)):{Pc:[]}}bc(e){return!this.dc.has(e)&&!!this.gc.has(e)&&!this.gc.get(e).hasLocalMutations}Ac(e){e&&(e.addedDocuments.forEach(n=>this.dc=this.dc.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.dc=this.dc.delete(n)),this.current=e.current)}Rc(){if(!this.current)return[];const e=this.wc;this.wc=ae(),this.gc.forEach(r=>{this.bc(r.key)&&(this.wc=this.wc.add(r.key))});const n=[];return e.forEach(r=>{this.wc.has(r)||n.push(new Ty(r))}),this.wc.forEach(r=>{e.has(r)||n.push(new Ey(r))}),n}vc(e){this.dc=e.Ks,this.wc=ae();const n=this.Ic(e.documents);return this.applyChanges(n,!0)}Vc(){return ps.fromInitialDocuments(this.query,this.gc,this.mutatedKeys,this._c===0)}}class LC{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class qC{constructor(e){this.key=e,this.Sc=!1}}class $C{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Dc={},this.Cc=new As(a=>Sg(a),Ui),this.Nc=new Map,this.xc=new Set,this.kc=new Se(R.comparator),this.Oc=new Map,this.Mc=new Jl,this.$c={},this.Fc=new Map,this.Bc=yr.Je(),this.onlineState="Unknown",this.Lc=void 0}get isPrimaryClient(){return this.Lc===!0}}async function UC(t,e){const n=dh(t);let r,s;const i=n.Cc.get(e);if(i)r=i.targetId,n.sharedClientState.addLocalQueryTarget(r),s=i.view.Vc();else{const o=await fs(n.localStore,Dt(e));n.isPrimaryClient&&Ba(n.remoteStore,o);const a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,s=await ch(n,e,r,a==="current")}return s}async function ch(t,e,n,r){t.Uc=(l,h,f)=>async function(p,g,T,x){let M=g.view.Ic(T);M.ks&&(M=await ta(p.localStore,g.query,!1).then(({documents:ce})=>g.view.Ic(ce,M)));const ie=x&&x.targetChanges.get(g.targetId),ue=g.view.applyChanges(M,p.isPrimaryClient,ie);return mc(p,g.targetId,ue.Pc),ue.snapshot}(t,l,h,f);const s=await ta(t.localStore,e,!0),i=new Iy(e,s.Ks),o=i.Ic(s.documents),a=Gi.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline"),u=i.applyChanges(o,t.isPrimaryClient,a);mc(t,n,u.Pc);const c=new LC(e,n,i);return t.Cc.set(e,c),t.Nc.has(n)?t.Nc.get(n).push(e):t.Nc.set(n,[e]),u.snapshot}async function BC(t,e){const n=D(t),r=n.Cc.get(e),s=n.Nc.get(r.targetId);if(s.length>1)return n.Nc.set(r.targetId,s.filter(i=>!Ui(i,e))),void n.Cc.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await ds(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),Ei(n.remoteStore,r.targetId),ms(n,r.targetId)}).catch(xr)):(ms(n,r.targetId),await ds(n.localStore,r.targetId,!0))}async function jC(t,e,n){const r=ph(t);try{const s=await function(i,o){const a=D(i),u=Le.now(),c=o.reduce((h,f)=>h.add(f.key),ae());let l;return a.persistence.runTransaction("Locally write mutations","readwrite",h=>a.Us.Es(h,c).next(f=>{l=f;const p=[];for(const g of o){const T=aA(g,l.get(g.key));T!=null&&p.push(new Ir(g.key,T,_g(T.value.mapValue),Ce.exists(!0)))}return a.gs.addMutationBatch(h,u,p,o)})).then(h=>(h.applyToLocalDocumentSet(l),{batchId:h.batchId,changes:l}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(i,o,a){let u=i.$c[i.currentUser.toKey()];u||(u=new Se(Y)),u=u.insert(o,a),i.$c[i.currentUser.toKey()]=u}(r,s.batchId,n),await pn(r,s.changes),await ks(r.remoteStore)}catch(s){const i=Ds(s,"Failed to persist write");n.reject(i)}}async function Sy(t,e){const n=D(t);try{const r=await eC(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Oc.get(i);o&&(j(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.Sc=!0:s.modifiedDocuments.size>0?j(o.Sc):s.removedDocuments.size>0&&(j(o.Sc),o.Sc=!1))}),await pn(n,r,e)}catch(r){await xr(r)}}function xd(t,e,n){const r=D(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Cc.forEach((i,o)=>{const a=o.view.tc(e);a.snapshot&&s.push(a.snapshot)}),function(i,o){const a=D(i);a.onlineState=o;let u=!1;a.queries.forEach((c,l)=>{for(const h of l.listeners)h.tc(o)&&(u=!0)}),u&&ah(a)}(r.eventManager,e),s.length&&r.Dc.To(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function VC(t,e,n){const r=D(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Oc.get(e),i=s&&s.key;if(i){let o=new Se(R.comparator);o=o.insert(i,be.newNoDocument(i,B.min()));const a=ae().add(i),u=new Ki(B.min(),new Map,new _e(Y),o,a);await Sy(r,u),r.kc=r.kc.remove(i),r.Oc.delete(e),fh(r)}else await ds(r.localStore,e,!1).then(()=>ms(r,e,n)).catch(xr)}async function KC(t,e){const n=D(t),r=e.batch.batchId;try{const s=await ZA(n.localStore,e);hh(n,r,null),lh(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await pn(n,s)}catch(s){await xr(s)}}async function GC(t,e,n){const r=D(t);try{const s=await function(i,o){const a=D(i);return a.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let c;return a.gs.lookupMutationBatch(u,o).next(l=>(j(l!==null),c=l.keys(),a.gs.removeMutationBatch(u,l))).next(()=>a.gs.performConsistencyCheck(u)).next(()=>a.Us.Es(u,c))})}(r.localStore,e);hh(r,e,n),lh(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await pn(r,s)}catch(s){await xr(s)}}async function HC(t,e){const n=D(t);Un(n.remoteStore)||S("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(i){const o=D(i);return o.persistence.runTransaction("Get highest unacknowledged batch id","readonly",a=>o.gs.getHighestUnacknowledgedBatchId(a))}(n.localStore);if(r===-1)return void e.resolve();const s=n.Fc.get(r)||[];s.push(e),n.Fc.set(r,s)}catch(r){const s=Ds(r,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}}function lh(t,e){(t.Fc.get(e)||[]).forEach(n=>{n.resolve()}),t.Fc.delete(e)}function hh(t,e,n){const r=D(t);let s=r.$c[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.$c[r.currentUser.toKey()]=s}}function ms(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Nc.get(e))t.Cc.delete(r),n&&t.Dc.qc(r,n);t.Nc.delete(e),t.isPrimaryClient&&t.Mc.si(e).forEach(r=>{t.Mc.containsKey(r)||xy(t,r)})}function xy(t,e){t.xc.delete(e.path.canonicalString());const n=t.kc.get(e);n!==null&&(Ei(t.remoteStore,n),t.kc=t.kc.remove(e),t.Oc.delete(n),fh(t))}function mc(t,e,n){for(const r of n)r instanceof Ey?(t.Mc.addReference(r.key,e),zC(t,r)):r instanceof Ty?(S("SyncEngine","Document no longer in limbo: "+r.key),t.Mc.removeReference(r.key,e),t.Mc.containsKey(r.key)||xy(t,r.key)):L()}function zC(t,e){const n=e.key,r=n.path.canonicalString();t.kc.get(n)||t.xc.has(r)||(S("SyncEngine","New document in limbo: "+n),t.xc.add(r),fh(t))}function fh(t){for(;t.xc.size>0&&t.kc.size<t.maxConcurrentLimboResolutions;){const e=t.xc.values().next().value;t.xc.delete(e);const n=new R(se.fromString(e)),r=t.Bc.next();t.Oc.set(r,new qC(n)),t.kc=t.kc.insert(n,r),Ba(t.remoteStore,new On(Dt(xs(n.path)),r,2,bt.A))}}async function pn(t,e,n){const r=D(t),s=[],i=[],o=[];r.Cc.isEmpty()||(r.Cc.forEach((a,u)=>{o.push(r.Uc(u,e,n).then(c=>{if(c){r.isPrimaryClient&&r.sharedClientState.updateQueryState(u.targetId,c.fromCache?"not-current":"current"),s.push(c);const l=Yl.Ss(u.targetId,c);i.push(l)}}))}),await Promise.all(o),r.Dc.To(s),await async function(a,u){const c=D(a);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",l=>v.forEach(u,h=>v.forEach(h.vs,f=>c.persistence.referenceDelegate.addReference(l,h.targetId,f)).next(()=>v.forEach(h.Vs,f=>c.persistence.referenceDelegate.removeReference(l,h.targetId,f)))))}catch(l){if(!Sr(l))throw l;S("LocalStore","Failed to update sequence numbers: "+l)}for(const l of u){const h=l.targetId;if(!l.fromCache){const f=c.Ms.get(h),p=f.snapshotVersion,g=f.withLastLimboFreeSnapshotVersion(p);c.Ms=c.Ms.insert(h,g)}}}(r.localStore,i))}async function WC(t,e){const n=D(t);if(!n.currentUser.isEqual(e)){S("SyncEngine","User change. New user:",e.toKey());const r=await uy(n.localStore,e);n.currentUser=e,function(s,i){s.Fc.forEach(o=>{o.forEach(a=>{a.reject(new E(y.CANCELLED,i))})}),s.Fc.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await pn(n,r.qs)}}function QC(t,e){const n=D(t),r=n.Oc.get(e);if(r&&r.Sc)return ae().add(r.key);{let s=ae();const i=n.Nc.get(e);if(!i)return s;for(const o of i){const a=n.Cc.get(o);s=s.unionWith(a.view.yc)}return s}}async function YC(t,e){const n=D(t),r=await ta(n.localStore,e.query,!0),s=e.view.vc(r);return n.isPrimaryClient&&mc(n,e.targetId,s.Pc),s}async function JC(t){const e=D(t);return fy(e.localStore).then(n=>pn(e,n))}async function XC(t,e,n,r){const s=D(t),i=await function(o,a){const u=D(o),c=D(u.gs);return u.persistence.runTransaction("Lookup mutation documents","readonly",l=>c.Ge(l,a).next(h=>h?u.Us.Es(l,h):v.resolve(null)))}(s.localStore,e);i!==null?(n==="pending"?await ks(s.remoteStore):n==="acknowledged"||n==="rejected"?(hh(s,e,r||null),lh(s,e),function(o,a){D(D(o).gs).Qe(a)}(s.localStore,e)):L(),await pn(s,i)):S("SyncEngine","Cannot apply mutation batch with id: "+e)}async function ZC(t,e){const n=D(t);if(dh(n),ph(n),e===!0&&n.Lc!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),s=await Ad(n,r.toArray());n.Lc=!0,await pc(n.remoteStore,!0);for(const i of s)Ba(n.remoteStore,i)}else if(e===!1&&n.Lc!==!1){const r=[];let s=Promise.resolve();n.Nc.forEach((i,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):s=s.then(()=>(ms(n,o),ds(n.localStore,o,!0))),Ei(n.remoteStore,o)}),await s,await Ad(n,r),function(i){const o=D(i);o.Oc.forEach((a,u)=>{Ei(o.remoteStore,u)}),o.Mc.ii(),o.Oc=new Map,o.kc=new Se(R.comparator)}(n),n.Lc=!1,await pc(n.remoteStore,!1)}}async function Ad(t,e,n){const r=D(t),s=[],i=[];for(const o of e){let a;const u=r.Nc.get(o);if(u&&u.length!==0){a=await fs(r.localStore,Dt(u[0]));for(const c of u){const l=r.Cc.get(c),h=await YC(r,l);h.snapshot&&i.push(h.snapshot)}}else{const c=await hy(r.localStore,o);a=await fs(r.localStore,c),await ch(r,Ay(c),o,!1)}s.push(a)}return r.Dc.To(i),s}function Ay(t){return Tg(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function ek(t){const e=D(t);return D(D(e.localStore).persistence).ds()}async function tk(t,e,n,r){const s=D(t);if(s.Lc)S("SyncEngine","Ignoring unexpected query state notification.");else if(s.Nc.has(e))switch(n){case"current":case"not-current":{const i=await fy(s.localStore),o=Ki.createSynthesizedRemoteEventForCurrentChange(e,n==="current");await pn(s,i,o);break}case"rejected":await ds(s.localStore,e,!0),ms(s,e,r);break;default:L()}}async function nk(t,e,n){const r=dh(t);if(r.Lc){for(const s of e){if(r.Nc.has(s)){S("SyncEngine","Adding an already active target "+s);continue}const i=await hy(r.localStore,s),o=await fs(r.localStore,i);await ch(r,Ay(i),o.targetId,!1),Ba(r.remoteStore,o)}for(const s of n)r.Nc.has(s)&&await ds(r.localStore,s,!1).then(()=>{Ei(r.remoteStore,s),ms(r,s)}).catch(xr)}}function dh(t){const e=D(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Sy.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=QC.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=VC.bind(null,e),e.Dc.To=RC.bind(null,e.eventManager),e.Dc.qc=PC.bind(null,e.eventManager),e}function ph(t){const e=D(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=KC.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=GC.bind(null,e),e}function rk(t,e,n){const r=D(t);(async function(s,i,o){try{const a=await i.getMetadata();if(await function(h,f){const p=D(h),g=qe(f.createTime);return p.persistence.runTransaction("hasNewerBundle","readonly",T=>p.Kn.getBundleMetadata(T,f.id)).then(T=>!!T&&T.createTime.compareTo(g)>=0)}(s.localStore,a))return await i.close(),void o._completeWith(function(h){return{taskState:"Success",documentsLoaded:h.totalDocuments,bytesLoaded:h.totalBytes,totalDocuments:h.totalDocuments,totalBytes:h.totalBytes}}(a));o._updateProgress(by(a));const u=new FC(a,s.localStore,i.O);let c=await i.Kc();for(;c;){const h=await u.lc(c);h&&o._updateProgress(h),c=await i.Kc()}const l=await u.complete();await pn(s,l.ws,void 0),await function(h,f){const p=D(h);return p.persistence.runTransaction("Save bundle","readwrite",g=>p.Kn.saveBundleMetadata(g,f))}(s.localStore,a),o._completeWith(l.progress)}catch(a){di("SyncEngine",`Loading bundle failed with ${a}`),o._failWith(a)}})(r,e,n).then(()=>{r.sharedClientState.notifyBundleLoaded()})}class Cy{constructor(){this.synchronizeTabs=!1}async initialize(e){this.O=Hi(e.databaseInfo.databaseId),this.sharedClientState=this.Gc(e),this.persistence=this.jc(e),await this.persistence.start(),this.gcScheduler=this.Qc(e),this.localStore=this.Wc(e)}Qc(e){return null}Wc(e){return ay(this.persistence,new oy,e.initialUser,this.O)}jc(e){return new hC(Xl.bi,this.O)}Gc(e){return new dy}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class ky extends Cy{constructor(e,n,r){super(),this.zc=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await nC(this.localStore),await this.zc.initialize(this,e),await ph(this.zc.syncEngine),await ks(this.zc.remoteStore),await this.persistence.Hn(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(this.localStore),Promise.resolve()))}Wc(e){return ay(this.persistence,new oy,e.initialUser,this.O)}Qc(e){const n=this.persistence.referenceDelegate.garbageCollector;return new KA(n,e.asyncQueue)}jc(e){const n=Ql(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?mt.withCacheSize(this.cacheSizeBytes):mt.DEFAULT;return new Wl(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,py(),Co(),this.O,this.sharedClientState,!!this.forceOwnership)}Gc(e){return new dy}}class sk extends ky{constructor(e,n){super(e,n,!1),this.zc=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.zc.syncEngine;this.sharedClientState instanceof xu&&(this.sharedClientState.syncEngine={hr:XC.bind(null,n),lr:tk.bind(null,n),dr:nk.bind(null,n),ds:ek.bind(null,n),ar:JC.bind(null,n)},await this.sharedClientState.start()),await this.persistence.Hn(async r=>{await ZC(this.zc.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):r||this.gcScheduler.stop())})}Gc(e){const n=py();if(!xu.Vt(n))throw new E(y.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=Ql(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new xu(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class mh{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>xd(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=WC.bind(null,this.syncEngine),await pc(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new NC}createDatastore(e){const n=Hi(e.databaseInfo.databaseId),r=(s=e.databaseInfo,new gC(s));var s;return function(i,o,a,u){return new wC(i,o,a,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return n=this.localStore,r=this.datastore,s=e.asyncQueue,i=a=>xd(this.syncEngine,a,0),o=Ed.Vt()?new Ed:new dC,new bC(n,r,s,i,o);var n,r,s,i,o}createSyncEngine(e,n){return function(r,s,i,o,a,u,c){const l=new $C(r,s,i,o,a,u);return c&&(l.Lc=!0),l}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(e){const n=D(e);S("RemoteStore","RemoteStore shutting down."),n.Ko.add(5),await Cs(n),n.jo.shutdown(),n.Qo.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cd(t,e=10240){let n=0;return{async read(){if(n<t.byteLength){const r={value:t.slice(n,n+e),done:!1};return n+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.reject("unimplemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Hc(this.observer.next,e)}error(e){this.observer.error?this.Hc(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}Jc(){this.muted=!0}Hc(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ik{constructor(e,n){this.Yc=e,this.O=n,this.metadata=new Fe,this.buffer=new Uint8Array,this.Xc=new TextDecoder("utf-8"),this.Zc().then(r=>{r&&r.ac()?this.metadata.resolve(r.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.payload)}`))},r=>this.metadata.reject(r))}close(){return this.Yc.cancel()}async getMetadata(){return this.metadata.promise}async Kc(){return await this.getMetadata(),this.Zc()}async Zc(){const e=await this.tu();if(e===null)return null;const n=this.Xc.decode(e),r=Number(n);isNaN(r)&&this.eu(`length string (${n}) is not valid number`);const s=await this.nu(r);return new MC(JSON.parse(s),e.length+r)}su(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async tu(){for(;this.su()<0&&!await this.iu(););if(this.buffer.length===0)return null;const e=this.su();e<0&&this.eu("Reached the end of bundle when a length string is expected.");const n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n}async nu(e){for(;this.buffer.length<e;)await this.iu()&&this.eu("Reached the end of bundle when more is expected.");const n=this.Xc.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n}eu(e){throw this.Yc.cancel(),new Error(`Invalid bundle format: ${e}`)}async iu(){const e=await this.Yc.read();if(!e.done){const n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ok{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new E(y.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const n=await async function(r,s){const i=D(r),o=_i(i.O)+"/documents",a={documents:s.map(h=>wi(i.O,h))},u=await i.Lr("BatchGetDocuments",o,a),c=new Map;u.forEach(h=>{const f=wA(i.O,h);c.set(f.key.toString(),f)});const l=[];return s.forEach(h=>{const f=c.get(h.toString());j(!!f),l.push(f)}),l}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Vi(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const s=R.fromPath(r);this.mutations.push(new Fl(s,this.precondition(s)))}),await async function(n,r){const s=D(n),i=_i(s.O)+"/documents",o={writes:r.map(a=>bi(s.O,a))};await s.Mr("Commit",i,o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw L();n=B.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new E(y.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?Ce.updateTime(n):Ce.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(B.min()))throw new E(y.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ce.updateTime(n)}return Ce.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ak{constructor(e,n,r,s){this.asyncQueue=e,this.datastore=n,this.updateFunction=r,this.deferred=s,this.ru=5,this.ro=new eh(this.asyncQueue,"transaction_retry")}run(){this.ru-=1,this.ou()}ou(){this.ro.Hr(async()=>{const e=new ok(this.datastore),n=this.cu(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(s=>{this.uu(s)}))}).catch(r=>{this.uu(r)})})}cu(e){try{const n=this.updateFunction(e);return!Tr(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}uu(e){this.ru>0&&this.au(e)?(this.ru-=1,this.asyncQueue.enqueueAndForget(()=>(this.ou(),Promise.resolve()))):this.deferred.reject(e)}au(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||!Mg(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uk{constructor(e,n,r,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Ve.UNAUTHENTICATED,this.clientId=mg.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async i=>{S("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(r,i=>(S("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new E(y.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Fe;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Ds(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Oy(t,e){t.asyncQueue.verifyOperationInProgress(),S("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await uy(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t.offlineComponents=e}async function Dy(t,e){t.asyncQueue.verifyOperationInProgress();const n=await gh(t);S("FirestoreClient","Initializing OnlineComponentProvider");const r=await t.getConfiguration();await e.initialize(n,r),t.setCredentialChangeListener(s=>Td(e.remoteStore,s)),t.setAppCheckTokenChangeListener((s,i)=>Td(e.remoteStore,i)),t.onlineComponents=e}async function gh(t){return t.offlineComponents||(S("FirestoreClient","Using default OfflineComponentProvider"),await Oy(t,new Cy)),t.offlineComponents}async function Va(t){return t.onlineComponents||(S("FirestoreClient","Using default OnlineComponentProvider"),await Dy(t,new mh)),t.onlineComponents}function Ny(t){return gh(t).then(e=>e.persistence)}function yh(t){return gh(t).then(e=>e.localStore)}function Ry(t){return Va(t).then(e=>e.remoteStore)}function vh(t){return Va(t).then(e=>e.syncEngine)}async function gs(t){const e=await Va(t),n=e.eventManager;return n.onListen=UC.bind(null,e.syncEngine),n.onUnlisten=BC.bind(null,e.syncEngine),n}function ck(t){return t.asyncQueue.enqueue(async()=>{const e=await Ny(t),n=await Ry(t);return e.setNetworkEnabled(!0),function(r){const s=D(r);return s.Ko.delete(0),zi(s)}(n)})}function lk(t){return t.asyncQueue.enqueue(async()=>{const e=await Ny(t),n=await Ry(t);return e.setNetworkEnabled(!1),async function(r){const s=D(r);s.Ko.add(0),await Cs(s),s.Qo.set("Offline")}(n)})}function hk(t,e){const n=new Fe;return t.asyncQueue.enqueueAndForget(async()=>async function(r,s,i){try{const o=await function(a,u){const c=D(a);return c.persistence.runTransaction("read document","readonly",l=>c.Us.ys(l,u))}(r,s);o.isFoundDocument()?i.resolve(o):o.isNoDocument()?i.resolve(null):i.reject(new E(y.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(o){const a=Ds(o,`Failed to get document '${s} from cache`);i.reject(a)}}(await yh(t),e,n)),n.promise}function Py(t,e,n={}){const r=new Fe;return t.asyncQueue.enqueueAndForget(async()=>function(s,i,o,a,u){const c=new ja({next:h=>{i.enqueueAndForget(()=>oh(s,l));const f=h.docs.has(o);!f&&h.fromCache?u.reject(new E(y.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&h.fromCache&&a&&a.source==="server"?u.reject(new E(y.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(h)},error:h=>u.reject(h)}),l=new uh(xs(o.path),c,{includeMetadataChanges:!0,uc:!0});return ih(s,l)}(await gs(t),t.asyncQueue,e,n,r)),r.promise}function fk(t,e){const n=new Fe;return t.asyncQueue.enqueueAndForget(async()=>async function(r,s,i){try{const o=await ta(r,s,!0),a=new Iy(s,o.Ks),u=a.Ic(o.documents),c=a.applyChanges(u,!1);i.resolve(c.snapshot)}catch(o){const a=Ds(o,`Failed to execute query '${s} against cache`);i.reject(a)}}(await yh(t),e,n)),n.promise}function My(t,e,n={}){const r=new Fe;return t.asyncQueue.enqueueAndForget(async()=>function(s,i,o,a,u){const c=new ja({next:h=>{i.enqueueAndForget(()=>oh(s,l)),h.fromCache&&a.source==="server"?u.reject(new E(y.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(h)},error:h=>u.reject(h)}),l=new uh(o,c,{includeMetadataChanges:!0,uc:!0});return ih(s,l)}(await gs(t),t.asyncQueue,e,n,r)),r.promise}function dk(t,e){const n=new ja(e);return t.asyncQueue.enqueueAndForget(async()=>function(r,s){D(r).Zo.add(s),s.next()}(await gs(t),n)),()=>{n.Jc(),t.asyncQueue.enqueueAndForget(async()=>function(r,s){D(r).Zo.delete(s)}(await gs(t),n))}}function pk(t,e){const n=new Fe;return t.asyncQueue.enqueueAndForget(async()=>{const r=await function(s){return Va(s).then(i=>i.datastore)}(t);new ak(t.asyncQueue,r,e,n).run()}),n.promise}function mk(t,e,n,r){const s=function(i,o){let a;return a=typeof i=="string"?new TextEncoder().encode(i):i,function(u,c){return new ik(u,c)}(function(u,c){if(u instanceof Uint8Array)return Cd(u,c);if(u instanceof ArrayBuffer)return Cd(new Uint8Array(u),c);if(u instanceof ReadableStream)return u.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(a),o)}(n,Hi(e));t.asyncQueue.enqueueAndForget(async()=>{rk(await vh(t),s,r)})}function gk(t,e){return t.asyncQueue.enqueue(async()=>function(n,r){const s=D(n);return s.persistence.runTransaction("Get named query","readonly",i=>s.Kn.getNamedQuery(i,r))}(await yh(t),e))}const kd=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wh(t,e,n){if(!n)throw new E(y.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Fy(t,e,n,r){if(e===!0&&r===!0)throw new E(y.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Od(t){if(!R.isDocumentKey(t))throw new E(y.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Dd(t){if(R.isDocumentKey(t))throw new E(y.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Ka(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":L()}function te(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new E(y.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Ka(t);throw new E(y.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function Ly(t,e){if(e<=0)throw new E(y.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nd{constructor(e){var n;if(e.host===void 0){if(e.ssl!==void 0)throw new E(y.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new E(y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,Fy("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi{constructor(e,n,r){this._authCredentials=n,this._appCheckCredentials=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Nd({}),this._settingsFrozen=!1,e instanceof hr?this._databaseId=e:(this._app=e,this._databaseId=function(s){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new E(y.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new hr(s.options.projectId)}(e))}get app(){if(!this._app)throw new E(y.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new E(y.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Nd(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new Dx;switch(n.type){case"gapi":const r=n.client;return j(!(typeof r!="object"||r===null||!r.auth||!r.auth.getAuthHeaderValueForFirstParty)),new Mx(r,n.sessionIndex||"0",n.iamToken||null);case"provider":return n.client;default:throw new E(y.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const n=kd.get(e);n&&(S("ComponentProvider","Removing Datastore"),kd.delete(e),n.terminate())}(this),Promise.resolve()}}function yk(t,e,n,r={}){var s;const i=(t=te(t,Wi))._getSettings();if(i.host!=="firestore.googleapis.com"&&i.host!==e&&di("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},i),{host:`${e}:${n}`,ssl:!1})),r.mockUserToken){let o,a;if(typeof r.mockUserToken=="string")o=r.mockUserToken,a=Ve.MOCK_USER;else{o=HT(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new E(y.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");a=new Ve(u)}t._authCredentials=new Nx(new pg(o,a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ye{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Qt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ye(this.firestore,e,this._key)}}class rt{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new rt(this.firestore,e,this._query)}}class Qt extends rt{constructor(e,n,r){super(e,n,xs(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ye(this.firestore,null,new R(e))}withConverter(e){return new Qt(this.firestore,e,this._path)}}function qy(t,e,...n){if(t=ke(t),wh("collection","path",e),t instanceof Wi){const r=se.fromString(e,...n);return Dd(r),new Qt(t,null,r)}{if(!(t instanceof ye||t instanceof Qt))throw new E(y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(se.fromString(e,...n));return Dd(r),new Qt(t.firestore,null,r)}}function vk(t,e){if(t=te(t,Wi),wh("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new E(y.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new rt(t,null,function(n){return new dn(se.emptyPath(),n)}(e))}function ia(t,e,...n){if(t=ke(t),arguments.length===1&&(e=mg.R()),wh("doc","path",e),t instanceof Wi){const r=se.fromString(e,...n);return Od(r),new ye(t,null,new R(r))}{if(!(t instanceof ye||t instanceof Qt))throw new E(y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(se.fromString(e,...n));return Od(r),new ye(t.firestore,t instanceof Qt?t.converter:null,new R(r))}}function $y(t,e){return t=ke(t),e=ke(e),(t instanceof ye||t instanceof Qt)&&(e instanceof ye||e instanceof Qt)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function Uy(t,e){return t=ke(t),e=ke(e),t instanceof rt&&e instanceof rt&&t.firestore===e.firestore&&Ui(t._query,e._query)&&t.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wk{constructor(){this.hu=Promise.resolve(),this.lu=[],this.fu=!1,this.du=[],this._u=null,this.wu=!1,this.mu=!1,this.gu=[],this.ro=new eh(this,"async_queue_retry"),this.yu=()=>{const n=Co();n&&S("AsyncQueue","Visibility state changed to "+n.visibilityState),this.ro.Yr()};const e=Co();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.yu)}get isShuttingDown(){return this.fu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.fu){this.fu=!0,this.mu=e||!1;const n=Co();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.yu)}}enqueue(e){if(this.pu(),this.fu)return new Promise(()=>{});const n=new Fe;return this.Iu(()=>this.fu&&this.mu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.lu.push(e),this.Eu()))}async Eu(){if(this.lu.length!==0){try{await this.lu[0](),this.lu.shift(),this.ro.reset()}catch(e){if(!Sr(e))throw e;S("AsyncQueue","Operation failed with retryable error: "+e)}this.lu.length>0&&this.ro.Hr(()=>this.Eu())}}Iu(e){const n=this.hu.then(()=>(this.wu=!0,e().catch(r=>{this._u=r,this.wu=!1;const s=function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),o}(r);throw Ae("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.wu=!1,r))));return this.hu=n,n}enqueueAfterDelay(e,n,r){this.pu(),this.gu.indexOf(e)>-1&&(n=0);const s=sh.createAndSchedule(this,e,n,r,i=>this.Tu(i));return this.du.push(s),s}pu(){this._u&&L()}verifyOperationInProgress(){}async Au(){let e;do e=this.hu,await e;while(e!==this.hu)}Ru(e){for(const n of this.du)if(n.timerId===e)return!0;return!1}Pu(e){return this.Au().then(()=>{this.du.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.du)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Au()})}bu(e){this.gu.push(e)}Tu(e){const n=this.du.indexOf(e);this.du.splice(n,1)}}function gc(t){return function(e,n){if(typeof e!="object"||e===null)return!1;const r=e;for(const s of n)if(s in r&&typeof r[s]=="function")return!0;return!1}(t,["next","error","complete"])}class _k{constructor(){this._progressObserver={},this._taskCompletionResolver=new Fe,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bk=-1;class Ie extends Wi{constructor(e,n,r){super(e,n,r),this.type="firestore",this._queue=new wk,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||By(this),this._firestoreClient.terminate()}}function Be(t){return t._firestoreClient||By(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function By(t){var e;const n=t._freezeSettings(),r=function(s,i,o,a){return new jx(s,i,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,a.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new uk(t._authCredentials,t._appCheckCredentials,t._queue,r)}function Ek(t,e){Vy(t=te(t,Ie));const n=Be(t),r=t._freezeSettings(),s=new mh;return jy(n,s,new ky(s,r.cacheSizeBytes,e==null?void 0:e.forceOwnership))}function Tk(t){Vy(t=te(t,Ie));const e=Be(t),n=t._freezeSettings(),r=new mh;return jy(e,r,new sk(r,n.cacheSizeBytes))}function jy(t,e,n){const r=new Fe;return t.asyncQueue.enqueue(async()=>{try{await Oy(t,n),await Dy(t,e),r.resolve()}catch(s){if(!function(i){return i.name==="FirebaseError"?i.code===y.FAILED_PRECONDITION||i.code===y.UNIMPLEMENTED:typeof DOMException!="undefined"&&i instanceof DOMException?i.code===22||i.code===20||i.code===11:!0}(s))throw s;console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+s),r.reject(s)}}).then(()=>r.promise)}function Ik(t){if(t._initialized&&!t._terminated)throw new E(y.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Fe;return t._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(n){if(!Mt.Vt())return Promise.resolve();const r=n+"main";await Mt.delete(r)}(Ql(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}}),e.promise}function Sk(t){return function(e){const n=new Fe;return e.asyncQueue.enqueueAndForget(async()=>HC(await vh(e),n)),n.promise}(Be(t=te(t,Ie)))}function xk(t){return ck(Be(t=te(t,Ie)))}function Ak(t){return lk(Be(t=te(t,Ie)))}function Ck(t,e){const n=Be(t=te(t,Ie)),r=new _k;return mk(n,t._databaseId,e,r),r}function kk(t,e){return gk(Be(t=te(t,Ie)),e).then(n=>n?new rt(t,null,n.query):null)}function Vy(t){if(t._initialized||t._terminated)throw new E(y.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new E(y.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Pe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Yt(De.fromBase64String(e))}catch(n){throw new E(y.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Yt(De.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ga{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new E(y.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new E(y.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Y(this._lat,e._lat)||Y(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ok=/^__.*__$/;class Dk{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Ir(e,this.data,this.fieldMask,n,this.fieldTransforms):new ji(e,this.data,n,this.fieldTransforms)}}class Ky{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Ir(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Gy(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw L()}}class Ha{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.O=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Vu(){return this.settings.Vu}Su(e){return new Ha(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.O,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Du(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Su({path:r,Cu:!1});return s.Nu(e),s}xu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Su({path:r,Cu:!1});return s.vu(),s}ku(e){return this.Su({path:void 0,Cu:!0})}Ou(e){return oa(e,this.settings.methodName,this.settings.Mu||!1,this.path,this.settings.$u)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Nu(this.path.get(e))}Nu(e){if(e.length===0)throw this.Ou("Document fields must not be empty");if(Gy(this.Vu)&&Ok.test(e))throw this.Ou('Document fields cannot begin and end with "__"')}}class Nk{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.O=r||Hi(e)}Fu(e,n,r,s=!1){return new Ha({Vu:e,methodName:n,$u:r,path:Pe.emptyPath(),Cu:!1,Mu:s},this.databaseId,this.O,this.ignoreUndefinedProperties)}}function Cr(t){const e=t._freezeSettings(),n=Hi(t._databaseId);return new Nk(t._databaseId,!!e.ignoreUndefinedProperties,n)}function za(t,e,n,r,s,i={}){const o=t.Fu(i.merge||i.mergeFields?2:0,e,n,s);Th("Data must be an object, but it was:",o,r);const a=Wy(r,o);let u,c;if(i.merge)u=new ss(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const l=[];for(const h of i.mergeFields){const f=yc(e,h,n);if(!o.contains(f))throw new E(y.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);Yy(l,f)||l.push(f)}u=new ss(l),c=o.fieldTransforms.filter(h=>u.covers(h.field))}else u=null,c=o.fieldTransforms;return new Dk(new et(a),u,c)}class Qi extends Ar{_toFieldTransform(e){if(e.Vu!==2)throw e.Vu===1?e.Ou(`${this._methodName}() can only appear at the top level of your update data`):e.Ou(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Qi}}function Hy(t,e,n){return new Ha({Vu:3,$u:e.settings.$u,methodName:t._methodName,Cu:n},e.databaseId,e.O,e.ignoreUndefinedProperties)}class _h extends Ar{_toFieldTransform(e){return new Bi(e.path,new us)}isEqual(e){return e instanceof _h}}class Rk extends Ar{constructor(e,n){super(e),this.Bu=n}_toFieldTransform(e){const n=Hy(this,e,!0),r=this.Bu.map(i=>kr(i,n)),s=new dr(r);return new Bi(e.path,s)}isEqual(e){return this===e}}class Pk extends Ar{constructor(e,n){super(e),this.Bu=n}_toFieldTransform(e){const n=Hy(this,e,!0),r=this.Bu.map(i=>kr(i,n)),s=new pr(r);return new Bi(e.path,s)}isEqual(e){return this===e}}class Mk extends Ar{constructor(e,n){super(e),this.Lu=n}_toFieldTransform(e){const n=new cs(e.O,kg(e.O,this.Lu));return new Bi(e.path,n)}isEqual(e){return this===e}}function bh(t,e,n,r){const s=t.Fu(1,e,n);Th("Data must be an object, but it was:",s,r);const i=[],o=et.empty();Er(r,(u,c)=>{const l=Ih(e,u,n);c=ke(c);const h=s.xu(l);if(c instanceof Qi)i.push(l);else{const f=kr(c,h);f!=null&&(i.push(l),o.set(l,f))}});const a=new ss(i);return new Ky(o,a,s.fieldTransforms)}function Eh(t,e,n,r,s,i){const o=t.Fu(1,e,n),a=[yc(e,r,n)],u=[s];if(i.length%2!=0)throw new E(y.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<i.length;f+=2)a.push(yc(e,i[f])),u.push(i[f+1]);const c=[],l=et.empty();for(let f=a.length-1;f>=0;--f)if(!Yy(c,a[f])){const p=a[f];let g=u[f];g=ke(g);const T=o.xu(p);if(g instanceof Qi)c.push(p);else{const x=kr(g,T);x!=null&&(c.push(p),l.set(p,x))}}const h=new ss(c);return new Ky(l,h,o.fieldTransforms)}function zy(t,e,n,r=!1){return kr(n,t.Fu(r?4:3,e))}function kr(t,e){if(Qy(t=ke(t)))return Th("Unsupported field value:",e,t),Wy(t,e);if(t instanceof Ar)return function(n,r){if(!Gy(r.Vu))throw r.Ou(`${n._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Ou(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Cu&&e.Vu!==4)throw e.Ou("Nested arrays are not supported");return function(n,r){const s=[];let i=0;for(const o of n){let a=kr(o,r.ku(i));a==null&&(a={nullValue:"NULL_VALUE"}),s.push(a),i++}return{arrayValue:{values:s}}}(t,e)}return function(n,r){if((n=ke(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return kg(r.O,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=Le.fromDate(n);return{timestampValue:vi(r.O,s)}}if(n instanceof Le){const s=new Le(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:vi(r.O,s)}}if(n instanceof Ga)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Yt)return{bytesValue:$g(r.O,n._byteString)};if(n instanceof ye){const s=r.databaseId,i=n.firestore._databaseId;if(!i.isEqual(s))throw r.Ou(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Ll(n.firestore._databaseId||r.databaseId,n._key.path)}}throw r.Ou(`Unsupported field value: ${Ka(n)}`)}(t,e)}function Wy(t,e){const n={};return yg(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Er(t,(r,s)=>{const i=kr(s,e.Du(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function Qy(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Le||t instanceof Ga||t instanceof Yt||t instanceof ye||t instanceof Ar)}function Th(t,e,n){if(!Qy(n)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(n)){const r=Ka(n);throw r==="an object"?e.Ou(t+" a custom object"):e.Ou(t+" "+r)}}function yc(t,e,n){if((e=ke(e))instanceof Fn)return e._internalPath;if(typeof e=="string")return Ih(t,e);throw oa("Field path arguments must be of type string or ",t,!1,void 0,n)}const Fk=new RegExp("[~\\*/\\[\\]]");function Ih(t,e,n){if(e.search(Fk)>=0)throw oa(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Fn(...e.split("."))._internalPath}catch{throw oa(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function oa(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new E(y.INVALID_ARGUMENT,a+t+u)}function Yy(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new ye(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Lk(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Wa("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class Lk extends Ti{data(){return super.data()}}function Wa(t,e){return typeof e=="string"?Ih(t,e):e instanceof Fn?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class hn extends Ti{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Js(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Wa("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Js extends hn{data(e={}){return super.data(e)}}class Ln{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Yn(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Js(this._firestore,this._userDataWriter,r.key,r,new Yn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new E(y.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let i=0;return r._snapshot.docChanges.map(o=>({type:"added",doc:new Js(r._firestore,r._userDataWriter,o.doc.key,o.doc,new Yn(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:i++}))}{let i=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const a=new Js(r._firestore,r._userDataWriter,o.doc.key,o.doc,new Yn(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);let u=-1,c=-1;return o.type!==0&&(u=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),o.type!==1&&(i=i.add(o.doc),c=i.indexOf(o.doc.key)),{type:qk(o.type),doc:a,oldIndex:u,newIndex:c}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function qk(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return L()}}function Jy(t,e){return t instanceof hn&&e instanceof hn?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Ln&&e instanceof Ln&&t._firestore===e._firestore&&Uy(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xy(t){if(Xo(t)&&t.explicitOrderBy.length===0)throw new E(y.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Yi{}function _n(t,...e){for(const n of e)t=n._apply(t);return t}class $k extends Yi{constructor(e,n,r){super(),this.Uu=e,this.qu=n,this.Ku=r,this.type="where"}_apply(e){const n=Cr(e.firestore),r=function(s,i,o,a,u,c,l){let h;if(u.isKeyField()){if(c==="array-contains"||c==="array-contains-any")throw new E(y.INVALID_ARGUMENT,`Invalid Query. You can't perform '${c}' queries on documentId().`);if(c==="in"||c==="not-in"){Pd(l,c);const p=[];for(const g of l)p.push(Rd(a,s,g));h={arrayValue:{values:p}}}else h=Rd(a,s,l)}else c!=="in"&&c!=="not-in"&&c!=="array-contains-any"||Pd(l,c),h=zy(o,i,l,c==="in"||c==="not-in");const f=ht.create(u,c,h);return function(p,g){if(g.S()){const x=Rl(p);if(x!==null&&!x.isEqual(g.field))throw new E(y.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${x.toString()}' and '${g.field.toString()}'`);const M=Nl(p);M!==null&&rv(p,g.field,M)}const T=function(x,M){for(const ie of x.filters)if(M.indexOf(ie.op)>=0)return ie.op;return null}(p,function(x){switch(x){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(g.op));if(T!==null)throw T===g.op?new E(y.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${g.op.toString()}' filter.`):new E(y.INVALID_ARGUMENT,`Invalid query. You cannot use '${g.op.toString()}' filters with '${T.toString()}' filters.`)}(s,f),f}(e._query,"where",n,e.firestore._databaseId,this.Uu,this.qu,this.Ku);return new rt(e.firestore,e.converter,function(s,i){const o=s.filters.concat([i]);return new dn(s.path,s.collectionGroup,s.explicitOrderBy.slice(),o,s.limit,s.limitType,s.startAt,s.endAt)}(e._query,r))}}function Uk(t,e,n){const r=e,s=Wa("where",t);return new $k(s,r,n)}class Bk extends Yi{constructor(e,n){super(),this.Uu=e,this.Gu=n,this.type="orderBy"}_apply(e){const n=function(r,s,i){if(r.startAt!==null)throw new E(y.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new E(y.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new Jr(s,i);return function(a,u){if(Nl(a)===null){const c=Rl(a);c!==null&&rv(a,c,u.field)}}(r,o),o}(e._query,this.Uu,this.Gu);return new rt(e.firestore,e.converter,function(r,s){const i=r.explicitOrderBy.concat([s]);return new dn(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,n))}}function jk(t,e="asc"){const n=e,r=Wa("orderBy",t);return new Bk(r,n)}class Zy extends Yi{constructor(e,n,r){super(),this.type=e,this.ju=n,this.Qu=r}_apply(e){return new rt(e.firestore,e.converter,Ig(e._query,this.ju,this.Qu))}}function Vk(t){return Ly("limit",t),new Zy("limit",t,"F")}function Kk(t){return Ly("limitToLast",t),new Zy("limitToLast",t,"L")}class ev extends Yi{constructor(e,n,r){super(),this.type=e,this.Wu=n,this.zu=r}_apply(e){const n=nv(e,this.type,this.Wu,this.zu);return new rt(e.firestore,e.converter,function(r,s){return new dn(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,s,r.endAt)}(e._query,n))}}function Gk(...t){return new ev("startAt",t,!0)}function Hk(...t){return new ev("startAfter",t,!1)}class tv extends Yi{constructor(e,n,r){super(),this.type=e,this.Wu=n,this.zu=r}_apply(e){const n=nv(e,this.type,this.Wu,this.zu);return new rt(e.firestore,e.converter,function(r,s){return new dn(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,s)}(e._query,n))}}function zk(...t){return new tv("endBefore",t,!1)}function Wk(...t){return new tv("endAt",t,!0)}function nv(t,e,n,r){if(n[0]=ke(n[0]),n[0]instanceof Ti)return function(s,i,o,a,u){if(!a)throw new E(y.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${o}().`);const c=[];for(const l of as(s))if(l.field.isKeyField())c.push(Qo(i,a.key));else{const h=a.data.field(l.field);if(Dl(h))throw new E(y.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+l.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){const f=l.field.canonicalString();throw new E(y.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${f}' (used as the orderBy) does not exist.`)}c.push(h)}return new os(c,u)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const s=Cr(t.firestore);return function(i,o,a,u,c,l){const h=i.explicitOrderBy;if(c.length>h.length)throw new E(y.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const f=[];for(let p=0;p<c.length;p++){const g=c[p];if(h[p].field.isKeyField()){if(typeof g!="string")throw new E(y.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof g}`);if(!Pl(i)&&g.indexOf("/")!==-1)throw new E(y.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${g}' contains a slash.`);const T=i.path.child(se.fromString(g));if(!R.isDocumentKey(T))throw new E(y.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${T}' is not because it contains an odd number of segments.`);const x=new R(T);f.push(Qo(o,x))}else{const T=zy(a,u,g);f.push(T)}}return new os(f,l)}(t._query,t.firestore._databaseId,s,e,n,r)}}function Rd(t,e,n){if(typeof(n=ke(n))=="string"){if(n==="")throw new E(y.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Pl(e)&&n.indexOf("/")!==-1)throw new E(y.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(se.fromString(n));if(!R.isDocumentKey(r))throw new E(y.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Qo(t,new R(r))}if(n instanceof ye)return Qo(t,n._key);throw new E(y.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ka(n)}.`)}function Pd(t,e){if(!Array.isArray(t)||t.length===0)throw new E(y.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(t.length>10)throw new E(y.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function rv(t,e,n){if(!n.isEqual(e))throw new E(y.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sh{convertValue(e,n="none"){switch(fr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Te(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(lr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw L()}}convertObject(e,n){const r={};return Er(e.fields,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertGeoPoint(e){return new Ga(Te(e.latitude),Te(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=vg(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(mi(e));default:return null}}convertTimestamp(e){const n=Pn(e);return new Le(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=se.fromString(e);j(Wg(r));const s=new hr(r.get(1),r.get(3)),i=new R(r.popFirst(5));return s.isEqual(n)||Ae(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qa(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class Qk extends Sh{constructor(e){super(),this.firestore=e}convertBytes(e){return new Yt(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new ye(this.firestore,null,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yk{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Cr(e)}set(e,n,r){this._verifyNotCommitted();const s=Sn(e,this._firestore),i=Qa(s.converter,n,r),o=za(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,Ce.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const i=Sn(e,this._firestore);let o;return o=typeof(n=ke(n))=="string"||n instanceof Fn?Eh(this._dataReader,"WriteBatch.update",i._key,n,r,s):bh(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(o.toMutation(i._key,Ce.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=Sn(e,this._firestore);return this._mutations=this._mutations.concat(new Vi(n._key,Ce.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new E(y.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Sn(t,e){if((t=ke(t)).firestore!==e)throw new E(y.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jk(t){t=te(t,ye);const e=te(t.firestore,Ie);return Py(Be(e),t._key).then(n=>xh(e,t,n))}class Or extends Sh{constructor(e){super(),this.firestore=e}convertBytes(e){return new Yt(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new ye(this.firestore,null,n)}}function Xk(t){t=te(t,ye);const e=te(t.firestore,Ie),n=Be(e),r=new Or(e);return hk(n,t._key).then(s=>new hn(e,r,t._key,s,new Yn(s!==null&&s.hasLocalMutations,!0),t.converter))}function Zk(t){t=te(t,ye);const e=te(t.firestore,Ie);return Py(Be(e),t._key,{source:"server"}).then(n=>xh(e,t,n))}function e1(t){t=te(t,rt);const e=te(t.firestore,Ie),n=Be(e),r=new Or(e);return Xy(t._query),My(n,t._query).then(s=>new Ln(e,r,t,s))}function t1(t){t=te(t,rt);const e=te(t.firestore,Ie),n=Be(e),r=new Or(e);return fk(n,t._query).then(s=>new Ln(e,r,t,s))}function n1(t){t=te(t,rt);const e=te(t.firestore,Ie),n=Be(e),r=new Or(e);return My(n,t._query,{source:"server"}).then(s=>new Ln(e,r,t,s))}function Md(t,e,n){t=te(t,ye);const r=te(t.firestore,Ie),s=Qa(t.converter,e,n);return Ji(r,[za(Cr(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Ce.none())])}function Fd(t,e,n,...r){t=te(t,ye);const s=te(t.firestore,Ie),i=Cr(s);let o;return o=typeof(e=ke(e))=="string"||e instanceof Fn?Eh(i,"updateDoc",t._key,e,n,r):bh(i,"updateDoc",t._key,e),Ji(s,[o.toMutation(t._key,Ce.exists(!0))])}function r1(t){return Ji(te(t.firestore,Ie),[new Vi(t._key,Ce.none())])}function s1(t,e){const n=te(t.firestore,Ie),r=ia(t),s=Qa(t.converter,e);return Ji(n,[za(Cr(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,Ce.exists(!1))]).then(()=>r)}function sv(t,...e){var n,r,s;t=ke(t);let i={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||gc(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges};if(gc(e[o])){const h=e[o];e[o]=(n=h.next)===null||n===void 0?void 0:n.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(s=h.complete)===null||s===void 0?void 0:s.bind(h)}let u,c,l;if(t instanceof ye)c=te(t.firestore,Ie),l=xs(t._key.path),u={next:h=>{e[o]&&e[o](xh(c,t,h))},error:e[o+1],complete:e[o+2]};else{const h=te(t,rt);c=te(h.firestore,Ie),l=h._query;const f=new Or(c);u={next:p=>{e[o]&&e[o](new Ln(c,f,h,p))},error:e[o+1],complete:e[o+2]},Xy(t._query)}return function(h,f,p,g){const T=new ja(g),x=new uh(f,T,p);return h.asyncQueue.enqueueAndForget(async()=>ih(await gs(h),x)),()=>{T.Jc(),h.asyncQueue.enqueueAndForget(async()=>oh(await gs(h),x))}}(Be(c),l,a,u)}function i1(t,e){return dk(Be(t=te(t,Ie)),gc(e)?e:{next:e})}function Ji(t,e){return function(n,r){const s=new Fe;return n.asyncQueue.enqueueAndForget(async()=>jC(await vh(n),r,s)),s.promise}(Be(t),e)}function xh(t,e,n){const r=n.docs.get(e._key),s=new Or(t);return new hn(t,s,e._key,r,new Yn(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o1 extends class{constructor(e,n){this._firestore=e,this._transaction=n,this._dataReader=Cr(e)}get(e){const n=Sn(e,this._firestore),r=new Qk(this._firestore);return this._transaction.lookup([n._key]).then(s=>{if(!s||s.length!==1)return L();const i=s[0];if(i.isFoundDocument())return new Ti(this._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new Ti(this._firestore,r,n._key,null,n.converter);throw L()})}set(e,n,r){const s=Sn(e,this._firestore),i=Qa(s.converter,n,r),o=za(this._dataReader,"Transaction.set",s._key,i,s.converter!==null,r);return this._transaction.set(s._key,o),this}update(e,n,r,...s){const i=Sn(e,this._firestore);let o;return o=typeof(n=ke(n))=="string"||n instanceof Fn?Eh(this._dataReader,"Transaction.update",i._key,n,r,s):bh(this._dataReader,"Transaction.update",i._key,n),this._transaction.update(i._key,o),this}delete(e){const n=Sn(e,this._firestore);return this._transaction.delete(n._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=Sn(e,this._firestore),r=new Or(this._firestore);return super.get(e).then(s=>new hn(this._firestore,r,n._key,s._document,new Yn(!1,!1),n.converter))}}function a1(t,e){return pk(Be(t=te(t,Ie)),n=>e(new o1(t,n)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u1(){return new Qi("deleteField")}function c1(){return new _h("serverTimestamp")}function l1(...t){return new Rk("arrayUnion",t)}function h1(...t){return new Pk("arrayRemove",t)}function f1(t){return new Mk("increment",t)}(function(t,e=!0){(function(n){Ss=n})(rl),ts(new ir("firestore",(n,{options:r})=>{const s=n.getProvider("app").getImmediate(),i=new Ie(s,new Rx(n.getProvider("auth-internal")),new Lx(n.getProvider("app-check-internal")));return r=Object.assign({useFetchStreams:e},r),i._setSettings(r),i},"PUBLIC")),Cn(Uf,"3.4.5",t),Cn(Uf,"3.4.5","esm2017")})();const d1="@firebase/firestore-compat",p1="0.1.14";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ah(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new E("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ld(){if(typeof Uint8Array=="undefined")throw new E("unimplemented","Uint8Arrays are not available in this environment.")}function qd(){if(!Ux())throw new E("unimplemented","Blobs are unavailable in Firestore in this environment.")}class Ii{constructor(e){this._delegate=e}static fromBase64String(e){return qd(),new Ii(Yt.fromBase64String(e))}static fromUint8Array(e){return Ld(),new Ii(Yt.fromUint8Array(e))}toBase64(){return qd(),this._delegate.toBase64()}toUint8Array(){return Ld(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vc(t){return m1(t,["next","error","complete"])}function m1(t,e){if(typeof t!="object"||t===null)return!1;const n=t;for(const r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g1{enableIndexedDbPersistence(e,n){return Ek(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return Tk(e._delegate)}clearIndexedDbPersistence(e){return Ik(e._delegate)}}class iv{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof hr||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&di("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){yk(this._delegate,e,n,r)}enableNetwork(){return xk(this._delegate)}disableNetwork(){return Ak(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,Fy("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return Sk(this._delegate)}onSnapshotsInSync(e){return i1(this._delegate,e)}get app(){if(!this._appCompat)throw new E("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new ys(this,qy(this._delegate,e))}catch(n){throw at(n,"collection()","Firestore.collection()")}}doc(e){try{return new kt(this,ia(this._delegate,e))}catch(n){throw at(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new ot(this,vk(this._delegate,e))}catch(n){throw at(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return a1(this._delegate,n=>e(new ov(this,n)))}batch(){return Be(this._delegate),new av(new Yk(this._delegate,e=>Ji(this._delegate,e)))}loadBundle(e){return Ck(this._delegate,e)}namedQuery(e){return kk(this._delegate,e).then(n=>n?new ot(this,n):null)}}class Ya extends Sh{constructor(e){super();this.firestore=e}convertBytes(e){return new Ii(new Yt(e))}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return kt.forKey(n,this.firestore,null)}}function y1(t){kx(t)}class ov{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new Ya(e)}get(e){const n=Jn(e);return this._delegate.get(n).then(r=>new Si(this._firestore,new hn(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){const s=Jn(e);return r?(Ah("Transaction.set",r),this._delegate.set(s,n,r)):this._delegate.set(s,n),this}update(e,n,r,...s){const i=Jn(e);return arguments.length===2?this._delegate.update(i,n):this._delegate.update(i,n,r,...s),this}delete(e){const n=Jn(e);return this._delegate.delete(n),this}}class av{constructor(e){this._delegate=e}set(e,n,r){const s=Jn(e);return r?(Ah("WriteBatch.set",r),this._delegate.set(s,n,r)):this._delegate.set(s,n),this}update(e,n,r,...s){const i=Jn(e);return arguments.length===2?this._delegate.update(i,n):this._delegate.update(i,n,r,...s),this}delete(e){const n=Jn(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}}class vr{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){const r=new Js(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new xi(this._firestore,r),n!=null?n:{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){const r=vr.INSTANCES;let s=r.get(e);s||(s=new WeakMap,r.set(e,s));let i=s.get(n);return i||(i=new vr(e,new Ya(e),n),s.set(n,i)),i}}vr.INSTANCES=new WeakMap;class kt{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new Ya(e)}static forPath(e,n,r){if(e.length%2!==0)throw new E("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new kt(n,new ye(n._delegate,r,new R(e)))}static forKey(e,n,r){return new kt(n,new ye(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new ys(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new ys(this.firestore,qy(this._delegate,e))}catch(n){throw at(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=ke(e),e instanceof ye?$y(this._delegate,e):!1}set(e,n){n=Ah("DocumentReference.set",n);try{return n?Md(this._delegate,e,n):Md(this._delegate,e)}catch(r){throw at(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?Fd(this._delegate,e):Fd(this._delegate,e,n,...r)}catch(s){throw at(s,"updateDoc()","DocumentReference.update()")}}delete(){return r1(this._delegate)}onSnapshot(...e){const n=uv(e),r=cv(e,s=>new Si(this.firestore,new hn(this.firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,this._delegate.converter)));return sv(this._delegate,n,r)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=Xk(this._delegate):(e==null?void 0:e.source)==="server"?n=Zk(this._delegate):n=Jk(this._delegate),n.then(r=>new Si(this.firestore,new hn(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new kt(this.firestore,e?this._delegate.withConverter(vr.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function at(t,e,n){return t.message=t.message.replace(e,n),t}function uv(t){for(const e of t)if(typeof e=="object"&&!vc(e))return e;return{}}function cv(t,e){var n,r;let s;return vc(t[0])?s=t[0]:vc(t[1])?s=t[1]:typeof t[0]=="function"?s={next:t[0],error:t[1],complete:t[2]}:s={next:t[1],error:t[2],complete:t[3]},{next:i=>{s.next&&s.next(e(i))},error:(n=s.error)===null||n===void 0?void 0:n.bind(s),complete:(r=s.complete)===null||r===void 0?void 0:r.bind(s)}}class Si{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new kt(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return Jy(this._delegate,e._delegate)}}class xi extends Si{data(e){const n=this._delegate.data(e);return Ox(n!==void 0),n}}class ot{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new Ya(e)}where(e,n,r){try{return new ot(this.firestore,_n(this._delegate,Uk(e,n,r)))}catch(s){throw at(s,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new ot(this.firestore,_n(this._delegate,jk(e,n)))}catch(r){throw at(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new ot(this.firestore,_n(this._delegate,Vk(e)))}catch(n){throw at(n,"limit()","Query.limit()")}}limitToLast(e){try{return new ot(this.firestore,_n(this._delegate,Kk(e)))}catch(n){throw at(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new ot(this.firestore,_n(this._delegate,Gk(...e)))}catch(n){throw at(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new ot(this.firestore,_n(this._delegate,Hk(...e)))}catch(n){throw at(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new ot(this.firestore,_n(this._delegate,zk(...e)))}catch(n){throw at(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new ot(this.firestore,_n(this._delegate,Wk(...e)))}catch(n){throw at(n,"endAt()","Query.endAt()")}}isEqual(e){return Uy(this._delegate,e._delegate)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=t1(this._delegate):(e==null?void 0:e.source)==="server"?n=n1(this._delegate):n=e1(this._delegate),n.then(r=>new wc(this.firestore,new Ln(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const n=uv(e),r=cv(e,s=>new wc(this.firestore,new Ln(this.firestore._delegate,this._userDataWriter,this._delegate,s._snapshot)));return sv(this._delegate,n,r)}withConverter(e){return new ot(this.firestore,e?this._delegate.withConverter(vr.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class v1{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new xi(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class wc{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new ot(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new xi(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new v1(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new xi(this._firestore,r))})}isEqual(e){return Jy(this._delegate,e._delegate)}}class ys extends ot{constructor(e,n){super(e,n);this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new kt(this.firestore,e):null}doc(e){try{return e===void 0?new kt(this.firestore,ia(this._delegate)):new kt(this.firestore,ia(this._delegate,e))}catch(n){throw at(n,"doc()","CollectionReference.doc()")}}add(e){return s1(this._delegate,e).then(n=>new kt(this.firestore,n))}isEqual(e){return $y(this._delegate,e._delegate)}withConverter(e){return new ys(this.firestore,e?this._delegate.withConverter(vr.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Jn(t){return te(t,ye)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ch{constructor(...e){this._delegate=new Fn(...e)}static documentId(){return new Ch(Pe.keyField().canonicalString())}isEqual(e){return e=ke(e),e instanceof Fn?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e){this._delegate=e}static serverTimestamp(){const e=c1();return e._methodName="FieldValue.serverTimestamp",new zn(e)}static delete(){const e=u1();return e._methodName="FieldValue.delete",new zn(e)}static arrayUnion(...e){const n=l1(...e);return n._methodName="FieldValue.arrayUnion",new zn(n)}static arrayRemove(...e){const n=h1(...e);return n._methodName="FieldValue.arrayRemove",new zn(n)}static increment(e){const n=f1(e);return n._methodName="FieldValue.increment",new zn(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w1={Firestore:iv,GeoPoint:Ga,Timestamp:Le,Blob:Ii,Transaction:ov,WriteBatch:av,DocumentReference:kt,DocumentSnapshot:Si,Query:ot,QueryDocumentSnapshot:xi,QuerySnapshot:wc,CollectionReference:ys,FieldPath:Ch,FieldValue:zn,setLogLevel:y1,CACHE_SIZE_UNLIMITED:bk};function _1(t,e){t.INTERNAL.registerComponent(new ir("firestore-compat",n=>{const r=n.getProvider("app-compat").getImmediate(),s=n.getProvider("firestore").getImmediate();return e(r,s)},"PUBLIC").setServiceProps(Object.assign({},w1)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b1(t){_1(t,(e,n)=>new iv(e,n,new g1)),t.registerVersion(d1,p1)}b1(dm);export{nn as F,C1 as G,S1 as a,Dp as b,I1 as c,T1 as d,n_ as e,dm as f,x1 as g,zt as h,A1 as i,Yw as o,E1 as t,tw as u};
